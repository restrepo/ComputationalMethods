
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Matrix diagonalization &#8212; Computational Methods</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Notebooks" href="ipython-notebooks.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Methods</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Computational Methods for Physics & Astronomy
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="overview-python.html">
   1. Python Overview
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="computer-arithmetics.html">
   2. Computer Arithmetics and Round-off Methods
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="one-variable-equations.html">
   3. One Variable Equations
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="interpolation.html">
   4. Interpolation Methods
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="numerical-calculus.html">
   5. Numerical Calculus
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="linear-algebra.html">
   6. Linear Algebra
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="differential-equations.html">
   7. Differential Equations
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="statistics.html">
   8. Statistics
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Intro_clases.html">
   9. Clases
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="scientific-libraries.html">
   Scientific Libraries with Python
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Pandas.html">
   Pandas
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="matplotlib.html">
   Matplotlib
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ipython-notebooks.html">
   Notebooks
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Matrix diagonalization
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/restrepo/ComputationalMethods/master?urlpath=tree/docs/material/linear-algebra-diagonalization.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/restrepo/ComputationalMethods"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/restrepo/ComputationalMethods/issues/new?title=Issue%20on%20page%20%2Fmaterial/linear-algebra-diagonalization.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/material/linear-algebra-diagonalization.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ortogonal-matrices">
   Ortogonal matrices
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#theorem-1">
   Theorem 1
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#corollary-1">
     Corollary 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigenvector-problem">
     Eigenvector problem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#theorem-2-singular-value-decomposition-svd">
   Theorem 2: Singular value decomposition (SVD)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#demostration">
     Demostration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scipy-implementation">
     Scipy implementation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigenvectors-and-eigenvalues">
     Eigenvectors and eigenvalues
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transformation-of-a-linear-system">
     Transformation of a linear system
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#theorem-1-in-numpy">
     Theorem 1 in
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigenvector-reordering">
     Eigenvector reordering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#implementation-of-an-algorithm-for-reordering">
     Implementation of an algorithm for reordering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-matrix">
     General matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpretations-of-theorem-2">
     Interpretations of Theorem 2
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#single-diagonalization-matrix">
       Single Diagonalization matrix
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mixed-terms">
   Mixed terms
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-electroweak-interactions">
     Example: Electroweak interactions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#corolary-1-theorem-ii">
   Corolary 1 Theorem II
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#corolary-2-theorem-ii">
   Corolary 2 Theorem II
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-neutrino-mass-matrix">
     Example: Neutrino mass matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#casas-ibarra-parameterization">
     Casas-Ibarra parameterization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#thdm-cp-even-masses-and-mixing">
     THDM CP-even masses and mixing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#activity">
   Activity
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Matrix diagonalization</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ortogonal-matrices">
   Ortogonal matrices
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#theorem-1">
   Theorem 1
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#corollary-1">
     Corollary 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigenvector-problem">
     Eigenvector problem
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example">
     Example
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#theorem-2-singular-value-decomposition-svd">
   Theorem 2: Singular value decomposition (SVD)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#demostration">
     Demostration
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#scipy-implementation">
     Scipy implementation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigenvectors-and-eigenvalues">
     Eigenvectors and eigenvalues
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#transformation-of-a-linear-system">
     Transformation of a linear system
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Example
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#theorem-1-in-numpy">
     Theorem 1 in
     <code class="docutils literal notranslate">
      <span class="pre">
       numpy
      </span>
     </code>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#eigenvector-reordering">
     Eigenvector reordering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#implementation-of-an-algorithm-for-reordering">
     Implementation of an algorithm for reordering
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-matrix">
     General matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpretations-of-theorem-2">
     Interpretations of Theorem 2
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#single-diagonalization-matrix">
       Single Diagonalization matrix
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#mixed-terms">
   Mixed terms
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-electroweak-interactions">
     Example: Electroweak interactions
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#corolary-1-theorem-ii">
   Corolary 1 Theorem II
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#corolary-2-theorem-ii">
   Corolary 2 Theorem II
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-neutrino-mass-matrix">
     Example: Neutrino mass matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#casas-ibarra-parameterization">
     Casas-Ibarra parameterization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#thdm-cp-even-masses-and-mixing">
     THDM CP-even masses and mixing
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#activity">
   Activity
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="matrix-diagonalization">
<h1>Matrix diagonalization<a class="headerlink" href="#matrix-diagonalization" title="Permalink to this headline">#</a></h1>
<p><a href="https://colab.research.google.com/github/restrepo/ComputationalMethods/blob/master/material/linear-algebra-diagonalization.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<section id="ortogonal-matrices">
<h2>Ortogonal matrices<a class="headerlink" href="#ortogonal-matrices" title="Permalink to this headline">#</a></h2>
<p><img alt="alt" src="../_images/so2.svg" /></p>
<div class="amsmath math notranslate nohighlight" id="equation-1964fc09-f976-48e0-bfb1-fa6f3876e16c">
<span class="eqno">(1)<a class="headerlink" href="#equation-1964fc09-f976-48e0-bfb1-fa6f3876e16c" title="Permalink to this equation">#</a></span>\[\begin{align}
  x'=&amp;x\cos\theta+y\sin\theta \nonumber\\
  y'=&amp;y\cos\theta-x\sin\theta\,.
\end{align}\]</div>
<p>En forma matricial, la transformación del sistema de coordenas inicial al sistema de coordenados rotado por un ángulo <span class="math notranslate nohighlight">\(\theta\)</span> está dado por</p>
<div class="amsmath math notranslate nohighlight" id="equation-12ceff72-0c3d-4f42-9490-a3f892d4b3ac">
<span class="eqno">(2)<a class="headerlink" href="#equation-12ceff72-0c3d-4f42-9490-a3f892d4b3ac" title="Permalink to this equation">#</a></span>\[\begin{align}
  \begin{pmatrix}
    x'\\
    y'\\
  \end{pmatrix}=
  \begin{pmatrix}
    \cos\theta &amp; \sin\theta\\
    -\sin\theta&amp; \cos\theta\\
  \end{pmatrix}
  \begin{pmatrix}
    x\\
    y\\
  \end{pmatrix}.
\end{align}\]</div>
</section>
<section id="theorem-1">
<h2>Theorem 1<a class="headerlink" href="#theorem-1" title="Permalink to this headline">#</a></h2>
<p>If <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> is Hermitic, e.g:</p>
<div class="amsmath math notranslate nohighlight" id="equation-da099358-a554-4b28-a49f-d8e87b04d16b">
<span class="eqno">(3)<a class="headerlink" href="#equation-da099358-a554-4b28-a49f-d8e87b04d16b" title="Permalink to this equation">#</a></span>\[\begin{align}
\boldsymbol{A}^\dagger =\boldsymbol{A}\,,
\end{align}\]</div>
<p>Then exists an <em>unitary  matrix</em> <span class="math notranslate nohighlight">\(\boldsymbol{V}\)</span> e.g:</p>
<div class="amsmath math notranslate nohighlight" id="equation-37335b6b-989c-4c60-b822-852d8b6efc6e">
<span class="eqno">(4)<a class="headerlink" href="#equation-37335b6b-989c-4c60-b822-852d8b6efc6e" title="Permalink to this equation">#</a></span>\[\begin{align}
\boldsymbol{V}^{\ -1}=\boldsymbol{V}^\dagger \,,
\end{align}\]</div>
<p>such that</p>
<div class="amsmath math notranslate nohighlight" id="equation-fde2d905-5455-43da-b606-cee349dbeebe">
<span class="eqno">(5)<a class="headerlink" href="#equation-fde2d905-5455-43da-b606-cee349dbeebe" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \boldsymbol{V}^\dagger\boldsymbol{A}\,\boldsymbol{V}=\boldsymbol{A}_{\text{diag}}\,,
\end{equation}\]</div>
<p>where
<span class="math notranslate nohighlight">\(\boldsymbol{A}_{\text{diag}}=\operatorname{diag}(\lambda_1,\lambda_2,\ldots \lambda_n)\)</span> is the diagonalized mass matrix.</p>
<section id="corollary-1">
<h3>Corollary 1<a class="headerlink" href="#corollary-1" title="Permalink to this headline">#</a></h3>
<p>If <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> is symmetric, e.g:</p>
<div class="amsmath math notranslate nohighlight" id="equation-21f3225a-fdfd-4beb-9af1-6ed2decb7a85">
<span class="eqno">(6)<a class="headerlink" href="#equation-21f3225a-fdfd-4beb-9af1-6ed2decb7a85" title="Permalink to this equation">#</a></span>\[\begin{align}
\boldsymbol{A}^{\operatorname{T}} =\boldsymbol{A}\,,
\end{align}\]</div>
<p>Then exists an <em>ortogonal matrix</em> <span class="math notranslate nohighlight">\(\boldsymbol{V}\)</span>, e.g:</p>
<div class="amsmath math notranslate nohighlight" id="equation-cb9749a5-55d7-4627-8d87-628d5aa8ecce">
<span class="eqno">(7)<a class="headerlink" href="#equation-cb9749a5-55d7-4627-8d87-628d5aa8ecce" title="Permalink to this equation">#</a></span>\[\begin{align}
\boldsymbol{V}^{-1}=\boldsymbol{V}^{\operatorname{T}} \,,
\end{align}\]</div>
<p>such that</p>
<div class="amsmath math notranslate nohighlight" id="equation-92080797-29a1-4fb1-8ea4-454d9aabb22d">
<span class="eqno">(8)<a class="headerlink" href="#equation-92080797-29a1-4fb1-8ea4-454d9aabb22d" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \boldsymbol{V}^{\operatorname{T}}\boldsymbol{A}\,\boldsymbol{V}=\boldsymbol{A}_{\text{diag}}\,,
\end{equation}\]</div>
<p>where
<span class="math notranslate nohighlight">\(\boldsymbol{A}_{\text{diag}}=\operatorname{diag}(\lambda_1,\lambda_2,\ldots \lambda_n)\)</span> is the diagonalized mass matrix.</p>
</section>
<hr class="docutils" />
<section id="eigenvector-problem">
<h3>Eigenvector problem<a class="headerlink" href="#eigenvector-problem" title="Permalink to this headline">#</a></h3>
<p>Note that each eigenvector, corresponding to each column of the matrix, is associated to each eigenvalue
$<span class="math notranslate nohighlight">\(
\boldsymbol{V}=\begin{bmatrix}
\boldsymbol{V}_1 \vdots \boldsymbol{V}_2\cdots \vdots \boldsymbol{V}_i \vdots \boldsymbol{V}_j\vdots\cdots \vdots \boldsymbol{V}_n 
\end{bmatrix}.
\)</span><span class="math notranslate nohighlight">\(
where \)</span>\boldsymbol{V}_i<span class="math notranslate nohighlight">\( is the \)</span>i<span class="math notranslate nohighlight">\(-th column of the matrix  \)</span>\boldsymbol{V}$.</p>
<p>In this way, if we interchange the <span class="math notranslate nohighlight">\(i\leftrightarrow j\)</span> columns of the diagonalization matrix <span class="math notranslate nohighlight">\(\boldsymbol{V}\)</span>, the order of the eigenvalues also change
$$</p>
<div class="amsmath math notranslate nohighlight" id="equation-446106e6-7695-401c-b54f-aa244c0eb836">
<span class="eqno">(9)<a class="headerlink" href="#equation-446106e6-7695-401c-b54f-aa244c0eb836" title="Permalink to this equation">#</a></span>\[\begin{bmatrix}
\boldsymbol{V}_1 \vdots \boldsymbol{V}_2\cdots \vdots \boldsymbol{V}_j \vdots \boldsymbol{V}_i\vdots\cdots \vdots \boldsymbol{V}_n 
\end{bmatrix}\]</div>
<p>\boldsymbol{V}_1 \vdots \boldsymbol{V}_2\cdots \vdots \boldsymbol{V}_j \vdots \boldsymbol{V}_i\vdots\cdots \vdots \boldsymbol{V}_n
\end{bmatrix}=\operatorname{diag}(\lambda_1,\lambda_2,\ldots,\lambda_j,\lambda_i,\ldots \lambda_n).
$$
This property is very important because usually the diagonalizationn alghoritm gives not the desired ordering of the eigenvalues and eigenvectors. It is recommended to use the <code class="docutils literal notranslate"><span class="pre">np.c_</span></code> method for the eigenvector reoirdering</p>
<p>However, the <strong>Theorem</strong> only guarantees existence. Tor really calculate the diagonalization matrix we must establish the eigenvector problem:</p>
<p>We can use the unitary propery to write</p>
<div class="amsmath math notranslate nohighlight" id="equation-4289e962-15ab-4f24-9cfb-9b0c1f73a759">
<span class="eqno">(10)<a class="headerlink" href="#equation-4289e962-15ab-4f24-9cfb-9b0c1f73a759" title="Permalink to this equation">#</a></span>\[\begin{align}
  \boldsymbol{V}\boldsymbol{V}^\dagger\boldsymbol{A}\,\boldsymbol{V}=&amp;\boldsymbol{V}\boldsymbol{A}_{\text{diag}}\\
\boldsymbol{A}\,\boldsymbol{V}=&amp;\boldsymbol{V}\boldsymbol{A}_{\text{diag}}\,,
\end{align}\]</div>
<p>or
$<span class="math notranslate nohighlight">\(
\boldsymbol{A}\begin{bmatrix}
\boldsymbol{V}_1 \vdots \boldsymbol{V}_2\cdots \vdots \boldsymbol{V}_n 
\end{bmatrix} =\operatorname{diag}(\lambda_1,\lambda_2\ldots,\lambda_n)\begin{bmatrix}
\boldsymbol{V}_1 \vdots \boldsymbol{V}_2\cdots  \vdots \boldsymbol{V}_n 
\end{bmatrix}.
\)</span>$
Therefore, the eigenvalue equation is just:</p>
<div class="amsmath math notranslate nohighlight" id="equation-647c5515-fa02-47d7-a17d-00d6ba733145">
<span class="eqno">(11)<a class="headerlink" href="#equation-647c5515-fa02-47d7-a17d-00d6ba733145" title="Permalink to this equation">#</a></span>\[\begin{align}
%$$
  \boldsymbol{A}\,\boldsymbol{V}_i=&amp;\lambda_i\boldsymbol{V}_i \nonumber\\
  \boldsymbol{A}\,\boldsymbol{V}_i-\lambda_i\boldsymbol{V}_i=&amp;\boldsymbol{0} \nonumber\\
  (\boldsymbol{A}-\lambda_i \,\boldsymbol{I})\boldsymbol{V}_i=&amp;\boldsymbol{0}\,,
%$$
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{V}_i\)</span> is the <span class="math notranslate nohighlight">\(i\)</span>-th column of the matrix  <span class="math notranslate nohighlight">\(\boldsymbol{V}\)</span>, and <span class="math notranslate nohighlight">\(\boldsymbol{I}\)</span> is the identity matrix.</p>
<p>To avoid the trivial solution <span class="math notranslate nohighlight">\(\boldsymbol{V}_i=\boldsymbol{0}\)</span>, we require that <span class="math notranslate nohighlight">\(\boldsymbol{A}-\lambda_i\, \boldsymbol{I}\)</span>
does not have an inverse, or equivalently
$<span class="math notranslate nohighlight">\(\det( \boldsymbol{A}-\lambda_i\, \boldsymbol{I})=0\,.\)</span>$</p>
</section>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">#</a></h3>
<p>From <a class="reference external" href="https://arxiv.org/pdf/2010.06458.pdf">arXiv:2010.06458</a>:</p>
<blockquote>
<div><p>In the three flavor neutrino oscillation, the neutrino flavor states <span class="math notranslate nohighlight">\(\left|\nu_{\alpha}\right\rangle(\alpha=e, \mu, \tau)\)</span> are linear superposition of mass eigenstates <span class="math notranslate nohighlight">\(\left|\nu_{j}\right\rangle(j=1,2,3):\left|\nu_{\alpha}\right\rangle=\Sigma_{j} U_{\alpha j}\left|\nu_{j}\right\rangle,\)</span> where <span class="math notranslate nohighlight">\(U_{\alpha j}\)</span> are the elements of the lepton mixing matrix known as PMNS (Pontecorvo-Maki-Nakagawa-Sakita) matrix such that
$<span class="math notranslate nohighlight">\(
\left(\begin{array}{l}
\left|\nu_{e}\right\rangle \\
\left|\nu_{\mu}\right\rangle \\
\left|\nu_{\tau}\right\rangle
\end{array}\right)=\left(\begin{array}{lll}
U_{e 1} &amp; U_{e 2} &amp; U_{e 3} \\
U_{\mu 1} &amp; U_{\mu 2} &amp; U_{\mu 3} \\
U_{\tau 1} &amp; U_{\tau 2} &amp; U_{\tau 3}
\end{array}\right)\left(\begin{array}{l}
\left|\nu_{1}\right\rangle \\
\left|\nu_{2}\right\rangle \\
\left|\nu_{3}\right\rangle
\end{array}\right)
\)</span><span class="math notranslate nohighlight">\(
The time evolution follows \)</span>\left|\nu_{\alpha}(t)\right\rangle=\Sigma_{j} e^{-i E_{j} t} U_{\alpha j}\left|\nu_{j}\right\rangle,<span class="math notranslate nohighlight">\( where \)</span>E_{j}<span class="math notranslate nohighlight">\( is the energy associated with the mass eigenstates \)</span>\left|\nu_{i}\right\rangle$ This is a superposition state.</p>
</div></blockquote>
<p>The observables associated to the three neutrinos are the entries of the <span class="math notranslate nohighlight">\(3\times 3\)</span> unitary matrix <span class="math notranslate nohighlight">\(\boldsymbol{U}=\begin{pmatrix}\boldsymbol{U}_1\vdots\boldsymbol{U}_2\vdots\boldsymbol{U}_3\end{pmatrix}\)</span>, and the eigenvalues associated to each eigenvector <span class="math notranslate nohighlight">\(\boldsymbol{U}_1\to  m_1\)</span>, <span class="math notranslate nohighlight">\(\boldsymbol{U}_2\to m_2\)</span>, <span class="math notranslate nohighlight">\(\boldsymbol{U}_3\to m_3\)</span>. The normal ordering is <span class="math notranslate nohighlight">\(m_1&lt;m_2&lt;m_3\)</span>. The unitary matrix can be parameterized in terms of three mixing angles, <span class="math notranslate nohighlight">\(\theta_{23}\)</span> <span class="math notranslate nohighlight">\(\theta_{13}\)</span>, <span class="math notranslate nohighlight">\(\theta_{12}\)</span>, and a complex phase, <span class="math notranslate nohighlight">\(\delta_{\text{CP}}\)</span>, such that
$<span class="math notranslate nohighlight">\(
\boldsymbol{U}=\left(\begin{array}{ccc}
1 &amp; 0 &amp; 0 \\
0 &amp; c_{23} &amp; s_{23} \\
0 &amp; -s_{23} &amp; c_{23}
\end{array}\right) \cdot\left(\begin{array}{ccc}
c_{13} &amp; 0 &amp; s_{13} e^{-i \delta_{\mathrm{CP}}} \\
0 &amp; 1 &amp; 0 \\
-s_{13} e^{i \delta_{\mathrm{CP}}} &amp; 0 &amp; c_{13}
\end{array}\right) \cdot\left(\begin{array}{ccc}
c_{12} &amp; s_{12} &amp; 0 \\
-s_{12} &amp; c_{12} &amp; 0 \\
0 &amp; 0 &amp; 1
\end{array}\right),
\)</span><span class="math notranslate nohighlight">\(
where \)</span>c_{i j} \equiv \cos \theta_{i j}<span class="math notranslate nohighlight">\( and \)</span>s_{i j} \equiv \sin \theta_{i j}<span class="math notranslate nohighlight">\(. Thus, we can write \)</span>\boldsymbol{U}<span class="math notranslate nohighlight">\( as
\)</span><span class="math notranslate nohighlight">\(
\boldsymbol{U}=\left(\begin{array}{ccc}c_{12} c_{13} &amp; s_{12} c_{13} &amp; s_{13} e^{-i \delta_{\mathrm{CP}}} \\ -s_{12} c_{23}-c_{12} s_{13} s_{23} e^{i \delta_{\mathrm{CP}}} &amp; c_{12} c_{23}-s_{12} s_{13} s_{23} e^{i \delta_{\mathrm{CP}}} &amp; c_{13} s_{23} \\ s_{12} s_{23}-c_{12} s_{13} c_{23} e^{i \delta_{\mathrm{CP}}} &amp; -c_{12} s_{23}-s_{12} s_{13} c_{23} e^{i \delta_{\mathrm{CP}}} &amp; c_{13} c_{23}\end{array}\right)
\)</span><span class="math notranslate nohighlight">\(
so that
\)</span><span class="math notranslate nohighlight">\(
\boldsymbol{U}_1=\begin{pmatrix}U_{e1}\\ U_{\mu 1}\\ U_{\tau 1}\end{pmatrix}=\begin{pmatrix}
c_{12} c_{13} \\
-s_{12} c_{23}-c_{12} s_{13} s_{23} e^{i \delta_{\mathrm{CP}}} \\
s_{12} s_{23}-c_{12} s_{13} c_{23} e^{i \delta_{\mathrm{CP}}}
\end{pmatrix},\qquad 
\boldsymbol{U}_2=\begin{pmatrix}U_{e2}\\ U_{\mu 2}\\ U_{\tau 2}\end{pmatrix}=\begin{pmatrix}
s_{12} c_{13} \\
c_{12} c_{23}-s_{12} s_{13} s_{23} e^{i \delta_{\mathrm{CP}}} \\
-c_{12} s_{23}-s_{12} s_{13} c_{23} e^{i \delta_{\mathrm{CP}}}
\end{pmatrix},\qquad
\boldsymbol{U}_3=\begin{pmatrix}U_{e3}\\ U_{\mu 3}\\ U_{\tau 3}\end{pmatrix}=\begin{pmatrix}
s_{13} e^{-i \delta_{\mathrm{CP}}} \\
c_{13} s_{23} \\
c_{13} c_{23}
\end{pmatrix}
\)</span>$</p>
<p>After decades of experimental efforts with thousands of millions of dollars in investment and two recent Nobel prizes, most of the parameters are already measured (see <a class="reference external" href="https://pdg.lbl.gov/2018/reviews/rpp2018-rev-neutrino-mixing.pdf">PDG22020</a> ):</p>
<p><img alt="IMAGE" src="https://github.com/restrepo/ComputationalMethods/raw/master/material/figures/nu.png" /></p>
<p>where <span class="math notranslate nohighlight">\(\Delta m^2_{ij}=m^2_i-m^2_j\)</span> is the squared mass difference between eigenvalues <span class="math notranslate nohighlight">\(i\)</span> and <span class="math notranslate nohighlight">\(j\)</span>; and <span class="math notranslate nohighlight">\(\text{eV}\)</span> is really <span class="math notranslate nohighlight">\(\text{eV}/c^2\)</span> where <span class="math notranslate nohighlight">\(c\)</span> is the speed of light  in vacuum in natural units with <span class="math notranslate nohighlight">\(c=1\)</span>, and <span class="math notranslate nohighlight">\(1\ \text{eV}=1.602\,176\,6208(98)\times 10^{-19}\ \text{J}\)</span>.</p>
<p>To a better measurement of <span class="math notranslate nohighlight">\(\delta_{CP}\)</span> for example, a new large experiment called <a class="reference external" href="https://www.dunescience.org/">DUNE</a>, and with a cost of around <a class="reference external" href="https://web.fnal.gov/organization/OPSS/Projects/LBNFDUNE/LBNF%20APM%20Jul%202015/Review%20Documents/LBNF%20DUNE%20ICR_Final%20Report.pdf"><span class="math notranslate nohighlight">\(\$1\,500\)</span> million of dollars</a>, is in construction in the United States
<img alt="IMAGE" src="https://www.dunescience.org/wp-content/uploads/2016/12/LBNE_Graphic_061615_2016.jpg" /></p>
</section>
</section>
<section id="theorem-2-singular-value-decomposition-svd">
<h2>Theorem 2: Singular value decomposition (SVD)<a class="headerlink" href="#theorem-2-singular-value-decomposition-svd" title="Permalink to this headline">#</a></h2>
<p>See <a class="reference external" href="https://en.wikipedia.org/wiki/Singular_value_decomposition">SVD</a> (where the  Hermetique-conjugate is denoted with “*” instead that with “”)</p>
<p>A general complex matrix <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>  can be diagonalized by a bi-diagonal transformation such that</p>
<div class="amsmath math notranslate nohighlight" id="equation-e2807101-b84c-4eaf-bbfe-5b4652392600">
<span class="eqno">(12)<a class="headerlink" href="#equation-e2807101-b84c-4eaf-bbfe-5b4652392600" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \boldsymbol{V}^\dagger\boldsymbol{A}\,\boldsymbol{U}=\boldsymbol{A}_{\text{diag}}\,,
\end{equation}\]</div>
<p>where
<span class="math notranslate nohighlight">\(\boldsymbol{A}_{\text{diag}}=\operatorname{diag}(\lambda_1,\lambda_2,\ldots \lambda_n)\)</span> is the diagonalized mass matrix.</p>
<section id="demostration">
<h3>Demostration<a class="headerlink" href="#demostration" title="Permalink to this headline">#</a></h3>
<div class="amsmath math notranslate nohighlight" id="equation-1118334e-efd6-4f66-9fa6-a5641b131df2">
<span class="eqno">(13)<a class="headerlink" href="#equation-1118334e-efd6-4f66-9fa6-a5641b131df2" title="Permalink to this equation">#</a></span>\[\begin{align}
  \boldsymbol{A}_{\text{diag}}=&amp;\boldsymbol{V}^\dagger\boldsymbol{A}\,\boldsymbol{U}\\
  \boldsymbol{A}_{\text{diag}}\boldsymbol{A}_{\text{diag}}^\dagger=&amp;\boldsymbol{V}^\dagger\boldsymbol{A}\,\boldsymbol{U}
  \left(\boldsymbol{V}^\dagger\boldsymbol{A}\,\boldsymbol{U}\right)^\dagger\\
  =&amp;\boldsymbol{V}^\dagger\boldsymbol{A}\,\boldsymbol{U}
  \left(   \boldsymbol{U}^\dagger \boldsymbol{A}^\dagger\,\boldsymbol{V}\right)\\
  =&amp;\boldsymbol{V}^\dagger
  \left( \boldsymbol{A}  \boldsymbol{A}^\dagger\,\right) \boldsymbol{V}\,.\\
\end{align}\]</div>
<p>Since <span class="math notranslate nohighlight">\(\boldsymbol{A}  \boldsymbol{A}^\dagger\)</span> is hermitic and <span class="math notranslate nohighlight">\(\boldsymbol{A}  \boldsymbol{A}^\dagger\)</span> is diagonal, then in fact there exists an unitary matrix <span class="math notranslate nohighlight">\(\boldsymbol{V}\)</span>.  Similarly there exists an unitary matrix <span class="math notranslate nohighlight">\(\boldsymbol{U}\)</span> which diagonalizes  <span class="math notranslate nohighlight">\(\boldsymbol{A}^\dagger  \boldsymbol{A}\)</span></p>
</section>
<section id="scipy-implementation">
<h3>Scipy implementation<a class="headerlink" href="#scipy-implementation" title="Permalink to this headline">#</a></h3>
<p>The implementation in scipy is based in the inverted relation</p>
<div class="amsmath math notranslate nohighlight" id="equation-6a183261-dcc0-4fdf-831c-20c96b8d045f">
<span class="eqno">(14)<a class="headerlink" href="#equation-6a183261-dcc0-4fdf-831c-20c96b8d045f" title="Permalink to this equation">#</a></span>\[\begin{align}
  \boldsymbol{V}^\dagger\boldsymbol{A}\,\boldsymbol{U}=&amp;\boldsymbol{A}_{\text{diag}}\\
  \boldsymbol{V}\boldsymbol{V}^\dagger\boldsymbol{A}\,\boldsymbol{U}\boldsymbol{U}^\dagger=&amp;\boldsymbol{V}\boldsymbol{A}_{\text{diag}}\boldsymbol{U}^\dagger\\
  \boldsymbol{A}=&amp;\boldsymbol{V}\boldsymbol{A}_{\text{diag}}\boldsymbol{U}^\dagger\,.
\end{align}\]</div>
<p>The implementation is trough the module <code class="docutils literal notranslate"><span class="pre">scipy.linalg.svd</span></code>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>V,Adiag,Udagger<span class="o">=</span>linalg.svd<span class="o">(</span>A<span class="o">)</span>
</pre></div>
</div>
</section>
<section id="eigenvectors-and-eigenvalues">
<h3>Eigenvectors and eigenvalues<a class="headerlink" href="#eigenvectors-and-eigenvalues" title="Permalink to this headline">#</a></h3>
<p>If we make
$<span class="math notranslate nohighlight">\( \boldsymbol{U}=[\boldsymbol{U}_1\vdots\boldsymbol{U}_2\vdots\cdots\vdots\boldsymbol{U}_n], \qquad \boldsymbol{V}=[\boldsymbol{V}_1\vdots\boldsymbol{V}_2\vdots\cdots\vdots\boldsymbol{V}_n] \)</span>$</p>
<p>We know that there exists a bi-diagonal transformación such that</p>
<div class="amsmath math notranslate nohighlight" id="equation-57dec4e9-3506-49a1-a7e3-7c1156980182">
<span class="eqno">(15)<a class="headerlink" href="#equation-57dec4e9-3506-49a1-a7e3-7c1156980182" title="Permalink to this equation">#</a></span>\[\begin{equation}
%$$
  \boldsymbol{A}\,\boldsymbol{U}=\boldsymbol{V}\boldsymbol{A}_{\text{diag}}
\end{equation}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-2d6c0b4b-74e7-4704-b780-3af4b462380e">
<span class="eqno">(16)<a class="headerlink" href="#equation-2d6c0b4b-74e7-4704-b780-3af4b462380e" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \boldsymbol{A}\,\boldsymbol{U}_i=\lambda_i\boldsymbol{V}_i
%$$
\end{equation}\]</div>
<p>not sum upon <span class="math notranslate nohighlight">\(i\)</span>. Here</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\lambda_i\)</span> are called eigenvalues</p></li>
<li><p><span class="math notranslate nohighlight">\(V_i\)</span> and <span class="math notranslate nohighlight">\(U_i\)</span> are the eigenvectors</p></li>
</ul>
<p>We can use this to check the proper order of the eigenvalues</p>
</section>
<section id="transformation-of-a-linear-system">
<h3>Transformation of a linear system<a class="headerlink" href="#transformation-of-a-linear-system" title="Permalink to this headline">#</a></h3>
<p>We start again with the matrix equation, capitol bold letters denotes matrices</p>
<div class="amsmath math notranslate nohighlight" id="equation-ab8fafb6-387e-4ba0-a90e-1d6e00d58281">
<span class="eqno">(17)<a class="headerlink" href="#equation-ab8fafb6-387e-4ba0-a90e-1d6e00d58281" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \boldsymbol{A}\boldsymbol{X}=\boldsymbol{B}\,,
\end{equation}\]</div>
<p>where <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span> is an <span class="math notranslate nohighlight">\(n \times n\)</span> matrix.</p>
<p>We know that there exists a bi-diagonal transformación such that</p>
<div class="amsmath math notranslate nohighlight" id="equation-954a6a94-bf1f-4a2c-87f3-203cf4cb8d31">
<span class="eqno">(18)<a class="headerlink" href="#equation-954a6a94-bf1f-4a2c-87f3-203cf4cb8d31" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \boldsymbol{V}^\dagger\boldsymbol{A}\,\boldsymbol{U}=\boldsymbol{A}_{\text{diag}}
\end{equation}\]</div>
<p>So, by doing standard operations we have</p>
<div class="amsmath math notranslate nohighlight" id="equation-72e16bbb-4ca5-4e7d-98ee-d9ef895cbb90">
<span class="eqno">(19)<a class="headerlink" href="#equation-72e16bbb-4ca5-4e7d-98ee-d9ef895cbb90" title="Permalink to this equation">#</a></span>\[\begin{align}
  \boldsymbol{V}^\dagger \boldsymbol{A} \boldsymbol{U} \boldsymbol{U}^\dagger \boldsymbol{X}=&amp; \boldsymbol{V}^\dagger \boldsymbol{B}\\
   \left( \boldsymbol{V}^\dagger \boldsymbol{A} \boldsymbol{U} \right) 
   \left( \boldsymbol{U}^\dagger \boldsymbol{X}\right)=&amp; \boldsymbol{V}^\dagger \boldsymbol{B}\\
  \boldsymbol{A}_{\text{diag}} \boldsymbol{X}'=&amp;\boldsymbol{B}'\,,      
\end{align}\]</div>
<p>where</p>
<div class="amsmath math notranslate nohighlight" id="equation-0ed5d0c0-20e1-43c1-9be9-0947b9d753dd">
<span class="eqno">(20)<a class="headerlink" href="#equation-0ed5d0c0-20e1-43c1-9be9-0947b9d753dd" title="Permalink to this equation">#</a></span>\[\begin{align}
  \boldsymbol{X}'=&amp; \boldsymbol{U}^\dagger \boldsymbol{X}\,, &amp;    \boldsymbol{B}'=&amp; \boldsymbol{V}^\dagger \boldsymbol{B}\,,
\end{align}\]</div>
<p>or</p>
<div class="amsmath math notranslate nohighlight" id="equation-7743afc5-15ab-413d-bf70-9b3aada12773">
<span class="eqno">(21)<a class="headerlink" href="#equation-7743afc5-15ab-413d-bf70-9b3aada12773" title="Permalink to this equation">#</a></span>\[\begin{align}
  \boldsymbol{X}=&amp; \boldsymbol{U}\boldsymbol{X}'\,, &amp;    \boldsymbol{B}=&amp; \boldsymbol{V}\boldsymbol{B}'\,.
\end{align}\]</div>
<p>If <span class="math notranslate nohighlight">\(\boldsymbol{A}_{\text{diag}}=\operatorname{diag}(\lambda_1,\lambda_2,\ldots \lambda_n)\)</span>, <span class="math notranslate nohighlight">\(\boldsymbol{X}=\begin{pmatrix}x_1 &amp; x_2 &amp;\cdots &amp; x_n\end{pmatrix}^{\operatorname{T}}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{B}=\begin{pmatrix}b_1&amp; b_2 &amp;\cdots &amp; b_n\end{pmatrix}^{\operatorname{T}}\)</span>,
the solution of the system is given by</p>
<div class="amsmath math notranslate nohighlight" id="equation-aae1a87c-0e8c-44d7-9e36-76c637337d13">
<span class="eqno">(22)<a class="headerlink" href="#equation-aae1a87c-0e8c-44d7-9e36-76c637337d13" title="Permalink to this equation">#</a></span>\[\begin{equation}
\lambda_i x'_i=b_i'\,.
\end{equation}\]</div>
<p>Note that</p>
<div class="amsmath math notranslate nohighlight" id="equation-7e27e139-a2f6-4094-b976-c56b79a1a042">
<span class="eqno">(23)<a class="headerlink" href="#equation-7e27e139-a2f6-4094-b976-c56b79a1a042" title="Permalink to this equation">#</a></span>\[\begin{align}
   \boldsymbol{X}'=&amp;\boldsymbol{A}_{\text{diag}}^{-1}\boldsymbol{B}'\,,      
\end{align}\]</div>
<p>and the final solution is</p>
<div class="amsmath math notranslate nohighlight" id="equation-4cd5a97f-a57c-4c9c-9fc3-9325c5690c08">
<span class="eqno">(24)<a class="headerlink" href="#equation-4cd5a97f-a57c-4c9c-9fc3-9325c5690c08" title="Permalink to this equation">#</a></span>\[\begin{align}
   \boldsymbol{X}=&amp;U \boldsymbol{X}'\\ 
               =&amp;U\boldsymbol{A}_{\text{diag}}^{-1}V^\dagger \boldsymbol{B}\,,      
\end{align}\]</div>
<p>Therefore
$<span class="math notranslate nohighlight">\(\boldsymbol{A}^{-1}=U\boldsymbol{A}_{\text{diag}}^{-1}V^\dagger\)</span>$</p>
</section>
<section id="id1">
<h3>Example<a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h3>
<p>A suitable way to introduce this method is applying it to some basic problem. To do so, let’s take the result of the <a class="reference external" href="#Example-1">Example 1</a>:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \begin{bmatrix}
5 &amp; -4 &amp; 0 \\
-4 &amp; 7 &amp; -3 \\ 
0 &amp; -3 &amp; 5
\end{bmatrix}
\begin{bmatrix}
x_{1} \\
x_{2} \\
x_{3} 
\end{bmatrix}  =
\begin{bmatrix}
1 \\
0 \\
-2
\end{bmatrix}
\end{split}\]</div>
<p>As the matrix is symmetric <span class="math notranslate nohighlight">\(\boldsymbol{U}=\boldsymbol{V}\)</span> and <span class="math notranslate nohighlight">\(\boldsymbol{V}^\dagger=\boldsymbol{V}^{\operatorname{T}}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">M1</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5, -4,  0],
       [-4,  7, -3],
       [ 0, -3,  5]])
</pre></div>
</div>
</div>
</div>
<p>Check if all eigenvalues are different from zero:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>49.99999999999999
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>  <span class="p">]</span>
<span class="n">B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1],
       [ 0],
       [-2]])
</pre></div>
</div>
</div>
</div>
<p>Also as</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">]])</span>
<span class="c1">#or</span>
<span class="n">B</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>  <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">],(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</section>
<section id="theorem-1-in-numpy">
<h3>Theorem 1 in <code class="docutils literal notranslate"><span class="pre">numpy</span></code><a class="headerlink" href="#theorem-1-in-numpy" title="Permalink to this headline">#</a></h3>
<p><strong>WARNING</strong>: Only works for Hermitic matrices!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">λ</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span> <span class="n">A</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_diag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">λ</span><span class="p">)</span>
<span class="n">A_diag</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[11.09901951,  0.        ,  0.        ],
       [ 0.        ,  0.90098049,  0.        ],
       [ 0.        ,  0.        ,  5.        ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-5.07191124e-01, -6.18673713e-01, -6.00000000e-01],
       [ 7.73342141e-01, -6.33988906e-01,  1.91548674e-16],
       [-3.80393343e-01, -4.64005285e-01,  8.00000000e-01]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">V</span><span class="nd">@V</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 0, 0],
       [0, 1, 0],
       [0, 0, 1]])
</pre></div>
</div>
</div>
</div>
<p>We first check the proper order of the diagonalization</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A@V</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[11.09901951,  0.        ,  0.        ],
       [ 0.        ,  0.90098049,  0.        ],
       [ 0.        ,  0.        ,  5.        ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="p">))</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">V</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[11.09901951,  0.        ,  0.        ],
       [ 0.        ,  0.90098049,  0.        ],
       [ 0.        ,  0.        ,  5.        ]])
</pre></div>
</div>
</div>
</div>
<p>Since</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-5.07191124e-01, -6.18673713e-01, -6.00000000e-01],
       [ 7.73342141e-01, -6.33988906e-01,  1.91548674e-16],
       [-3.80393343e-01, -4.64005285e-01,  8.00000000e-01]])
</pre></div>
</div>
</div>
</div>
<p>The final solution is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_diag_inv</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">λ</span><span class="p">)</span>
<span class="n">A_diag_inv</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.09009805, 0.        , 0.        ],
       [0.        , 1.10990195, 0.        ],
       [0.        , 0.        , 0.2       ]])
</pre></div>
</div>
</div>
</div>
<p>check with <code class="docutils literal notranslate"><span class="pre">np.linalg.inv(A_diag)</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">=</span><span class="n">V</span><span class="nd">@A_diag_inv@V</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@B</span>
<span class="n">X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.04],
       [-0.2 ],
       [-0.52]])
</pre></div>
</div>
</div>
</div>
<p><strong><font color="red">Activity</font></strong>: Usar np.lingalg.solve</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.04],
       [-0.2 ],
       [-0.52]])
</pre></div>
</div>
</div>
</div>
<p>We can now check some properties.</p>
<div class="amsmath math notranslate nohighlight" id="equation-65ac4467-a2b6-44cb-97ab-5c605d2e8f7a">
<span class="eqno">(25)<a class="headerlink" href="#equation-65ac4467-a2b6-44cb-97ab-5c605d2e8f7a" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \boldsymbol{V}^{\operatorname{T}}\boldsymbol{A}\,\boldsymbol{V}=\boldsymbol{A}_{\text{diag}}\,,
\end{equation}\]</div>
<div class="math notranslate nohighlight">
\[
\begin{bmatrix}
\boldsymbol{V}_1 \vdots \boldsymbol{V}_2\cdots \vdots \boldsymbol{V}_j \vdots \boldsymbol{V}_i\vdots\cdots \vdots \boldsymbol{V}_n 
\end{bmatrix}^\dagger \boldsymbol{A} \begin{bmatrix}
\boldsymbol{V}_1 \vdots \boldsymbol{V}_2\cdots \vdots \boldsymbol{V}_j \vdots \boldsymbol{V}_i\vdots\cdots \vdots \boldsymbol{V}_n 
\end{bmatrix}=\operatorname{diag}(\lambda_1,\lambda_2,\ldots,\lambda_j,\lambda_i,\ldots \lambda_n).
\]</div>
<p>For the case <span class="math notranslate nohighlight">\(3\times 3\)</span></p>
<ul class="simple">
<li><p>Obtain <span class="math notranslate nohighlight">\(\theta_{12}\)</span> for <span class="math notranslate nohighlight">\(|\lambda_1|&lt;|\lambda_2|&lt;|\lambda_3|\)</span> and, in the proper order
$<span class="math notranslate nohighlight">\(
\boldsymbol{U}=\left(\begin{array}{ccc}c_{12} c_{13} &amp; s_{12} c_{13} &amp; s_{13} e^{-i \delta_{\mathrm{CP}}} \\ -s_{12} c_{23}-c_{12} s_{13} s_{23} e^{i \delta_{\mathrm{CP}}} &amp; c_{12} c_{23}-s_{12} s_{13} s_{23} e^{i \delta_{\mathrm{CP}}} &amp; c_{13} s_{23} \\ s_{12} s_{23}-c_{12} s_{13} c_{23} e^{i \delta_{\mathrm{CP}}} &amp; -c_{12} s_{23}-s_{12} s_{13} c_{23} e^{i \delta_{\mathrm{CP}}} &amp; c_{13} c_{23}\end{array}\right)
\)</span>$</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
             <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>
             <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]])</span>

<span class="n">λ</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span> <span class="n">A</span> <span class="p">)</span>
<span class="n">A_diag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">λ</span><span class="p">)</span>
<span class="n">λ</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([11.09901951,  0.90098049,  5.        ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-5.07191124e-01, -6.18673713e-01, -6.00000000e-01],
       [ 7.73342141e-01, -6.33988906e-01,  1.91548674e-16],
       [-3.80393343e-01, -4.64005285e-01,  8.00000000e-01]])
</pre></div>
</div>
</div>
</div>
<p>Extract the first eigenvector</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="n">V</span><span class="p">[:</span> <span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.50719112],
       [ 0.77334214],
       [-0.38039334]])
</pre></div>
</div>
</div>
</div>
<p>associated with the eigenvalue</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_diag</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">λ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(11.099019513592784, 11.099019513592784)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V0</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="n">V</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="p">]</span>
<span class="n">V1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="n">V</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="p">]</span>
<span class="n">V2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="n">V</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="p">]</span>
<span class="n">display</span><span class="p">(</span><span class="n">V0</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">V1</span><span class="p">)</span>
<span class="n">V2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.50719112],
       [ 0.77334214],
       [-0.38039334]])
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.61867371],
       [-0.63398891],
       [-0.46400528]])
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-6.00000000e-01],
       [ 1.91548674e-16],
       [ 8.00000000e-01]])
</pre></div>
</div>
</div>
</div>
<p>Check: <span class="math notranslate nohighlight">\( A V_i=\lambda_i V_i\)</span></p>
<p>Which means the eigenvalue associated to the “operator” <span class="math notranslate nohighlight">\(A\)</span> acting on the eigenvector <span class="math notranslate nohighlight">\(V_1\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">A</span><span class="nd">@V0</span><span class="si">}</span><span class="s1"> =</span><span class="se">\n</span><span class="si">{</span><span class="n">λ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">V0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-5.62932419]
 [ 8.58333952]
 [-4.22199314]] =
[[-5.62932419]
 [ 8.58333952]
 [-4.22199314]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">A</span><span class="nd">@V1</span><span class="si">}</span><span class="s1"> =</span><span class="se">\n</span><span class="si">{</span><span class="n">λ</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">V1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-0.55741294]
 [-0.57121163]
 [-0.41805971]] =
[[-0.55741294]
 [-0.57121163]
 [-0.41805971]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="p">(</span><span class="n">A</span><span class="nd">@V2</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="si">}</span><span class="s1"> =</span><span class="se">\n</span><span class="si">{</span><span class="p">(</span><span class="n">λ</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">V2</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[-3.]
 [ 0.]
 [ 4.]] =
[[-3.]
 [ 0.]
 [ 4.]]
</pre></div>
</div>
</div>
</div>
<p>The diagonalization matrix can be rebuild from the eigenvectors</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-5.07191124e-01, -6.18673713e-01, -6.00000000e-01],
       [ 7.73342141e-01, -6.33988906e-01,  1.91548674e-16],
       [-3.80393343e-01, -4.64005285e-01,  8.00000000e-01]])
</pre></div>
</div>
</div>
</div>
<p>is rebuild with</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="n">V0</span><span class="p">,</span><span class="n">V1</span><span class="p">,</span><span class="n">V2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>or with: <code class="docutils literal notranslate"><span class="pre">np.hstack((V0,V1,V2))</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-5.07191124e-01, -6.18673713e-01, -6.00000000e-01],
       [ 7.73342141e-01, -6.33988906e-01,  1.91548674e-16],
       [-3.80393343e-01, -4.64005285e-01,  8.00000000e-01]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span> <span class="n">V</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A@V</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[11.09901951,  0.        ,  0.        ],
       [ 0.        ,  0.90098049,  0.        ],
       [ 0.        ,  0.        ,  5.        ]])
</pre></div>
</div>
</div>
</div>
<p>Note that a sign of an egigenvalues can be changed:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="n">V0</span><span class="p">,</span><span class="o">-</span><span class="n">V1</span><span class="p">,</span><span class="n">V2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="eigenvector-reordering">
<h3>Eigenvector reordering<a class="headerlink" href="#eigenvector-reordering" title="Permalink to this headline">#</a></h3>
<p><span style="color:red"><strong>Activity</strong></span>: https://beta.deepnote.com/project/17b487c8-b092-4032-94f5-438ba4eeb1e9</p>
<p>We can use this to check the proper order of the eigenvalues.</p>
<p>The order of eigenvalues can now be changed by changing the order of the eigenvectors and redifining the diagonalization matrix. For example, from small to large.</p>
<p>Then the proper order in the eigenvalues can be obtained</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="n">V1</span><span class="p">,</span><span class="n">V2</span><span class="p">,</span><span class="n">V0</span><span class="p">]</span>
<span class="p">(</span> <span class="n">U</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A@U</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.90098049,  0.        ,  0.        ],
       [ 0.        ,  5.        ,  0.        ],
       [ 0.        ,  0.        , 11.09901951]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-6.18673713e-01, -6.00000000e-01, -5.07191124e-01],
       [-6.33988906e-01,  1.91548674e-16,  7.73342141e-01],
       [-4.64005285e-01,  8.00000000e-01, -3.80393343e-01]])
</pre></div>
</div>
</div>
</div>
<p>Once in the proper order, the mixing angles can be obtained
$<span class="math notranslate nohighlight">\(
\boldsymbol{U}_1=\begin{pmatrix}U_{e1}\\ U_{\mu 1}\\ U_{\tau 1}\end{pmatrix}=\begin{pmatrix}
c_{12} c_{13} \\
-s_{12} c_{23}-c_{12} s_{13} s_{23} e^{i \delta_{\mathrm{CP}}} \\
s_{12} s_{23}-c_{12} s_{13} c_{23} e^{i \delta_{\mathrm{CP}}}
\end{pmatrix},\qquad 
\boldsymbol{U}_2=\begin{pmatrix}U_{e2}\\ U_{\mu 2}\\ U_{\tau 2}\end{pmatrix}=\begin{pmatrix}
s_{12} c_{13} \\
c_{12} c_{23}-s_{12} s_{13} s_{23} e^{i \delta_{\mathrm{CP}}} \\
-c_{12} s_{23}-s_{12} s_{13} c_{23} e^{i \delta_{\mathrm{CP}}}
\end{pmatrix},\qquad
\boldsymbol{U}_3=\begin{pmatrix}U_{e3}\\ U_{\mu 3}\\ U_{\tau 3}\end{pmatrix}=\begin{pmatrix}
s_{13} e^{-i \delta_{\mathrm{CP}}} \\
c_{13} s_{23} \\
c_{13} c_{23}
\end{pmatrix},
\)</span><span class="math notranslate nohighlight">\(
so that
\)</span><span class="math notranslate nohighlight">\(
\tan\theta_{12}=\frac{U_{e2}}{U_{e1}}
\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">θ_12</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span> <span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">θ_12</span><span class="p">,</span> <span class="n">θ_12</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.7700763823614476, 44.122126612013574)
</pre></div>
</div>
</div>
</div>
</section>
<section id="implementation-of-an-algorithm-for-reordering">
<h3>Implementation of an algorithm for reordering<a class="headerlink" href="#implementation-of-an-algorithm-for-reordering" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">λ</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([11.09901951,  0.90098049,  5.        ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">λ</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.90098049,  5.        , 11.09901951])
</pre></div>
</div>
</div>
</div>
<p>Returns the indices that would sort an array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">λ</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span>
<span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 2, 0])
</pre></div>
</div>
</div>
</div>
<p>can be implemented in general with a <em>comprehension</em> list</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-5.07191124e-01,  6.18673713e-01, -6.00000000e-01],
       [ 7.73342141e-01,  6.33988906e-01,  1.91548674e-16],
       [-3.80393343e-01,  4.64005285e-01,  8.00000000e-01]])
</pre></div>
</div>
</div>
</div>
<p>For rebuild</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="nb">tuple</span><span class="p">(</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">V</span><span class="p">[:,</span><span class="n">i</span><span class="p">]]</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span> <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-5.07191124e-01,  6.18673713e-01, -6.00000000e-01],
       [ 7.73342141e-01,  6.33988906e-01,  1.91548674e-16],
       [-3.80393343e-01,  4.64005285e-01,  8.00000000e-01]])
</pre></div>
</div>
</div>
</div>
<p>And for reorder to <code class="docutils literal notranslate"><span class="pre">index</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="nb">tuple</span><span class="p">(</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">V</span><span class="p">[:,</span><span class="n">i</span><span class="p">]]</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">λ</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span> <span class="p">]</span> <span class="p">)</span> <span class="p">]</span>
<span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 6.18673713e-01, -6.00000000e-01, -5.07191124e-01],
       [ 6.33988906e-01,  1.91548674e-16,  7.73342141e-01],
       [ 4.64005285e-01,  8.00000000e-01, -3.80393343e-01]])
</pre></div>
</div>
</div>
</div>
<p>or:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">3</span>
<span class="n">U</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span> <span class="n">V</span><span class="p">[:,</span><span class="n">i</span><span class="p">],</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">index</span>   <span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span> <span class="n">U</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A@U</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.90098049, -0.        , -0.        ],
       [-0.        ,  5.        ,  0.        ],
       [-0.        ,  0.        , 11.09901951]])
</pre></div>
</div>
</div>
</div>
<p>Implementation as function</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">argeig</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="n">λ</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">λ</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">λ</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">λ</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()])</span>
    <span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="nb">tuple</span><span class="p">(</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">V</span><span class="p">[:,</span><span class="n">i</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">λ</span><span class="p">)</span><span class="o">.</span><span class="n">argsort</span><span class="p">()</span> <span class="p">]</span> <span class="p">)</span> <span class="p">]</span>
    <span class="k">return</span> <span class="n">λ</span><span class="p">,</span><span class="n">V</span>
</pre></div>
</div>
</div>
</div>
<!--
def argeig(a):
    """
    Diagonalize with increasing order in the eigenvalues.
  
    See help(np.linalg.eig)
    """
    l,V=np.linalg.eig(a)
    index=np.abs(l).argsort()
    argl= np.sort( l)
    argV=np.c_[ tuple([ np.c_[ V[:,i]] for i in index   ]) ]
    return argl, argV
--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">λ</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">argeig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">λ</span><span class="p">,</span><span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 0.90098049,  5.        , 11.09901951]),
 array([[-5.07191124e-01, -6.18673713e-01, -6.00000000e-01],
        [ 7.73342141e-01, -6.33988906e-01,  1.91548674e-16],
        [-3.80393343e-01, -4.64005285e-01,  8.00000000e-01]]))
</pre></div>
</div>
</div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#1.</span>
<span class="n">λ</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">argeig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="n">λ</span><span class="p">,</span><span class="n">V</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<span class="p">(</span><span class="n">array</span><span class="p">([</span> <span class="mf">0.90098049</span><span class="p">,</span>  <span class="mf">5.</span>        <span class="p">,</span> <span class="mf">11.09901951</span><span class="p">]),</span>
 <span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mf">6.18673713e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.00000000e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">5.07191124e-01</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">6.33988906e-01</span><span class="p">,</span>  <span class="mf">1.91548674e-16</span><span class="p">,</span>  <span class="mf">7.73342141e-01</span><span class="p">],</span>
        <span class="p">[</span><span class="o">-</span><span class="mf">4.64005285e-01</span><span class="p">,</span>  <span class="mf">8.00000000e-01</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.80393343e-01</span><span class="p">]]))</span>   
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#2.</span>
<span class="p">(</span>  <span class="n">V</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A@V</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
<span class="n">array</span><span class="p">([[</span> <span class="mf">0.90098049</span><span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">5.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">],</span>
       <span class="p">[</span> <span class="mf">0.</span>        <span class="p">,</span>  <span class="mf">0.</span>        <span class="p">,</span> <span class="mf">11.09901951</span><span class="p">]])</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">#3.</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="o">-</span> <span class="n">λ</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="o">-</span> <span class="n">λ</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="o">-</span> <span class="n">λ</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
<p><font color="red"><strong>Activity</strong></font>:  Build a function that diagonalize symmetric matrices with the eigenvalues in increasing order in the eigenvalues as a replacement of <code class="docutils literal notranslate"><span class="pre">np.linalg.eig</span></code></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">argeig</span><span class="p">(</span><span class="n">A</span><span class="p">):</span>
    <span class="n">l</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="o">....</span>
    <span class="k">return</span> <span class="n">argl</span><span class="p">,</span> <span class="n">argV</span>
</pre></div>
</div>
</section>
<section id="general-matrix">
<h3>General matrix<a class="headerlink" href="#general-matrix" title="Permalink to this headline">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Example</strong>: Consider the following general real matrix without any specific symmetry</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">6.666746440000001</span>  <span class="p">,</span> <span class="mf">3.1312125300000013</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.23343504999999923</span><span class="p">,</span> <span class="mf">5.890289299999999</span> <span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>In this case we need to make the bidiogalization process of Theorem 2 with the Singular value decomposition (SVD) implemented in Scipy</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span><span class="p">,</span><span class="n">diag</span><span class="p">,</span><span class="n">Udagger</span><span class="o">=</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="o">=</span><span class="n">Udagger</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_diag</span><span class="o">=</span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="nd">@A@U</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
<span class="n">A_diag</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 8., -0.],
       [ 0.,  5.]])
</pre></div>
</div>
</div>
</div>
<p>This is important to stablish that the eigenvectors are determined until ordering and permutations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.8660254, -0.5      ],
       [-0.5      ,  0.8660254]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.70710678, -0.70710678],
       [-0.70710678,  0.70710678]])
</pre></div>
</div>
</div>
</div>
<p>For a general matrix they are just ortogonal matrices</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@U</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<p>We define below a <span class="math notranslate nohighlight">\(2\times 2\)</span> orthogonal matrix:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">orthogonal</span><span class="p">(</span><span class="n">θ</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span> <span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">θ</span><span class="p">)],</span>
                      <span class="p">[</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">θ</span><span class="p">),</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">θ</span><span class="p">)]]</span>   <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">π</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span>
<span class="n">Vp</span><span class="o">=</span><span class="n">orthogonal</span><span class="p">(</span><span class="n">π</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Vp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.5      ,  0.8660254],
       [-0.8660254,  0.5      ]])
</pre></div>
</div>
</div>
</div>
<p>Note that, for <span class="math notranslate nohighlight">\(V=[V_1\vdots V_2]\)</span>, after</p>
<ul class="simple">
<li><p>Interchange <span class="math notranslate nohighlight">\(V_1 \to V_2\)</span>  and <span class="math notranslate nohighlight">\(V_2 \to V_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(V \to -V\)</span>,</p></li>
</ul>
<p>we get <span class="math notranslate nohighlight">\(V'\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Up</span><span class="o">=</span><span class="n">orthogonal</span><span class="p">(</span><span class="n">π</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="n">Up</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.70710678,  0.70710678],
       [-0.70710678,  0.70710678]])
</pre></div>
</div>
</div>
</div>
<p>Note that after</p>
<ul class="simple">
<li><p>Interchange <span class="math notranslate nohighlight">\(U_1 \to U_2\)</span>  and <span class="math notranslate nohighlight">\(U_2 \to U_1\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(U \to -U\)</span>,</p></li>
</ul>
<p>we get <span class="math notranslate nohighlight">\(U'\)</span>.</p>
<p>Since the required trasformations in <span class="math notranslate nohighlight">\(V\)</span> and <span class="math notranslate nohighlight">\(U\)</span> are the same, the Theorem 2 is unnafected, only the order in the eigenvalues change to the normal ordering. In Fact</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A_diag</span><span class="o">=</span><span class="p">(</span><span class="n">Vp</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A@Up</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="n">A_diag</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5., -0.],
       [ 0.,  8.]])
</pre></div>
</div>
</div>
</div>
<p><span style="color:red"><strong>Activity</strong></span>: https://beta.deepnote.com/project/17b487c8-b092-4032-94f5-438ba4eeb1e9</p>
<p><font color="red"><strong>Activity</strong></font>: Solve the system
$<span class="math notranslate nohighlight">\( \boldsymbol{A} \boldsymbol{x}=\boldsymbol{B}\)</span><span class="math notranslate nohighlight">\(
for the previous \)</span> \boldsymbol{A}<span class="math notranslate nohighlight">\( matrix and
\)</span><span class="math notranslate nohighlight">\(\boldsymbol{B}=\begin{bmatrix}
   1\\
   -4\\
   \end{bmatrix}\)</span>$</p>
</section>
<section id="interpretations-of-theorem-2">
<h3>Interpretations of Theorem 2<a class="headerlink" href="#interpretations-of-theorem-2" title="Permalink to this headline">#</a></h3>
<section id="single-diagonalization-matrix">
<h4>Single Diagonalization matrix<a class="headerlink" href="#single-diagonalization-matrix" title="Permalink to this headline">#</a></h4>
<p>In Theorem 2 establishes a unique set of a matrices: <span class="math notranslate nohighlight">\(A\)</span> with its eigenvalues matrix, <span class="math notranslate nohighlight">\(A_{\rm diag}\)</span>, and their eigenvectors matrices <span class="math notranslate nohighlight">\(U\)</span> and <span class="math notranslate nohighlight">\(V\)</span>. However, for a fixed set of eigenvalues and eigenvectors we can have several possibilities of <span class="math notranslate nohighlight">\(A'\)</span> matrices. For example, if we fix <span class="math notranslate nohighlight">\(U'=\boldsymbol{1}\)</span></p>
<div class="amsmath math notranslate nohighlight" id="equation-2152f715-f0ef-4fe8-86c8-2ed1a0283a28">
<span class="eqno">(26)<a class="headerlink" href="#equation-2152f715-f0ef-4fe8-86c8-2ed1a0283a28" title="Permalink to this equation">#</a></span>\[\begin{equation}
  {V'}^\dagger \boldsymbol{A'}=\boldsymbol{A}_{\text{diag}}\,,
\end{equation}\]</div>
<p>so that</p>
<div class="amsmath math notranslate nohighlight" id="equation-68243e2f-d21e-44f9-a81c-c98944e625e9">
<span class="eqno">(27)<a class="headerlink" href="#equation-68243e2f-d21e-44f9-a81c-c98944e625e9" title="Permalink to this equation">#</a></span>\[\begin{equation}
  \boldsymbol{A}'=V'\boldsymbol{A}_{\text{diag}}
\end{equation}\]</div>
<p>Therefore: Under this conditions, for a fixed set of eigenvalues and eigenvectors (associated to the matrix <span class="math notranslate nohighlight">\(V'\)</span>) there is a unique <span class="math notranslate nohighlight">\(A'\)</span> matrix</p>
<p><strong>Example</strong>
Let <span class="math notranslate nohighlight">\(V'=U^{\operatorname{T}} V\)</span> in the previous example. Find the matrix <span class="math notranslate nohighlight">\(A'\)</span> which gives rise to the same eigenvalues</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Adiag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
                 <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">8</span><span class="p">]]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Vp</span><span class="o">=</span><span class="n">orthogonal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@orthogonal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span>
<span class="n">Vp</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.96592583,  0.25881905],
       [-0.25881905,  0.96592583]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Ap</span><span class="o">=</span><span class="n">Vp</span><span class="nd">@Adiag</span>
<span class="n">Ap</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 4.82962913,  2.07055236],
       [-1.29409523,  7.72740661]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">Vp</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@Ap</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[5., 0.],
       [0., 8.]])
</pre></div>
</div>
</div>
</div>
<p>Finally, we can use the full procedure of hermitic matrices to obtain the bidiagonal matrices <span class="math notranslate nohighlight">\(U,V\)</span></p>
<p><strong>Example</strong>:
Diagonalize the matrix <span class="math notranslate nohighlight">\(A\)</span> by using the Theorem 1 instead</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mf">6.66674644</span><span class="p">,</span>  <span class="mf">3.13121253</span><span class="p">],</span>
            <span class="p">[</span><span class="o">-</span><span class="mf">0.23343505</span><span class="p">,</span>  <span class="mf">5.8902893</span> <span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="nd">@A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[54.25      , 16.88749537],
       [16.88749537, 34.74999996]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[44.50000002, 19.50000001],
       [19.50000001, 44.49999995]])
</pre></div>
</div>
</div>
</div>
<p>→ is obtained with <code class="docutils literal notranslate"><span class="pre">&lt;ALT</span> <span class="pre">GR&gt;+i</span></code> or, similarly: ↓←</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">λ2</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span> <span class="n">A</span><span class="nd">@A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">λ2</span><span class="p">,</span><span class="s1">&#39;→&#39;</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">λ2</span><span class="p">))</span>
<span class="c1">#V=np.c_[ -V[:,0],V[:,0]  ]</span>
<span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[63.99999999 24.99999997] → [8. 5.]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.8660254, -0.5      ],
       [ 0.5      ,  0.8660254]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">λ2p</span><span class="p">,</span><span class="n">U</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span> <span class="n">A</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A</span>  <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">λ2</span><span class="p">))</span>
<span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[8. 5.]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.70710678, -0.70710678],
       [ 0.70710678,  0.70710678]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">V</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A@U</span> <span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 8., -0.],
       [ 0.,  5.]])
</pre></div>
</div>
</div>
</div>
<p><span style="color:red"><strong>Actividad:</strong></span> Make the algorithm of reordering for theorem 2</p>
</section>
</section>
</section>
<section id="mixed-terms">
<h2>Mixed terms<a class="headerlink" href="#mixed-terms" title="Permalink to this headline">#</a></h2>
<p>Let:</p>
<div class="amsmath math notranslate nohighlight" id="equation-a1aececa-0219-4027-9da5-22f9f412f5ff">
<span class="eqno">(28)<a class="headerlink" href="#equation-a1aececa-0219-4027-9da5-22f9f412f5ff" title="Permalink to this equation">#</a></span>\[\begin{align}
X' = 
\begin{bmatrix}
B \\ 
W \\
\end{bmatrix}
\end{align}\]</div>
<p>Consider  the quadratic equation</p>
<div class="amsmath math notranslate nohighlight" id="equation-0a3d37ed-fec4-40df-8651-a728521fef58">
<span class="eqno">(29)<a class="headerlink" href="#equation-0a3d37ed-fec4-40df-8651-a728521fef58" title="Permalink to this equation">#</a></span>\[\begin{align}
X^{\prime\operatorname{T}} M X^\prime=&amp; \begin{bmatrix}
B &amp; W 
\end{bmatrix}
\begin{bmatrix}
M_{11} &amp; M_{12} \\
M_{12} &amp; M_{22} \\
\end{bmatrix}
\begin{bmatrix}
B \\ 
W \\
\end{bmatrix}\\
=&amp; 
\begin{bmatrix}
B &amp; W 
\end{bmatrix}
\begin{bmatrix}
M_{11}B + M_{12}W \\
M_{12}B + M_{22}W \\
\end{bmatrix}\\
=&amp; 
B( M_{11}B + M_{12}W)+  W ( M_{12}B + M_{22}W )\\
=&amp;M_{11} B^2 + 2M_{12} BW+ M_{22} W^2\,. 
\end{align}\]</div>
<p>The quadratic equation is in terms of: <span class="math notranslate nohighlight">\(M_{11}\)</span>, <span class="math notranslate nohighlight">\(M_{12}\)</span> y <span class="math notranslate nohighlight">\(M_{22}\)</span></p>
<p>We can simplify this expression if we change to a new basis
$<span class="math notranslate nohighlight">\(
X=\begin{bmatrix}
A\\
Z
\end{bmatrix}
\)</span><span class="math notranslate nohighlight">\(
in which \)</span>M<span class="math notranslate nohighlight">\( is diagonal, in such a case the crossed term would disappear. 
The rotation from \)</span>X’\to X$ is defined by</p>
<div class="amsmath math notranslate nohighlight" id="equation-56d79c6e-bc0f-4fe8-9e47-36bd3356b086">
<span class="eqno">(30)<a class="headerlink" href="#equation-56d79c6e-bc0f-4fe8-9e47-36bd3356b086" title="Permalink to this equation">#</a></span>\[\begin{align}
X'=
\begin{bmatrix}
B\\
W
\end{bmatrix}\equiv
\begin{bmatrix}
\cos\theta &amp; \sin\theta\\
-\sin\theta &amp; \cos\theta
\end{bmatrix}
\begin{bmatrix}
A\\
Z
\end{bmatrix}=
V X 
\end{align}\]</div>
<p>where <span class="math notranslate nohighlight">\(V\)</span> is the rotation matrix
$<span class="math notranslate nohighlight">\(
V=\begin{bmatrix}
\cos\theta &amp; \sin\theta\\
-\sin\theta &amp; \cos\theta
\end{bmatrix}.
\)</span>$
Therefore</p>
<div class="amsmath math notranslate nohighlight" id="equation-64e3d7ed-e8e4-452f-98b7-910a5e2311a8">
<span class="eqno">(31)<a class="headerlink" href="#equation-64e3d7ed-e8e4-452f-98b7-910a5e2311a8" title="Permalink to this equation">#</a></span>\[\begin{align}
X\equiv
\begin{bmatrix}
A\\
Z
\end{bmatrix}=V^{\operatorname{T}} X' \to X^{\operatorname{T}}= X^{\prime\operatorname{T}} V\,,
\end{align}\]</div>
<p>In the new basis</p>
<div class="amsmath math notranslate nohighlight" id="equation-06b81749-d899-4ef7-822d-eb35e2180ee2">
<span class="eqno">(32)<a class="headerlink" href="#equation-06b81749-d899-4ef7-822d-eb35e2180ee2" title="Permalink to this equation">#</a></span>\[\begin{align}
X^{\prime\operatorname{T}} M X^\prime=&amp;X^{\prime\operatorname{T}}V V^{\operatorname{T}} M V V^{\operatorname{T}} X^\prime\\
=&amp;(X^{\prime\operatorname{T}}V) (V^{\operatorname{T}} M V) (V^{\operatorname{T}} X^\prime)\\
=&amp; X^{\operatorname{T}} M_{\text{diag}} X \\
=&amp;  \lambda_1 A^2+\lambda_2 Z^2\,.
\end{align}\]</div>
<p>such that <span class="math notranslate nohighlight">\(|\lambda_1|\le|\lambda_2|\)</span>, where</p>
<div class="amsmath math notranslate nohighlight" id="equation-d486de12-70d5-4053-9322-284e308e1cd1">
<span class="eqno">(33)<a class="headerlink" href="#equation-d486de12-70d5-4053-9322-284e308e1cd1" title="Permalink to this equation">#</a></span>\[\begin{align}
M_{\text{diag}}\equiv V^{\operatorname{T}} M V=\begin{bmatrix}
\lambda_1 &amp; 0 \\ 
0 &amp; \lambda_2 \\
\end{bmatrix}\,,
\end{align}\]</div>
<p>In this basis, the quadratic equation is in terms of eigenvalues and mixing angle, <span class="math notranslate nohighlight">\(\theta\)</span>.
Therefore, there are not longer mixed terms.</p>
<p>The diagonalization of quadratic equations can be straightforwardly  generalized to <span class="math notranslate nohighlight">\(n\)</span>-th degree equations in terms of <span class="math notranslate nohighlight">\(n\times n\)</span> matrices</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">g</span> <span class="o">=</span><span class="mf">0.64996</span>
<span class="n">gp</span><span class="o">=</span><span class="mf">0.35523</span>
<span class="n">v</span><span class="o">=</span><span class="mf">246.22046</span> <span class="c1">#GeV</span>
</pre></div>
</div>
</div>
</div>
<section id="example-electroweak-interactions">
<h3>Example: Electroweak interactions<a class="headerlink" href="#example-electroweak-interactions" title="Permalink to this headline">#</a></h3>
<p>To understand the electromagnetic and weak fundamental interactions, the mathematical formulation need to be done in one basis where the photon field, denoted with a symbol <span class="math notranslate nohighlight">\(A\)</span>, is still not well defined. Instead, the field <span class="math notranslate nohighlight">\(B\)</span>, the precursor of <span class="math notranslate nohighlight">\(A\)</span>, appears along with the weak field <span class="math notranslate nohighlight">\(W\)</span>, the precursor of the electroweak field <span class="math notranslate nohighlight">\(Z\)</span>. In the <em>mathematical</em> basis we have then</p>
<div class="amsmath math notranslate nohighlight" id="equation-c350e71a-07d2-4958-91be-475e2ef1303c">
<span class="eqno">(34)<a class="headerlink" href="#equation-c350e71a-07d2-4958-91be-475e2ef1303c" title="Permalink to this equation">#</a></span>\[\begin{align}
X' = 
\begin{bmatrix}
B \\ 
W \\
\end{bmatrix},
\end{align}\]</div>
<p>and there, the symmetric mass matrix is calculated as (Details here: <a class="reference external" href="https://github.com/restrepo/TCC/releases/latest">PDF</a>)</p>
<!-- 
sin2θ=0.23
θ=np.arcsin( np.sqrt(sin2θ)  )
print(θ)
MZ=91.1876
GF=1.166371E-5
v=1/np.sqrt(np.sqrt(2)*GF)
g=2*MZ*np.cos(θ)/v
gp=g*np.tan(θ)
gp
--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span><span class="o">=</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">gp</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="n">gp</span><span class="p">],</span>
                     <span class="p">[</span><span class="o">-</span><span class="n">g</span><span class="o">*</span><span class="n">gp</span><span class="p">,</span> <span class="n">g</span><span class="o">**</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1912.52692086, -3499.32718938],
       [-3499.32718938,  6402.67629426]])
</pre></div>
</div>
</div>
</div>
<p>Checking that the determinant is zero</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0
</pre></div>
</div>
</div>
</div>
<p>This imply that one egivanlue is zero</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eigvals</span><span class="p">(</span><span class="n">M</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([   0.        , 8315.20321512])
</pre></div>
</div>
</div>
</div>
<p>which means that the matrix rank, the number of non-zero eigenvalues, is 1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_rank</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>To make the change to the <em>phyisical</em> basis,
$<span class="math notranslate nohighlight">\(
X=\begin{bmatrix}
A\\
Z
\end{bmatrix}
\)</span><span class="math notranslate nohighlight">\(
through the rotation matrix
\)</span><span class="math notranslate nohighlight">\(
V=\begin{bmatrix}
\cos\theta_W &amp; \sin\theta_W\\
-\sin\theta_W &amp; \cos\theta_W
\end{bmatrix},
\)</span>$
the following transformation need to be established</p>
<div class="amsmath math notranslate nohighlight" id="equation-952f0471-7ec4-4f1d-806e-544a6b484668">
<span class="eqno">(35)<a class="headerlink" href="#equation-952f0471-7ec4-4f1d-806e-544a6b484668" title="Permalink to this equation">#</a></span>\[\begin{align}
X'=
\begin{bmatrix}
B\\
W
\end{bmatrix}\equiv
\begin{bmatrix}
\cos\theta_W &amp; \sin\theta_W\\
-\sin\theta_W &amp; \cos\theta_W
\end{bmatrix}
\begin{bmatrix}
A\\
Z
\end{bmatrix}=
V X\,,
\end{align}\]</div>
<p>such that <span class="math notranslate nohighlight">\(V\)</span> is the diagonalization matrix of <span class="math notranslate nohighlight">\(M\)</span></p>
<div class="math notranslate nohighlight">
\[M_{\text{diag}}=V^{\operatorname{T}} M V\]</div>
<p>with the normal ordering: <span class="math notranslate nohighlight">\(|\lambda_1|\le|\lambda_2|\)</span>, and</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(V\)</span> → Diagonalization matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(V\)</span> → Ortogonal matrix</p></li>
<li><p><span class="math notranslate nohighlight">\(V\)</span> → Rotation matrix</p></li>
</ul>
<p>To obtain the eigensystem, we use</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">λ</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>which in fact satisfy</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span> <span class="n">V</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@M@V</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  -0.        ,    0.        ],
       [   0.        , 8315.20321512]])
</pre></div>
</div>
</div>
</div>
<p>Since the first (zero) eigenvalue is the one associated to <span class="math notranslate nohighlight">\(A\)</span>, we can interpret directly the rotation matrix without changing the order of the eigenvectors</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.87749437,  0.47958694],
       [-0.47958694, -0.87749437]])
</pre></div>
</div>
</div>
</div>
<p>Note that in fact, the absolute value of the first element of the first eigenvector is the larger one and corresponds to the component along the <span class="math notranslate nohighlight">\(B\)</span>-axis.</p>
<p>Therefore</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">θ_W</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span> <span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="n">θ_W</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5001839211647364
</pre></div>
</div>
</div>
</div>
<p>The eigenvalue associated to <span class="math notranslate nohighlight">\(Z\)</span> is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mZ</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">λ</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">mZ</span> <span class="c1">#GeV</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>91.18773610041056
</pre></div>
</div>
</div>
</div>
<p>corresponding to the  <span class="math notranslate nohighlight">\(Z\)</span> mass in units of <span class="math notranslate nohighlight">\(\text{GeV}/c^2\)</span>. As a reference, the proton mass is approximately <span class="math notranslate nohighlight">\(1\ \text{GeV}/c^2\)</span></p>
<p>The physical observable associated to the <em>weak mixing angle</em>, <span class="math notranslate nohighlight">\(\theta_W\)</span>, is (see <a class="reference external" href="https://pdg.lbl.gov/2019/reviews/rpp2018-rev-phys-constants.pdf">PDF</a>, along with the <span class="math notranslate nohighlight">\(Z^0\)</span> <em>boson mass</em>, <span class="math notranslate nohighlight">\(m_Z\)</span>)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">θ_W</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.23000362966286086
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="corolary-1-theorem-ii">
<h2>Corolary 1 Theorem II<a class="headerlink" href="#corolary-1-theorem-ii" title="Permalink to this headline">#</a></h2>
<p>For a unique unitary <span class="math notranslate nohighlight">\(n\times n\)</span> matrix <span class="math notranslate nohighlight">\(\boldsymbol{V}\)</span> and a set of unique of eigenvalues <span class="math notranslate nohighlight">\(\lambda_1,\lambda_2,\ldots\lambda_n\)</span> there exists an infite set of mass matrices <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>, associated to the infinite sets of matrices <span class="math notranslate nohighlight">\(\boldsymbol{U}\)</span>, such that
$<span class="math notranslate nohighlight">\(  \boldsymbol{V}^\dagger\boldsymbol{A}\,\boldsymbol{U}=\boldsymbol{A}_{\text{diag}}\,, \)</span><span class="math notranslate nohighlight">\(
where 
\)</span>\boldsymbol{A}_{\text{diag}}=\operatorname{diag}(\lambda_1,\lambda_2,\ldots \lambda_n)<span class="math notranslate nohighlight">\( is the diagonalized mass matrix. In particular, if \)</span>\boldsymbol{A}<span class="math notranslate nohighlight">\( is hermitic then there is only one possibility for \)</span>\boldsymbol{U}=\boldsymbol{V}<span class="math notranslate nohighlight">\( and therefore \)</span>\boldsymbol{A}$ is unique.</p>
</section>
<section id="corolary-2-theorem-ii">
<h2>Corolary 2 Theorem II<a class="headerlink" href="#corolary-2-theorem-ii" title="Permalink to this headline">#</a></h2>
<p>An unique hermitic mass matrix, <span class="math notranslate nohighlight">\(\boldsymbol{A}\)</span>, can be generated from an infinite set of arbitrary matrices <span class="math notranslate nohighlight">\(\boldsymbol{Y}\)</span>, such that
<span class="math notranslate nohighlight">\(\boldsymbol{A}=\boldsymbol{Y}^{\dagger}\boldsymbol{Y}\)</span></p>
<section id="example-neutrino-mass-matrix">
<h3>Example: Neutrino mass matrix<a class="headerlink" href="#example-neutrino-mass-matrix" title="Permalink to this headline">#</a></h3>
<p>Returning back to the neutrino mixing discussion, it is worth noticing that in the mathematical basis
$<span class="math notranslate nohighlight">\(
N=\left(\begin{array}{l}
\left|\nu_{e}\right\rangle \\
\left|\nu_{\mu}\right\rangle \\
\left|\nu_{\tau}\right\rangle
\end{array}\right)
\)</span><span class="math notranslate nohighlight">\(
the mass matrix, \)</span>\mathcal{M}_\nu<span class="math notranslate nohighlight">\( is non-diagonal. However, if we assume that it is hermitic, then an unitary tranformation (rotation in the symmetric case), \)</span>\boldsymbol{U}<span class="math notranslate nohighlight">\( ,can be defined to diagonal basis as
\)</span><span class="math notranslate nohighlight">\(
\left(\begin{array}{l}
\left|\nu_{e}\right\rangle \\
\left|\nu_{\mu}\right\rangle \\
\left|\nu_{\tau}\right\rangle
\end{array}\right)= \boldsymbol{U}\left(\begin{array}{l}
\left|\nu_{1}\right\rangle \\
\left|\nu_{2}\right\rangle \\
\left|\nu_{3}\right\rangle
\end{array}\right),
\)</span><span class="math notranslate nohighlight">\(
which is identified as the diagonalization matrix
\)</span><span class="math notranslate nohighlight">\(
\boldsymbol{U}^\dagger \mathcal{M}_\nu \boldsymbol{U}=\operatorname{diag}(m_1,m_2,m_3).
\)</span>$</p>
<p>According to the corrolary there is a set of infinite matrices complatible with an unique <span class="math notranslate nohighlight">\(\boldsymbol{U}\)</span> and the eigenvalues <span class="math notranslate nohighlight">\(m_1,m_2,m_3\)</span></p>
</section>
<section id="casas-ibarra-parameterization">
<h3>Casas-Ibarra parameterization<a class="headerlink" href="#casas-ibarra-parameterization" title="Permalink to this headline">#</a></h3>
<p>Consider a <span class="math notranslate nohighlight">\(n\times n\)</span> symmetric matrix <span class="math notranslate nohighlight">\(A\)</span>. We can assumme without lost of generality that this can be generated from a matrix <span class="math notranslate nohighlight">\(Y\)</span> such that
$<span class="math notranslate nohighlight">\(
A=Y^{\operatorname{T}}Y
\)</span><span class="math notranslate nohighlight">\(
Theorem 1 gurantees that exists an ortogonal matrix \)</span>U<span class="math notranslate nohighlight">\( such that
\)</span><span class="math notranslate nohighlight">\(
U^{\operatorname{T}} A U=U^{\operatorname{T}} Y^{\operatorname{T}}Y U=D_\lambda
\)</span><span class="math notranslate nohighlight">\(
where
\)</span><span class="math notranslate nohighlight">\(
D_{\lambda}=A_{\text{diag}}=\operatorname{diag}\left(\lambda_1,\lambda_2,\ldots,\lambda_n\right)
\)</span><span class="math notranslate nohighlight">\(
where \)</span>\lambda_i<span class="math notranslate nohighlight">\( are the eigenvalues of \)</span>A$. Therefore</p>
<div class="amsmath math notranslate nohighlight" id="equation-af2fd129-567d-4fd4-aca1-3528beb99dd8">
<span class="eqno">(36)<a class="headerlink" href="#equation-af2fd129-567d-4fd4-aca1-3528beb99dd8" title="Permalink to this equation">#</a></span>\[\begin{align}
 Y^{\operatorname{T}}Y =&amp;U D_\lambda U^{\operatorname{T}}\\
 =&amp;U D_{\sqrt{\lambda}} D_{\sqrt{\lambda}} U^{\operatorname{T}}\\
\end{align}\]</div>
<p>where
$<span class="math notranslate nohighlight">\(
D_{\sqrt{\lambda}}=\operatorname{diag}\left(\sqrt{\lambda_1},\sqrt{\lambda_2},\ldots \sqrt{\lambda_n}\right)
\)</span><span class="math notranslate nohighlight">\(
Therefore, exists an ortogonal arbitrary matrix \)</span>R<span class="math notranslate nohighlight">\(, such that
\)</span><span class="math notranslate nohighlight">\(
 Y^{\operatorname{T}}Y =U D_{\sqrt{\lambda}}R^{\operatorname{T}}R D_{\sqrt{\lambda}} U^{\operatorname{T}}
\)</span>$</p>
<p>In this way, the matrix <span class="math notranslate nohighlight">\(Y\)</span> can be parameterized in terms of <span class="math notranslate nohighlight">\(R\)</span> as
$<span class="math notranslate nohighlight">\(
Y=R D_{\sqrt{\lambda}} U^{\operatorname{T}}
\)</span>$</p>
<ol class="simple">
<li><p>By using the previous equations, build a <span class="math notranslate nohighlight">\(2\times 2\)</span>  <span class="math notranslate nohighlight">\(Y\)</span> matrix  with the following conditions</p></li>
</ol>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(R\)</span> is an orthogonal matrix with a rotation angle as a random number between <span class="math notranslate nohighlight">\((0,2\pi)\)</span>. Use your identification number as the seed of the random number generator.</p></li>
<li><p>The eigenvalues are <span class="math notranslate nohighlight">\(\lambda_1=2\)</span> and <span class="math notranslate nohighlight">\(\lambda_2=4\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(U\)</span> is a diagonalization matrix with mixing angle <span class="math notranslate nohighlight">\(\pi/4\)</span></p></li>
</ul>
<ol class="simple">
<li><p>Build the matrix <span class="math notranslate nohighlight">\(A\)</span> and check that has the proper eigenvalues and eigenvectors</p></li>
</ol>
<ol class="simple">
<li></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1">#np.random.seed(98554575)</span>

<span class="n">θ</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">orthogonal</span><span class="p">(</span><span class="n">θ</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">θ</span><span class="p">),</span>  <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">θ</span><span class="p">)],</span>
                      <span class="p">[</span> <span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">θ</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span> <span class="p">]]</span>    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">λ1</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">λ2</span><span class="o">=</span><span class="mi">4</span>
<span class="n">R</span><span class="o">=</span><span class="n">orthogonal</span><span class="p">(</span><span class="n">θ</span><span class="p">)</span>
<span class="n">U</span><span class="o">=</span><span class="n">orthogonal</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span>
<span class="n">D_sqrtλ</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">([</span><span class="n">λ1</span><span class="p">,</span><span class="n">λ2</span><span class="p">])</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R=&#39;</span><span class="p">)</span>
<span class="n">R</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>R=
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-0.97721326, -0.21225986],
       [ 0.21225986, -0.97721326]])
</pre></div>
</div>
</div>
</div>
<p>From the equation for <span class="math notranslate nohighlight">\(Y\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">R</span><span class="p">,</span><span class="n">D_sqrtλ</span><span class="p">),</span> <span class="n">U</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="p">)</span>
<span class="n">Y</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-1.27739403,  0.67703248],
       [-1.16972838, -1.5942481 ]])
</pre></div>
</div>
</div>
</div>
<p>The symmetric matrix is</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Unique mass matrix</span>
<span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">Y</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span> <span class="n">Y</span><span class="p">)</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[3., 1.],
       [1., 3.]])
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">λ</span><span class="p">,</span><span class="n">Unew</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Eigenvalues=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">λ</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U=&#39;</span><span class="p">)</span>
<span class="n">Unew</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Eigenvalues=[4. 2.]
U=
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.70710678, -0.70710678],
       [ 0.70710678,  0.70710678]])
</pre></div>
</div>
</div>
</div>
<p>After the reordering of the eigenvalues, we would obtain the original <span class="math notranslate nohighlight">\(U\)</span> and therefore</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">U</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span><span class="nd">@A@U</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[2., 0.],
       [0., 4.]])
</pre></div>
</div>
</div>
</div>
<p>In this way, there is an infinity set of symmetric matrices <span class="math notranslate nohighlight">\(A\)</span> which have the same eigenvalues and eigenvectors</p>
</section>
<section id="thdm-cp-even-masses-and-mixing">
<h3>THDM CP-even masses and mixing<a class="headerlink" href="#thdm-cp-even-masses-and-mixing" title="Permalink to this headline">#</a></h3>
<p>Some times, the convention to identify the large projections in the non-diagonal basis.</p>
<p>In this case we have the rotation between an interaction basis and a physical basis defined as
$$</p>
<div class="amsmath math notranslate nohighlight" id="equation-a4b515a1-4add-4409-b271-77b2aadf81b5">
<span class="eqno">(37)<a class="headerlink" href="#equation-a4b515a1-4add-4409-b271-77b2aadf81b5" title="Permalink to this equation">#</a></span>\[\begin{pmatrix}
R_1\\
R_2\\
\end{pmatrix}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-d6508178-e6ec-4c25-a903-c78ddb76c8e4">
<span class="eqno">(38)<a class="headerlink" href="#equation-d6508178-e6ec-4c25-a903-c78ddb76c8e4" title="Permalink to this equation">#</a></span>\[\begin{pmatrix}
\cos\alpha &amp; -\sin\alpha \\
\sin\alpha &amp; \cos\alpha \\
\end{pmatrix}\]</div>
<div class="amsmath math notranslate nohighlight" id="equation-8ff11258-35cb-44b0-8750-5a2cb1759d64">
<span class="eqno">(39)<a class="headerlink" href="#equation-8ff11258-35cb-44b0-8750-5a2cb1759d64" title="Permalink to this equation">#</a></span>\[\begin{pmatrix}
H\\
h\\
\end{pmatrix}\]</div>
<p>$<span class="math notranslate nohighlight">\(
Since the diagonalization of a symmetric \)</span>2\times 2<span class="math notranslate nohighlight">\( matrix can be obtained analitically,
here we build a \)</span>2\times 2<span class="math notranslate nohighlight">\( symmetric matrix from the eigenvalues, \)</span>m_H<span class="math notranslate nohighlight">\( and \)</span>m_h<span class="math notranslate nohighlight">\(, and the rotation angle, \)</span>\alpha$, and check with the numerical results by using a benchmark point:</p>
<p>→ <a class="reference external" href="https://twiki.cern.ch/twiki/pub/LHCPhysics/LHCHXSWG3Benchmarks2HDM/Exotic_Benchmarks.pdf">Benchmark point BP9</a></p>
<p>Here, the eigenvalue <span class="math notranslate nohighlight">\(m_h\)</span> is defined as the one with the eigenvector with the larger projection upon <span class="math notranslate nohighlight">\(R_2\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="n">G_F</span><span class="o">=</span><span class="mf">1.1663787E-5</span> <span class="c1">#GeV^-2</span>
<span class="n">v</span><span class="o">=</span><span class="mi">1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">2.</span><span class="p">)</span><span class="o">*</span><span class="n">G_F</span><span class="p">)</span> <span class="c1"># GeV</span>

<span class="c1">#*********  BP9 ************</span>
<span class="n">tanβ</span><span class="o">=</span><span class="mi">2</span>
<span class="n">sinβ_α</span><span class="o">=</span><span class="mf">0.6</span>   <span class="c1"># sin(β-α)</span>
<span class="n">m_h</span> <span class="o">=</span> <span class="mi">125</span>    <span class="c1"># GeV/c^2 (c→1)</span>
<span class="n">m_H</span> <span class="o">=</span> <span class="mi">300</span>    <span class="c1"># GeV/c^2 </span>
<span class="n">m_A</span> <span class="o">=</span> <span class="mi">300</span>    <span class="c1"># GeV/c^2</span>
<span class="n">m_Hp</span><span class="o">=</span> <span class="mi">400</span>    <span class="c1"># GeV/c^2</span>
<span class="n">m2_12</span><span class="o">=</span><span class="mi">100</span><span class="o">**</span><span class="mi">2</span> <span class="c1"># (GeV/c^2)^2</span>
<span class="c1">#***********************</span>
</pre></div>
</div>
</div>
</div>
<p>The formula for the mass matrix in terms of the previous parameters can be found in [<a class="reference external" href="https://arxiv.org/pdf/hep-ph/0207010.pdf">hep-ph/0207010</a>,<a class="reference external" href="https://arxiv.org/pdf/1507.00933.pdf">arXiv:1507.00933</a>]. We assumme here that <span class="math notranslate nohighlight">\(\lambda_6=\lambda_7=0\)</span>. See Appendix D of  [<a class="reference external" href="https://arxiv.org/pdf/hep-ph/0207010.pdf">hep-ph/0207010</a>] for full formulas</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">β</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">tanβ</span><span class="p">)</span>
<span class="n">α</span><span class="o">=</span><span class="n">β</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">sinβ_α</span><span class="p">)</span> <span class="c1"># &lt;= np.pi/2~1.57</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;α=&#39;</span><span class="p">,</span><span class="n">α</span><span class="p">)</span>
<span class="n">λ1</span>  <span class="o">=</span><span class="p">(</span><span class="n">m_H</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">α</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">m_h</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">α</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">m2_12</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">β</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">λ_2</span> <span class="o">=</span><span class="p">(</span><span class="n">m_H</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">α</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">m_h</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">α</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">m2_12</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">β</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
<span class="n">λ3</span>  <span class="o">=</span><span class="p">((</span><span class="n">m_H</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">m_h</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">α</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">α</span><span class="p">)</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">m_Hp</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">-</span><span class="n">m2_12</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">β</span><span class="p">))</span>
<span class="n">λ4</span>  <span class="o">=</span><span class="p">((</span><span class="n">m_A</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">m_Hp</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">+</span><span class="n">m2_12</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">β</span><span class="p">))</span>
<span class="n">λ5</span>  <span class="o">=</span><span class="p">(</span><span class="n">m2_12</span><span class="o">-</span><span class="n">m_A</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">β</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">β</span><span class="p">))</span>
<span class="n">λ345</span><span class="o">=</span><span class="n">λ3</span><span class="o">+</span><span class="n">λ4</span><span class="o">+</span><span class="n">λ5</span>
<span class="n">λ345</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>α= 0.46364760900080604
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.63919914780058
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">M2</span><span class="p">(</span><span class="n">β</span><span class="p">,</span><span class="n">λ1</span><span class="p">,</span><span class="n">λ_2</span><span class="p">,</span><span class="n">λ5</span><span class="p">,</span><span class="n">λ345</span><span class="p">,</span><span class="n">m2_12</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="mf">246.2</span><span class="p">):</span>
    <span class="n">mA2</span><span class="o">=</span><span class="n">m2_12</span><span class="o">/</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">β</span><span class="p">))</span><span class="o">-</span><span class="n">λ5</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">M11</span><span class="o">=</span><span class="n">λ1</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">mA2</span><span class="o">+</span><span class="n">λ5</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">M12</span><span class="o">=</span><span class="p">(</span><span class="n">λ345</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="p">(</span><span class="n">mA2</span><span class="o">+</span><span class="n">λ5</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">β</span><span class="p">)</span>
    <span class="n">M22</span><span class="o">=</span><span class="n">λ_2</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="p">(</span><span class="n">mA2</span><span class="o">+</span><span class="n">λ5</span><span class="o">*</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">β</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="n">M11</span><span class="p">,</span> <span class="n">M12</span><span class="p">],</span>
                      <span class="p">[</span><span class="n">M12</span><span class="p">,</span> <span class="n">M22</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<p>In this way, from the BP point, we can build the <span class="math notranslate nohighlight">\(2\times2\)</span> symmetric mass <span class="math notranslate nohighlight">\(\mathcal{M}\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ℳ2</span><span class="o">=</span><span class="n">M2</span><span class="p">(</span><span class="n">β</span><span class="p">,</span><span class="n">λ1</span><span class="p">,</span><span class="n">λ_2</span><span class="p">,</span><span class="n">λ5</span><span class="p">,</span><span class="n">λ345</span><span class="p">,</span><span class="n">m2_12</span><span class="p">,</span><span class="n">v</span><span class="o">=</span><span class="n">v</span><span class="p">)</span>
<span class="n">ℳ2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[75125., 29750.],
       [29750., 30500.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">m2</span><span class="p">,</span><span class="n">V</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">ℳ2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>By using the proper basis
$<span class="math notranslate nohighlight">\(
\left(\begin{array}{cc}
m_{H}^{2} &amp; 0 \\
0 &amp; m_{h}^{2}
\end{array}\right)=\left(\begin{array}{rr}
\cos{\alpha} &amp; \sin{\alpha} \\
-\sin{\alpha} &amp; \cos{\alpha}
\end{array}\right)\left(\begin{array}{ll}
\mathcal{M}_{11}^{2} &amp; \mathcal{M}_{12}^{2} \\
\mathcal{M}_{12}^{2} &amp; \mathcal{M}_{22}^{2}
\end{array}\right)\left(\begin{array}{lr}
\cos{\alpha} &amp; -\sin{\alpha} \\
\sin{\alpha} &amp; \cos{\alpha}
\end{array}\right).
\)</span><span class="math notranslate nohighlight">\(
Therefore
\)</span><span class="math notranslate nohighlight">\(
U=\left(\begin{array}{lr}
\cos{\alpha} &amp; -\sin{\alpha} \\
\sin{\alpha} &amp; \cos{\alpha}
\end{array}\right).
\)</span><span class="math notranslate nohighlight">\(
Since \)</span>-\pi/2\le\alpha\le\pi/2<span class="math notranslate nohighlight">\( then \)</span>\cos\alpha\ge 0<span class="math notranslate nohighlight">\(. In this way, we must obtain \)</span>\alpha<span class="math notranslate nohighlight">\( from \)</span>\tan\alpha<span class="math notranslate nohighlight">\(  to avoid ambiguities with a global sign in the second eigenvector 
\)</span><span class="math notranslate nohighlight">\(
\tan\alpha=\frac{\sin\alpha}{\cos\alpha}=-\frac{U_{01}}{U_{11}}\,.
\)</span>$</p>
<p>The eigenvector with large projection in the second component along <span class="math notranslate nohighlight">\(R_2\)</span> ( Interaction basis <span class="math notranslate nohighlight">\((R_1,R_2)\)</span>  → Mass basis <span class="math notranslate nohighlight">\((H^0,h^0)\)</span>) is the associated with the standard model Higgs mass, <span class="math notranslate nohighlight">\(m_h\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">V</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.89442719, -0.4472136 ],
       [ 0.4472136 ,  0.89442719]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">&lt;=</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">V</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]):</span>
    <span class="n">H</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">h</span><span class="o">=</span><span class="mi">1</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">H</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">h</span><span class="o">=</span><span class="mi">0</span>
<span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">h</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0, 1)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="n">V</span><span class="p">[:,</span><span class="n">H</span><span class="p">],</span><span class="n">V</span><span class="p">[:,</span><span class="n">h</span><span class="p">]</span>  <span class="p">]</span>
<span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.89442719, -0.4472136 ],
       [ 0.4472136 ,  0.89442719]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M2diag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">U</span><span class="o">.</span><span class="n">transpose</span><span class="p">(),</span><span class="n">ℳ2</span><span class="p">),</span> <span class="n">U</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span>
<span class="n">mH</span><span class="p">,</span><span class="n">mh</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M2diag</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">M2diag</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">mH</span><span class="p">,</span><span class="n">mh</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(300.0, 125.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tanα</span><span class="o">=-</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="n">α</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">tanα</span><span class="p">)</span>
<span class="k">if</span> <span class="n">α</span><span class="o">&gt;=-</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span> <span class="ow">and</span> <span class="n">α</span><span class="o">&lt;=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">2</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">α</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Bad α range&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.4636476090008061
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">β</span><span class="o">-</span><span class="n">α</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">β</span><span class="o">-</span><span class="n">α</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5999999999999999
</pre></div>
</div>
</div>
</div>
<p>Analytical diagonalization from [<a class="reference external" href="https://arxiv.org/pdf/1507.00933.pdf">arXiv:1507.00933</a>]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Δ</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>  <span class="p">(</span><span class="n">ℳ2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">ℳ2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="mi">4</span><span class="o">*</span><span class="n">ℳ2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span> <span class="p">[</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span> <span class="n">ℳ2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">ℳ2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">Δ</span> <span class="p">),</span>
          <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span> <span class="n">ℳ2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">ℳ2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">Δ</span> <span class="p">)</span> <span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([300., 125.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Cosα</span><span class="p">,</span><span class="n">Sinα</span><span class="o">=</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">Δ</span><span class="o">+</span><span class="n">ℳ2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">ℳ2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">Δ</span><span class="p">)),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">ℳ2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">Δ</span><span class="o">*</span><span class="p">(</span><span class="n">Δ</span><span class="o">+</span><span class="n">ℳ2</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">ℳ2</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]))</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;U=&#39;</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">Cosα</span><span class="p">,</span><span class="o">-</span><span class="n">Sinα</span><span class="p">],[</span><span class="n">Sinα</span><span class="p">,</span><span class="n">Cosα</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>U=
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.89442719, -0.4472136 ],
       [ 0.4472136 ,  0.89442719]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;cos(β-α)=</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span> <span class="n">β</span><span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span> <span class="n">Sinα</span><span class="o">/</span><span class="n">Cosα</span><span class="p">)</span> <span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>cos(β-α)=0.8
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="activity">
<h2>Activity<a class="headerlink" href="#activity" title="Permalink to this headline">#</a></h2>
<p>Let
$<span class="math notranslate nohighlight">\(
\boldsymbol{M}=\begin{bmatrix}
1 &amp; 2\\
3 &amp; 4\\
\end{bmatrix}
\)</span>$
Choose the diagonalization method (A/B)</p>
<ul class="simple">
<li><p>A:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>B:</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">linalg</span>
<span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">activities</span> <span class="kn">import</span> <span class="o">*</span>
<span class="n">x</span><span class="o">=</span><span class="nb">input</span><span class="p">(</span><span class="s1">&#39;A or B?</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">activities</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="s2">&quot;7.1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./material"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="ipython-notebooks.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Notebooks</p>
        </div>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Diego Restrepo (UdeA)<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>