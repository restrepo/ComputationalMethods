
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>6. Linear Algebra &#8212; Computational Methods</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="7. Differential Equations" href="differential-equations.html" />
    <link rel="prev" title="5. Numerical Calculus" href="numerical-calculus.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Methods</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    Computational Methods for Physics & Astronomy
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="overview-python.html">
   1. Python Overview
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="computer-arithmetics.html">
   2. Computer Arithmetics and Round-off Methods
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="one-variable-equations.html">
   3. One Variable Equations
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="interpolation.html">
   4. Interpolation Methods
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="numerical-calculus.html">
   5. Numerical Calculus
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   6. Linear Algebra
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="differential-equations.html">
   7. Differential Equations
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="statistics.html">
   8. Statistics
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Intro_clases.html">
   9. Clases
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="scientific-libraries.html">
   Scientific Libraries with Python
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Pandas.html">
   Pandas
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="matplotlib.html">
   Matplotlib
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="ipython-notebooks.html">
   Notebooks
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="linear-algebra-diagonalization.html">
   Matrix diagonalization
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/restrepo/ComputationalMethods/master?urlpath=tree/docs/material/linear-algebra.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/restrepo/ComputationalMethods"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/restrepo/ComputationalMethods/issues/new?title=Issue%20on%20page%20%2Fmaterial/linear-algebra.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/material/linear-algebra.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrices-in-python">
   6.1. Matrices in Python
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numpy-arrays">
     6.1.1. Numpy arrays
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#special-arrays">
       6.1.1.1. Special arrays:
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analytical-matrices">
       6.1.1.2. Analytical matrices
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#matrix-operations-numpy">
       6.1.1.3. Matrix operations (numpy)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#element-by-element-operations">
       6.1.1.4. Element by element operations
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#submatrix-from-matrix">
       6.1.1.5. Submatrix from matrix:
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extract-rows">
       6.1.1.6. Extract rows
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extract-columns">
       6.1.1.7. Extract columns
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reordering">
       6.1.1.8. Reordering
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#it-is-possible-to-reasign-a-full-set-of-rows-to-a-matrix">
       6.1.1.9. It is possible to reasign a full set of rows to a matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#matrix-object">
       6.1.1.10. Matrix object
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-operations-with-matrices">
     6.1.2. Basic operations with matrices
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extract-rows-from-an-array">
       6.1.2.1. Extract rows from an array
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-activity-span">
     6.1.3.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaussian-elimination">
   6.2. Gaussian Elimination
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1">
     6.2.1. Example 1
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       6.2.1.1.
       <span style="color:red">
        Activity
       </span>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-systems-of-equations">
   6.3. Linear Systems of Equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrices-and-vectors">
     6.3.1. Matrices and vectors
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#implementation-in-scipy">
       6.3.1.1. Implementation in Scipy
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-gaussian-elimination">
     6.3.2. General Gaussian elimination
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pivoting-strategies">
     6.3.3. Pivoting Strategies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computing-time">
     6.3.4. Computing time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2">
     6.3.5. Example 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     6.3.6.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#partial-pivoting">
     6.3.7. Partial pivoting
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     6.3.8.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrix-inversion">
   6.4. Matrix Inversion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     6.4.1.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#determinant-of-a-matrix">
   6.5. Determinant of a Matrix
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-determinants">
     6.5.1. Calculating determinants
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computing-time-of-determinants">
     6.5.2. Computing time of determinants
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     6.5.3.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#properties-of-determinants">
     6.5.4. Properties of determinants
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     6.5.5.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#existence-of-inverse">
     6.5.6. Existence of inverse
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numpy-implementation">
       6.5.6.1. Numpy implementation
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrix-diagonalization">
   6.6. Matrix diagonalization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lu-factorization">
   6.7. LU Factorization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     6.7.1.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#derivation-of-lu-factorization">
     6.7.2. Derivation of LU factorization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algorithm-for-lu-factorization">
     6.7.3. Algorithm for LU factorization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     6.7.4.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-eigenvalues-and-eigenvectors-activity-span">
     6.7.5.
     <span style="color:red">
      Eigenvalues and Eigenvectors activity
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#electron-interacting-with-a-magnetic-field">
       6.7.5.1. Electron interacting with a magnetic field
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Linear Algebra</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrices-in-python">
   6.1. Matrices in Python
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numpy-arrays">
     6.1.1. Numpy arrays
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#special-arrays">
       6.1.1.1. Special arrays:
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#analytical-matrices">
       6.1.1.2. Analytical matrices
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#matrix-operations-numpy">
       6.1.1.3. Matrix operations (numpy)
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#element-by-element-operations">
       6.1.1.4. Element by element operations
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#submatrix-from-matrix">
       6.1.1.5. Submatrix from matrix:
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extract-rows">
       6.1.1.6. Extract rows
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extract-columns">
       6.1.1.7. Extract columns
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#reordering">
       6.1.1.8. Reordering
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#it-is-possible-to-reasign-a-full-set-of-rows-to-a-matrix">
       6.1.1.9. It is possible to reasign a full set of rows to a matrix
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#matrix-object">
       6.1.1.10. Matrix object
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-operations-with-matrices">
     6.1.2. Basic operations with matrices
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#extract-rows-from-an-array">
       6.1.2.1. Extract rows from an array
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-activity-span">
     6.1.3.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#gaussian-elimination">
   6.2. Gaussian Elimination
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-1">
     6.2.1. Example 1
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#id1">
       6.2.1.1.
       <span style="color:red">
        Activity
       </span>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#linear-systems-of-equations">
   6.3. Linear Systems of Equations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matrices-and-vectors">
     6.3.1. Matrices and vectors
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#implementation-in-scipy">
       6.3.1.1. Implementation in Scipy
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-gaussian-elimination">
     6.3.2. General Gaussian elimination
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pivoting-strategies">
     6.3.3. Pivoting Strategies
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computing-time">
     6.3.4. Computing time
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#example-2">
     6.3.5. Example 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id2">
     6.3.6.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#partial-pivoting">
     6.3.7. Partial pivoting
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id3">
     6.3.8.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrix-inversion">
   6.4. Matrix Inversion
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id4">
     6.4.1.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#determinant-of-a-matrix">
   6.5. Determinant of a Matrix
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#calculating-determinants">
     6.5.1. Calculating determinants
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computing-time-of-determinants">
     6.5.2. Computing time of determinants
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id5">
     6.5.3.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#properties-of-determinants">
     6.5.4. Properties of determinants
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id6">
     6.5.5.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#existence-of-inverse">
     6.5.6. Existence of inverse
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numpy-implementation">
       6.5.6.1. Numpy implementation
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#matrix-diagonalization">
   6.6. Matrix diagonalization
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#lu-factorization">
   6.7. LU Factorization
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id7">
     6.7.1.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#derivation-of-lu-factorization">
     6.7.2. Derivation of LU factorization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#algorithm-for-lu-factorization">
     6.7.3. Algorithm for LU factorization
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id8">
     6.7.4.
     <span style="color:red">
      Activity
     </span>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#span-style-color-red-eigenvalues-and-eigenvectors-activity-span">
     6.7.5.
     <span style="color:red">
      Eigenvalues and Eigenvectors activity
     </span>
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#electron-interacting-with-a-magnetic-field">
       6.7.5.1. Electron interacting with a magnetic field
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <p><a href="https://colab.research.google.com/github/restrepo/ComputationalMethods/blob/master/material/linear-algebra.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="linear-algebra">
<h1><a class="toc-backref" href="#id9"><span class="section-number">6. </span>Linear Algebra</a><a class="headerlink" href="#linear-algebra" title="Permalink to this headline">#</a></h1>
<p>Linear Algebra is a discipline where vector spaces and linear mapping between them are studied. In physics and astronomy, several phenomena can be readily written in terms of linear variables, what makes Computational Linear Algebra a very important topic to be covered throughout this course. We shall cover linear systems of equations, techniques for calculating inverses and determinants and factorization methods.</p>
<p>An interesting fact of Computational Linear Algebra is that it does not comprises numerical approaches as most of the methods are exact. The usage of a computer is then necessary because of the large number of calculations rather than the non-soluble nature of the problems. Numerical errors come then from round-off approximations.</p>
<p>See: http://pages.cs.wisc.edu/~amos/412/lecture-notes/lecture14.pdf</p>
<hr class="docutils" />
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#linear-algebra" id="id9">Linear Algebra</a></p>
<ul>
<li><p><a class="reference internal" href="#matrices-in-python" id="id10">Matrices in Python</a></p></li>
<li><p><a class="reference internal" href="#gaussian-elimination" id="id11">Gaussian Elimination</a></p></li>
<li><p><a class="reference internal" href="#linear-systems-of-equations" id="id12">Linear Systems of Equations</a></p></li>
<li><p><a class="reference internal" href="#matrix-inversion" id="id13">Matrix Inversion</a></p></li>
<li><p><a class="reference internal" href="#determinant-of-a-matrix" id="id14">Determinant of a Matrix</a></p></li>
<li><p><a class="reference internal" href="#matrix-diagonalization" id="id15">Matrix diagonalization</a></p></li>
<li><p><a class="reference internal" href="#lu-factorization" id="id16">LU Factorization</a></p></li>
</ul>
</li>
</ul>
</div>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">HTML</span><span class="p">,</span> <span class="n">Markdown</span><span class="p">,</span> <span class="n">YouTubeVideo</span><span class="p">,</span><span class="n">Latex</span>
<span class="o">%</span><span class="k">pylab</span> inline

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1">## JSAnimation import available at https://github.com/jakevdp/JSAnimation</span>
<span class="c1">#from JSAnimation import IPython_display</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">animation</span>
<span class="c1">#Interpolation add-on</span>
<span class="kn">import</span> <span class="nn">scipy.interpolate</span> <span class="k">as</span> <span class="nn">interp</span>
<span class="n">xrange</span><span class="o">=</span><span class="nb">range</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>%pylab is deprecated, use %matplotlib inline and import the required libraries.
Populating the interactive namespace from numpy and matplotlib
</pre></div>
</div>
</div>
</div>
<p>https://stackoverflow.com/a/50748163</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">try</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">google.colab.output._publish</span> <span class="kn">import</span> <span class="n">javascript</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Math</span> <span class="k">as</span> <span class="n">math</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Latex</span> <span class="k">as</span> <span class="n">latex</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=default&quot;</span>
    <span class="k">def</span> <span class="nf">Math</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">javascript</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">math</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">Latex</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="c1">#print(args[0].replace(&#39;$&#39;,&#39;&#39;))</span>
        <span class="n">javascript</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">math</span><span class="p">(</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="k">except</span><span class="p">:</span>
    <span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Math</span><span class="p">,</span> <span class="n">Latex</span>
</pre></div>
</div>
</div>
</div>
<hr class="docutils" />
<section id="matrices-in-python">
<h2><a class="toc-backref" href="#id10"><span class="section-number">6.1. </span>Matrices in Python</a><a class="headerlink" href="#matrices-in-python" title="Permalink to this headline">#</a></h2>
<p>One of the most useful advantages of high level languages like Python, is the manipulation of complex objects like matrices and vectors. For this part we are going to use advanced capabilities for handling matrices, provided by the library NumPy.</p>
<p>NumPy, besides the extreme useful NumPy array objects, which are like tensors of any rank, also provides the Matrix objects that are overloaded with proper matrix operations.</p>
<section id="numpy-arrays">
<h3><span class="section-number">6.1.1. </span>Numpy arrays<a class="headerlink" href="#numpy-arrays" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>A matrix can be represented by an array of two indices</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#NumPy Arrays</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span> <span class="mi">5</span> <span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">4</span> <span class="p">,</span> <span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">0</span> <span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span> <span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="n">a</span><span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span> <span class="p">)</span>
<span class="nb">print</span><span class="p">(</span> <span class="sa">f</span><span class="s1">&#39;M1=</span><span class="se">\n</span><span class="si">{</span><span class="n">M1</span><span class="si">}</span><span class="s1">, with shape=</span><span class="si">{</span><span class="n">M1</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s1">,</span><span class="se">\n\n</span><span class="s1">M2=</span><span class="se">\n</span><span class="si">{</span><span class="n">M2</span><span class="si">}</span><span class="s1">&#39;</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>M1=
[[ 5 -4  0]
 [-4  7 -3]
 [ 0 -3  5]], with shape=(3, 3),

M2=
[[ 3 -2  1]
 [-1  5  4]
 [ 1 -2  3]]
</pre></div>
</div>
</div>
</div>
<p>Note tha the previous definitions correspond to integer arrays.</p>
<p><strong>WARNING</strong>: Be careful with integer arrays. In the next example, a single float entry convert the full matrix from an integer array to a float array:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5
</pre></div>
</div>
</div>
</div>
<p>float</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">4</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span>
          <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span> <span class="o">-</span><span class="mf">3.</span><span class="p">],</span>
          <span class="p">[</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">,</span>  <span class="mi">5</span><span class="p">]])</span><span class="c1">#[0,0]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5., -4.,  0.],
       [-4.,  7., -3.],
       [ 0., -3.,  5.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="o">/</span><span class="mi">3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1.66666667, -1.33333333,  0.        ],
       [-1.33333333,  2.33333333, -1.        ],
       [ 0.        , -1.        ,  1.66666667]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">M1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1, -1,  0],
       [-1,  2, -1],
       [ 0, -1,  1]])
</pre></div>
</div>
</div>
</div>
<section id="special-arrays">
<h4><span class="section-number">6.1.1.1. </span>Special arrays:<a class="headerlink" href="#special-arrays" title="Permalink to this headline">#</a></h4>
<p>Let <span class="math notranslate nohighlight">\(n\)</span> the range of the matrix</p>
<ul class="simple">
<li><p>zero matrix</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="o">=</span><span class="mi">3</span>
<span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0., 0., 0.],
       [0., 0., 0.],
       [0., 0., 0.]])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Ones matrix</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 1., 1.],
       [1., 1., 1.],
       [1., 1., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">)</span> <span class="p">)</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.+1.j, 0.+1.j, 0.+1.j],
       [0.+1.j, 0.+1.j, 0.+1.j],
       [0.+1.j, 0.+1.j, 0.+1.j]])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Identity matrix</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">identity</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0., 0.],
       [0., 1., 0.],
       [0., 0., 1.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 0, 0],
       [0, 2, 0],
       [0, 0, 4]])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Random matrix with entries between 0 and 1</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.9460452544468382
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#np.random.seed(986554575)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.05016015, 0.81396332, 0.17984221],
       [0.46070592, 0.46019579, 0.9506249 ],
       [0.28245888, 0.83429461, 0.47399034]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[5.16683546, 5.73486742, 4.15495224],
       [0.75064986, 0.18470119, 3.9795813 ],
       [0.59178719, 6.74641986, 7.40144976]])
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Integer Random matrix</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span> <span class="c1">#0 to 9</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[9, 1, 9],
       [1, 8, 4],
       [0, 4, 2]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  4,  -3,  -5],
       [  7,   2,  -9],
       [-10,   5,  -8]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="analytical-matrices">
<h4><span class="section-number">6.1.1.2. </span>Analytical matrices<a class="headerlink" href="#analytical-matrices" title="Permalink to this headline">#</a></h4>
<p>Some times it is necessary to work with analytical Matrices. In such a case we can use the symbolic module <code class="docutils literal notranslate"><span class="pre">Sympy</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sympy</span>
<span class="n">x</span> <span class="o">=</span><span class="n">sympy</span><span class="o">.</span><span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="c1">## declare analytical varibles</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">init_printing</span><span class="p">()</span> <span class="c1">## Use LaTeX to print sympy obejects</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#NumPy Arrays</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span> <span class="mi">5</span> <span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">4</span> <span class="p">,</span> <span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">0</span> <span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span> <span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}3 &amp; -2 &amp; 1\\-1 &amp; 5 &amp; 4\\1 &amp; -2 &amp; 3\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>In the following we will focus only in numerical matrices as <code class="docutils literal notranslate"><span class="pre">numpy</span></code> arrays, but also use <code class="docutils literal notranslate"><span class="pre">sympy</span></code> to print the matrices in a more readable way</p>
</section>
<section id="matrix-operations-numpy">
<h4><span class="section-number">6.1.1.3. </span>Matrix operations (numpy)<a class="headerlink" href="#matrix-operations-numpy" title="Permalink to this headline">#</a></h4>
<p>Both as functions or array’s methods</p>
<ul class="simple">
<li><p>Transpose</p></li>
</ul>
<p><span class="math notranslate nohighlight">\(M_2^{\rm T}=\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">IPython</span> <span class="kn">import</span> <span class="n">display</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Latex(r&#39;M_2^{\rm T}=&#39;)</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span> <span class="n">M2</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}3 &amp; -1 &amp; 1\\-2 &amp; 5 &amp; -2\\1 &amp; 4 &amp; 3\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<ul class="simple">
<li><p>Matrix addition</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}5 &amp; -4 &amp; 0\\-4 &amp; 7 &amp; -3\\0 &amp; -3 &amp; 5\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}3 &amp; -2 &amp; 1\\-1 &amp; 5 &amp; 4\\1 &amp; -2 &amp; 3\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span> <span class="n">M1</span><span class="o">+</span><span class="n">M2</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}8 &amp; -6 &amp; 1\\-5 &amp; 12 &amp; 1\\1 &amp; -5 &amp; 8\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Complex arrays are allowed</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Mc</span><span class="o">=</span><span class="n">M1</span><span class="o">+</span><span class="n">M2</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span> <span class="n">M1</span><span class="o">+</span><span class="n">M2</span><span class="o">*</span><span class="mi">1</span><span class="n">j</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}5.0 + 3.0 i &amp; -4.0 - 2.0 i &amp; 1.0 i\\-4.0 - 1.0 i &amp; 7.0 + 5.0 i &amp; -3.0 + 4.0 i\\1.0 i &amp; -3.0 - 2.0 i &amp; 5.0 + 3.0 i\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>with the corresponding complex matrix operations</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">display</span> <span class="p">(</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span>  <span class="n">Mc</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span>
<span class="n">display</span> <span class="p">(</span> <span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span>  <span class="n">Mc</span><span class="o">.</span><span class="n">conjugate</span><span class="p">()</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span> <span class="p">)</span> <span class="p">)</span> <span class="c1">## hermitian-conjugate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}5.0 - 3.0 i &amp; -4.0 + 2.0 i &amp; - 1.0 i\\-4.0 + 1.0 i &amp; 7.0 - 5.0 i &amp; -3.0 - 4.0 i\\- 1.0 i &amp; -3.0 + 2.0 i &amp; 5.0 - 3.0 i\end{matrix}\right]\end{split}\]</div>
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}5.0 - 3.0 i &amp; -4.0 + 1.0 i &amp; - 1.0 i\\-4.0 + 2.0 i &amp; 7.0 - 5.0 i &amp; -3.0 + 2.0 i\\- 1.0 i &amp; -3.0 - 4.0 i &amp; 5.0 - 3.0 i\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<ul class="simple">
<li><p>Matrix multiplication
<img alt="MP" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Matrix_multiplication_diagram_2.svg/200px-Matrix_multiplication_diagram_2.svg.png" /></p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>Dot product of two arrays. Specifically,</p>
<ul class="simple">
<li><p>If both <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are 1-D arrays, it is inner product of vectors
(without complex conjugation).</p></li>
<li><p>If both <code class="docutils literal notranslate"><span class="pre">a</span></code> and <code class="docutils literal notranslate"><span class="pre">b</span></code> are 2-D arrays, it is matrix multiplication,
but using :func:<code class="docutils literal notranslate"><span class="pre">matmul</span></code> or <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">&#64;</span> <span class="pre">b</span></code> is preferred.</p></li>
<li><p>If either <code class="docutils literal notranslate"><span class="pre">a</span></code> or <code class="docutils literal notranslate"><span class="pre">b</span></code> is 0-D (scalar), it is equivalent to :func:<code class="docutils literal notranslate"><span class="pre">multiply</span></code>
and using <code class="docutils literal notranslate"><span class="pre">numpy.multiply(a,</span> <span class="pre">b)</span></code> or <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">*</span> <span class="pre">b</span></code> is preferred.</p></li>
<li><p>…</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span> <span class="mi">5</span> <span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">4</span> <span class="p">,</span> <span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">0</span> <span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span> <span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">],</span>
                <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Multiplication</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">M1</span><span class="p">,</span> <span class="n">M2</span> <span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}19 &amp; -30 &amp; -11\\-22 &amp; 49 &amp; 15\\8 &amp; -25 &amp; 3\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span> <span class="n">M1</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}19 &amp; -30 &amp; -11\\-22 &amp; 49 &amp; 15\\8 &amp; -25 &amp; 3\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Recommended way</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">M1</span><span class="nd">@M2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}19 &amp; -30 &amp; -11\\-22 &amp; 49 &amp; 15\\8 &amp; -25 &amp; 3\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span><span class="nd">@np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([5])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Multiplication is not commutative</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span> <span class="p">(</span> <span class="n">M2</span><span class="nd">@M1</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}23 &amp; -29 &amp; 11\\-25 &amp; 27 &amp; 5\\13 &amp; -27 &amp; 21\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<ul class="simple">
<li><p>Complex matrices</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">σ_2</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
    <span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">],</span>
     <span class="p">[</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">σ_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}0 &amp; - 1.0 i\\1.0 i &amp; 0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<ul class="simple">
<li><p>Trace</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">σ_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0j
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p>Determinant</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">σ_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(-1+0j)
</pre></div>
</div>
</div>
</div>
<p>Raise a square matrix to the (integer) power <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">σ_2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}1.0 &amp; 0\\0 &amp; 1.0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">σ_2</span><span class="nd">@σ_2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_12325/501469815.py:1: ComplexWarning: Casting complex values to real discards the imaginary part
  (σ_2@σ_2).astype(float)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1., 0.],
       [0., 1.]])
</pre></div>
</div>
</div>
</div>
<p>odd power</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">σ_2</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}0 &amp; - 1.0 i\\1.0 i &amp; 0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>even power</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span> <span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">matrix_power</span><span class="p">(</span><span class="n">σ_2</span><span class="p">,</span><span class="mi">14</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}1.0 &amp; 0\\0 &amp; 1.0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>Inverse of a matrix</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}0.442307692307692 &amp; 0.0769230769230769 &amp; -0.25\\0.134615384615385 &amp; 0.153846153846154 &amp; -0.25\\-0.0576923076923077 &amp; 0.0769230769230769 &amp; 0.25\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span> <span class="p">(</span> <span class="p">(</span> <span class="n">M2</span><span class="nd">@np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span> <span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}1.0 &amp; 0 &amp; 0\\0 &amp; 1.0 &amp; 0\\0 &amp; 0 &amp; 1.0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span> <span class="n">M2</span><span class="nd">@np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span> <span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[1, 0, 0],
       [0, 1, 0],
       [0, 0, 1]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span> <span class="p">(</span> <span class="p">(</span> <span class="n">M2</span><span class="nd">@np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span> <span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linear-algebra_78_0.png" src="../_images/linear-algebra_78_0.png" />
</div>
</div>
</section>
<section id="element-by-element-operations">
<h4><span class="section-number">6.1.1.4. </span>Element by element operations<a class="headerlink" href="#element-by-element-operations" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
<span class="n">M2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 5 -4  0]
 [-4  7 -3]
 [ 0 -3  5]]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 3, -2,  1],
       [-1,  5,  4],
       [ 1, -2,  3]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="o">*</span><span class="n">M2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 15,   8,   0],
       [  4,  35, -12],
       [  0,   6,  15]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Division</span>
<span class="nb">print</span><span class="p">(</span> <span class="n">M1</span><span class="o">/</span><span class="n">M2</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 1.66666667  2.          0.        ]
 [ 4.          1.4        -0.75      ]
 [ 0.          1.5         1.66666667]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span> <span class="n">M1</span><span class="nd">@np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">M2</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}1.67 &amp; -0.231 &amp; -0.25\\-0.649 &amp; 0.539 &amp; -1.5\\-0.695 &amp; -0.077 &amp; 2.0\end{matrix}\right]\end{split}\]</div>
</div>
</div>
</section>
<section id="submatrix-from-matrix">
<h4><span class="section-number">6.1.1.5. </span>Submatrix from matrix:<a class="headerlink" href="#submatrix-from-matrix" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span> <span class="mi">5</span> <span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">4</span> <span class="p">,</span> <span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">0</span> <span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Elements of the matrix</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>-3
</pre></div>
</div>
</div>
</div>
</section>
<section id="extract-rows">
<h4><span class="section-number">6.1.1.6. </span>Extract rows<a class="headerlink" href="#extract-rows" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="p">[</span><span class="mi">1</span><span class="p">,:]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-4,  7, -3])
</pre></div>
</div>
</div>
</div>
<p>or</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-4,  7, -3])
</pre></div>
</div>
</div>
</div>
<p>In general:
<code class="docutils literal notranslate"><span class="pre">M1[list</span> <span class="pre">of</span> <span class="pre">rows</span> <span class="pre">to</span> <span class="pre">extract]</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="p">[[</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-4,  7, -3]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span> <span class="mi">5</span> <span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">4</span> <span class="p">,</span> <span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">0</span> <span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5, -4,  0],
       [ 0, -3,  5]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="extract-columns">
<h4><span class="section-number">6.1.1.7. </span>Extract columns<a class="headerlink" href="#extract-columns" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-4,  7, -3])
</pre></div>
</div>
</div>
</div>
<p>and convert back into a column</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">M1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-4],
       [ 7],
       [-3]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="reordering">
<h4><span class="section-number">6.1.1.8. </span>Reordering<a class="headerlink" href="#reordering" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span> <span class="mi">5</span> <span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">4</span> <span class="p">,</span> <span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">0</span> <span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Reverse row order to 2,1,0</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0, -3,  5],
       [-4,  7, -3],
       [ 5, -4,  0]])
</pre></div>
</div>
</div>
</div>
<p>or</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">r_</span><span class="p">[[</span><span class="n">M1</span><span class="p">[</span><span class="mi">2</span><span class="p">]],[</span><span class="n">M1</span><span class="p">[</span><span class="mi">1</span><span class="p">]],[</span><span class="n">M1</span><span class="p">[</span><span class="mi">0</span><span class="p">]]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0, -3,  5],
       [-4,  7, -3],
       [ 5, -4,  0]])
</pre></div>
</div>
</div>
</div>
<p>Reverse column order to 2,1,0</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="n">M1</span><span class="p">[:,</span><span class="mi">2</span><span class="p">],</span><span class="n">M1</span><span class="p">[:,</span><span class="mi">1</span><span class="p">],</span><span class="n">M1</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>  <span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0, -4,  5],
       [-3,  7, -4],
       [ 5, -3,  0]])
</pre></div>
</div>
</div>
</div>
</section>
<section id="it-is-possible-to-reasign-a-full-set-of-rows-to-a-matrix">
<h4><span class="section-number">6.1.1.9. </span>It is possible to reasign a full set of rows to a matrix<a class="headerlink" href="#it-is-possible-to-reasign-a-full-set-of-rows-to-a-matrix" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span> <span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
                <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],</span>
                <span class="p">[</span> <span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span>  <span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>  <span class="p">]]</span>
<span class="n">M1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0,  0,  0],
       [-4,  7, -3],
       [ 0,  0,  0]])
</pre></div>
</div>
</div>
</div>
<p>Note that because <code class="docutils literal notranslate"><span class="pre">M1</span></code> has only integer numbers, it is assumed to be an <em>integer matrix</em>. In order to allow float assignments, it is first necessary to convert to a <em>float matrix</em>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="o">=</span><span class="n">M1</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">M1</span><span class="p">[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]]</span><span class="o">=</span><span class="p">[[</span><span class="mi">0</span>  <span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span>
           <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span>  <span class="p">]]</span>
<span class="n">M1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0. ,  0. ,  0.3],
       [-4. ,  7. , -3. ],
       [ 0.3,  0. ,  0. ]])
</pre></div>
</div>
</div>
</div>
<p><strong>WARNING</strong><br/>
In some cases a  reasignment of a list or array points to the same space in memory. To really copy an array to other variable it is always recommended to use the <code class="docutils literal notranslate"><span class="pre">.copy()</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 2])
</pre></div>
</div>
</div>
</div>
<p>Reassign memory space</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="o">=</span><span class="n">A</span>
<span class="n">C</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 2])
</pre></div>
</div>
</div>
</div>
<p>A change is reflected in both variables</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">C</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">5</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A=</span><span class="si">{</span><span class="n">A</span><span class="si">}</span><span class="s1"> → C=</span><span class="si">{</span><span class="n">C</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A=[5 2] → C=[5 2]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">8</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;A=</span><span class="si">{</span><span class="n">A</span><span class="si">}</span><span class="s1"> → C=</span><span class="si">{</span><span class="n">C</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A=[5 8] → C=[5 8]
</pre></div>
</div>
</div>
</div>
<p>To keep the first memory space</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="c1">## two different memory spaces</span>
<span class="n">B</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">4</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A =&#39;</span><span class="p">,</span><span class="n">A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;B =&#39;</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>A = [5 2]
B = [4 2]
</pre></div>
</div>
</div>
</div>
</section>
<section id="matrix-object">
<h4><span class="section-number">6.1.1.10. </span>Matrix object<a class="headerlink" href="#matrix-object" title="Permalink to this headline">#</a></h4>
<p>numpy also has a Matrix object with simplified operations. However it is recommended to use the general array object even for specific matrix operations. This helps to avoid incompatibilities with usual array operations. For example, as shown below the multiplication symbol, <code class="docutils literal notranslate"><span class="pre">*</span></code>, behaves different for arrays that for matrices, and could induce to errors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#NumPy Matrix</span>
<span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span> <span class="p">)</span>
<span class="n">M2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="p">[[</span><span class="mi">3</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">4</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span> <span class="p">)</span>

<span class="nb">print</span> <span class="p">(</span><span class="n">M1</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span> <span class="p">(</span><span class="n">M2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[[ 5 -4  0]
 [-4  7 -3]
 [ 0 -3  5]] 

[[ 3 -2  1]
 [-1  5  4]
 [ 1 -2  3]]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Addition</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span> <span class="n">M1</span><span class="o">+</span><span class="n">M2</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linear-algebra_125_0.png" src="../_images/linear-algebra_125_0.png" />
</div>
</div>
<p><img alt="MP" src="https://upload.wikimedia.org/wikipedia/commons/thumb/e/eb/Matrix_multiplication_diagram_2.svg/200px-Matrix_multiplication_diagram_2.svg.png" /></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Multiplication</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span> <span class="n">M1</span><span class="o">*</span><span class="n">M2</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linear-algebra_127_0.png" src="../_images/linear-algebra_127_0.png" />
</div>
</div>
</section>
</section>
<section id="basic-operations-with-matrices">
<h3><span class="section-number">6.1.2. </span>Basic operations with matrices<a class="headerlink" href="#basic-operations-with-matrices" title="Permalink to this headline">#</a></h3>
<p>In order to simplify the following methods, we introduce here 3 basic operations over linear systems:</p>
<ol class="simple">
<li><p>The <span class="math notranslate nohighlight">\(i\)</span>-th row <span class="math notranslate nohighlight">\(E_i\)</span> can be multiplied by a non-zero constant <span class="math notranslate nohighlight">\(\lambda\)</span>, and then a new row used in place of <span class="math notranslate nohighlight">\(E_i\)</span>, i.e. <span class="math notranslate nohighlight">\((E_i)\rightarrow (\lambda E_i)\)</span>. We denote this operation as <span class="math notranslate nohighlight">\(\operatorname{Lamb}(E_i,\lambda)\)</span>.</p></li>
<li><p>The <span class="math notranslate nohighlight">\(j\)</span>-th row <span class="math notranslate nohighlight">\(E_j\)</span> can be multiplied by a non-zero constant <span class="math notranslate nohighlight">\(\lambda\)</span> and added to some row <span class="math notranslate nohighlight">\(E_i\)</span>. The resulting value take the place of <span class="math notranslate nohighlight">\(E_i\)</span>, i.e. <span class="math notranslate nohighlight">\((E_i) \rightarrow (E_i + \lambda E_j)\)</span>. We denote this operation as <span class="math notranslate nohighlight">\(\operatorname{Comb}(E_i,E_j,\lambda)\)</span>.</p></li>
<li><p>Finally, we define a swapping of two rows as <span class="math notranslate nohighlight">\((E_i)\leftrightarrow (E_j)\)</span>, denoted as <span class="math notranslate nohighlight">\(\operatorname{Swap}(E_i,E_j)\)</span></p></li>
</ol>
<section id="extract-rows-from-an-array">
<h4><span class="section-number">6.1.2.1. </span>Extract rows from an array<a class="headerlink" href="#extract-rows-from-an-array" title="Permalink to this headline">#</a></h4>
</section>
</section>
<section id="span-style-color-red-activity-span">
<h3><span class="section-number">6.1.3. </span><span style='color:red'> Activity </span><a class="headerlink" href="#span-style-color-red-activity-span" title="Permalink to this headline">#</a></h3>
<p>Write three routines that perform, given a matrix <span class="math notranslate nohighlight">\(A\)</span>, the previous operations over matrices:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">row_lamb(i,</span> <span class="pre">λ,</span> <span class="pre">A)</span></code>: <code class="docutils literal notranslate"><span class="pre">i</span></code> is the row to be changed, <code class="docutils literal notranslate"><span class="pre">λ</span></code> the multiplicative factor and <code class="docutils literal notranslate"><span class="pre">A</span></code> the matrix. This function should return the new matrix with the performed operation <span class="math notranslate nohighlight">\((E_i)\rightarrow (\lambda E_i)\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">row_comb(i,</span> <span class="pre">j,</span> <span class="pre">λ,</span> <span class="pre">A)</span></code>: <code class="docutils literal notranslate"><span class="pre">i</span></code> is the row to be changed, <code class="docutils literal notranslate"><span class="pre">j</span></code> the row to be added, <code class="docutils literal notranslate"><span class="pre">λ</span></code> the multiplicative factor and <code class="docutils literal notranslate"><span class="pre">A</span></code> the matrix. This function should return the new matrix with the performed operation <span class="math notranslate nohighlight">\((E_i) \rightarrow  (E_i + \lambda E_j)\)</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">row_swap(i,</span> <span class="pre">j,</span> <span class="pre">A)</span></code>: <code class="docutils literal notranslate"><span class="pre">i</span></code> and <code class="docutils literal notranslate"><span class="pre">j</span></code> are the rows to be swapped. This function should return the new matrix with the performed operation <span class="math notranslate nohighlight">\((E_i)\leftrightarrow (E_j)\)</span>.</p></li>
</ul>
<!--
import numbers
#Combination function
#Force the matrix to has type float
def row_lamb( i, λ, A ):
    B = A.copy()
    if isinstance(B[0,0],numbers.Integral):
        B=B.astype(float)
    B[i] = λ*B[i]
    return B

def row_comb( i, j, λ, A ):
    B = A.copy()
    if isinstance(B[0,0],numbers.Integral):
        B=B.astype(float)
    B[i] = λ*B[j] + B[i]
    return B

def row_swap( i, j, A ):
    B = A.copy()
    B[[i,j]] = B[[j,i]]
    return B
--><div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numbers</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">isinstance</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">])[</span><span class="mi">0</span><span class="p">],</span><span class="n">numbers</span><span class="o">.</span><span class="n">Integral</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="o">=</span><span class="n">M1</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
<span class="n">M1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 2., -4.,  0.],
       [-4.,  7., -3.],
       [ 0., -3.,  5.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">row_sawp</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">A</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    i and j are the rows to be swapped</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">B</span><span class="p">[[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]]</span><span class="o">=</span><span class="n">B</span><span class="p">[[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">B</span>
    
<span class="k">def</span> <span class="nf">row_comb</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">λ</span><span class="p">,</span><span class="n">A</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    `i` is the row to be changed, </span>
<span class="sd">    `j` the row to be added</span>
<span class="sd">    `λ` the multiplicative factor </span>
<span class="sd">    `A` the matrix.</span>
<span class="sd">    operation</span>
<span class="sd">    ---------</span>
<span class="sd">    E_i→ E_i+λ*E_j </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>    
    <span class="k">if</span> <span class="n">B</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">):</span>
        <span class="n">B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">λ</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">B</span>
    
<span class="k">def</span> <span class="nf">row_lamb</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">λ</span><span class="p">,</span><span class="n">A</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    `i` is the row to be changed, </span>
<span class="sd">    `λ` the multiplicative factor </span>
<span class="sd">    `A` the matrix.</span>
<span class="sd">    operation</span>
<span class="sd">    ---------</span>
<span class="sd">    λ → λ*E_i </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">B</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>    
    <span class="k">if</span> <span class="n">B</span><span class="o">.</span><span class="n">dtype</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="s1">&#39;int64&#39;</span><span class="p">):</span>
        <span class="n">B</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">float</span><span class="p">)</span>
    <span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">λ</span><span class="o">*</span><span class="n">B</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">B</span>
</pre></div>
</div>
</div>
</div>
<p>Check with</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">sympy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span> <span class="p">)</span>
<span class="n">M1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5, -4,  0],
       [-4,  7, -3],
       [ 0, -3,  5]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row_lamb</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mf">3.4</span><span class="p">,</span><span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[  5. ,  -4. ,   0. ],
       [-13.6,  23.8, -10.2],
       [  0. ,  -3. ,   5. ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row_comb</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="o">/</span><span class="mi">4</span><span class="p">,</span><span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.  ,  4.75, -3.75],
       [-4.  ,  7.  , -3.  ],
       [ 0.  , -3.  ,  5.  ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row_sawp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[-4,  7, -3],
       [ 5, -4,  0],
       [ 0, -3,  5]])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="gaussian-elimination">
<h2><a class="toc-backref" href="#id11"><span class="section-number">6.2. </span>Gaussian Elimination</a><a class="headerlink" href="#gaussian-elimination" title="Permalink to this headline">#</a></h2>
<section id="example-1">
<h3><span class="section-number">6.2.1. </span>Example 1<a class="headerlink" href="#example-1" title="Permalink to this headline">#</a></h3>
<p>Using Kirchhoff’s circuit laws, it is possible to solve the next system:</p>
<p><img alt="" src="https://raw.githubusercontent.com/sbustamante/ComputationalMethods/master/material/figures/circuit.png" /></p>
<p>obtaining the next equations:</p>
<div class="amsmath math notranslate nohighlight" id="equation-d540481d-40d6-4910-b685-26ef3a2efb60">
<span class="eqno">(6.1)<a class="headerlink" href="#equation-d540481d-40d6-4910-b685-26ef3a2efb60" title="Permalink to this equation">#</a></span>\[\begin{align}
A:&amp;&amp;I_A( R+4R ) - I_B( 4R ) =&amp; E \\
C:&amp;&amp;-I_A( 4R ) + I_B( 4R + 3R ) - I_C(3R) =&amp; 0 \\
B:&amp;&amp;-I_B( 3R ) + I_C(3R+2R) =&amp; -2E\,
\end{align}\]</div>
<p>or</p>
<div class="amsmath math notranslate nohighlight" id="equation-b0c39bdb-fe17-46ba-af68-b0bd50c23563">
<span class="eqno">(6.2)<a class="headerlink" href="#equation-b0c39bdb-fe17-46ba-af68-b0bd50c23563" title="Permalink to this equation">#</a></span>\[\begin{align}
5\frac{I_A R }{E} - 4\frac{I_B R }{E} =&amp; 1 \\
-4 \frac{I_A R }{E} + 7\frac{I_B R }{E} - 3 \frac{I_C R }{E} =&amp; 0 \\
-3 \frac{I_B R }{E} + 5 \frac{I_C R }{E} =&amp; -2\,.
\end{align}\]</div>
<p>Defining the variables <span class="math notranslate nohighlight">\(x_1 = R I_A/E\)</span>, <span class="math notranslate nohighlight">\(x_2 = R I_B/E\)</span> and <span class="math notranslate nohighlight">\(x_3 = R I_C/E\)</span> we have</p>
<div class="amsmath math notranslate nohighlight" id="equation-4ac3c0fe-46db-4fa9-9d3d-22a1300f7277">
<span class="eqno">(6.3)<a class="headerlink" href="#equation-4ac3c0fe-46db-4fa9-9d3d-22a1300f7277" title="Permalink to this equation">#</a></span>\[\begin{align}
5x_1 - 4x_2 =&amp; 1 \\
-4 x_1 + 7x_2 - 3 x_3 =&amp; 0 \\
-3x_2 + 5 x_3 =&amp; -2\,.
\end{align}\]</div>
<p>A first method to solve linear systems of equations is the Gaussian elimination. This procedure consists of a set of recursive steps performed in order to diagonalise the matrix of the problem. A suitable way to introduce this method is applying it to some basic problem. To do so, let’s take the result of the <a class="reference external" href="#Example-1">Example 1</a>:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \matrix{
5 &amp; -4 &amp; 0 \\
-4 &amp; 7 &amp; -3 \\ 
0 &amp; -3 &amp; 5
}\right] 
\left[ \matrix{
x_{1} \\
x_{2} \\
x_{3} 
}\right]  =
\left[ \matrix{
1 \\
0 \\
-2
}\right]\end{split}\]</div>
<p>Constructing the associated augmented matrix, we obtain</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \matrix{
5 &amp; -4 &amp; 0 &amp; \vdots &amp; 1 \\
-4 &amp; 7 &amp; -3 &amp; \vdots &amp; 0 \\
0 &amp; -3 &amp; 5 &amp; \vdots &amp; -2
}\right] \end{split}\]</div>
<section id="id1">
<h4><span class="section-number">6.2.1.1. </span><span style="color:red"> Activity </span><a class="headerlink" href="#id1" title="Permalink to this headline">#</a></h4>
<p>Use numpy functions to build the augmented matrix M1</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="mi">5</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">]]</span> <span class="p">)</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}5 &amp; -4 &amp; 0\\-4 &amp; 7 &amp; -3\\0 &amp; -3 &amp; 5\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 1],
       [ 0],
       [-2]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1_aug</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="n">M1</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]</span> <span class="p">]</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">M1_aug</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}5 &amp; -4 &amp; 0 &amp; 1\\-4 &amp; 7 &amp; -3 &amp; 0\\0 &amp; -3 &amp; 5 &amp; -2\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>or</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1_aug</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span> <span class="p">(</span><span class="n">M1</span><span class="p">,[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">]]))</span>
<span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span><span class="n">M1_aug</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}5 &amp; -4 &amp; 0 &amp; 1\\-4 &amp; 7 &amp; -3 &amp; 0\\0 &amp; -3 &amp; 5 &amp; -2\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<p>At this point, we can eliminate the coefficients of the variable <span class="math notranslate nohighlight">\(x_1\)</span> in the second and third equations. For this, we apply the operations <span class="math notranslate nohighlight">\(\operatorname{Comb}(E_2,E_1,4/5)\)</span>.</p>
<p><span class="math notranslate nohighlight">\(E_2\)</span> → <code class="docutils literal notranslate"><span class="pre">[-4,7,-3⋮0]+[4,-16/5,0⋮4/5]=[0,19/5,-3⋮4/5]</span></code></p>
<p>The coefficient in the third equation is already null. We then obtain:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \matrix{
5 &amp; -4 &amp; 0 &amp; \vdots &amp; 1 \\
0 &amp; 19/5 &amp; -3 &amp; \vdots &amp; 4/5 \\
0 &amp; -3 &amp; 5 &amp; \vdots &amp; -2
}\right] \end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1_LU</span><span class="o">=</span><span class="n">row_comb</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="o">/</span><span class="mi">5</span><span class="p">,</span><span class="n">M1_aug</span><span class="p">)</span>
<span class="n">M1_LU</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5. , -4. ,  0. ,  1. ],
       [ 0. ,  3.8, -3. ,  0.8],
       [ 0. , -3. ,  5. , -2. ]])
</pre></div>
</div>
</div>
</div>
<p>Now, we proceed to eliminate the coefficient of <span class="math notranslate nohighlight">\(x_2\)</span> in the third equation. For this, we apply again <span class="math notranslate nohighlight">\(\operatorname{Comb}(E_3,E_2,3\cdot 5/19)\)</span></p>
<p><span class="math notranslate nohighlight">\(E_3\)</span> → <code class="docutils literal notranslate"><span class="pre">[0,-3,5⋮-2]+[0,(3*5/19)*(19/5),-(3*5/19)*3⋮(3*5/19)*4/5]→[0,0,50/19⋮-26/19]</span></code></p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \matrix{
5 &amp; -4 &amp; 0 &amp; \vdots &amp; 1 \\
0 &amp; 16/5 &amp; -3 &amp; \vdots &amp; 4/5 \\
0 &amp; 0 &amp; 50/19 &amp; \vdots &amp; -26/19
}\right] \end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1_LU</span><span class="o">=</span><span class="n">row_comb</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">/</span><span class="mi">19</span><span class="p">,</span><span class="n">M1_LU</span><span class="p">)</span>
<span class="n">M1_LU</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5.        , -4.        ,  0.        ,  1.        ],
       [ 0.        ,  3.8       , -3.        ,  0.8       ],
       [ 0.        ,  0.        ,  2.63157895, -1.36842105]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1_LU</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5.        , -4.        ,  0.        ,  1.        ],
       [ 0.        ,  3.8       , -3.        ,  0.8       ],
       [ 0.        ,  0.        ,  2.63157895, -1.36842105]])
</pre></div>
</div>
</div>
</div>
<p>The final step is to solve for <span class="math notranslate nohighlight">\(x_3\)</span> in the last equation, doing the operation <span class="math notranslate nohighlight">\(\operatorname{Lamb}(E_3,19/50)\)</span>, yielding:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \matrix{
5 &amp; -4 &amp; 0 &amp; \vdots &amp; 1 \\
0 &amp; 3.8 &amp; -3 &amp; \vdots &amp; 0.8 \\
0 &amp; 0 &amp; 1 &amp; \vdots &amp; -26/50
}\right] \end{split}\]</div>
<p>From this, it is direct to conclude that <span class="math notranslate nohighlight">\(x_3 = -26/50=-0.52\)</span>, for <span class="math notranslate nohighlight">\(x_2\)</span> and <span class="math notranslate nohighlight">\(x_1\)</span> it is only necessary to replace the found value of <span class="math notranslate nohighlight">\(x_3\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">row_lamb</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">19</span><span class="o">/</span><span class="mi">50</span><span class="p">,</span><span class="n">M1_LU</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5.  , -4.  ,  0.  ,  1.  ],
       [ 0.  ,  3.8 , -3.  ,  0.8 ],
       [ 0.  ,  0.  ,  1.  , -0.52]])
</pre></div>
</div>
</div>
</div>
<p>The full implementation in numpy is with <code class="docutils literal notranslate"><span class="pre">np.linalg.solve</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>np.linalg.solve<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">M1</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 0.04, -0.2 , -0.52])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">M1</span><span class="p">,[[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">],[</span><span class="o">-</span><span class="mi">2</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.04],
       [-0.2 ],
       [-0.52]])
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="linear-systems-of-equations">
<h2><a class="toc-backref" href="#id12"><span class="section-number">6.3. </span>Linear Systems of Equations</a><a class="headerlink" href="#linear-systems-of-equations" title="Permalink to this headline">#</a></h2>
<p>A linear system is a set of equations of <span class="math notranslate nohighlight">\(n\)</span> variables that can be written in a general form:</p>
<div class="math notranslate nohighlight">
\[ a_{11}x_1 + a_{12}x_2 + \cdots +a_{1n}x_n = b_1 \]</div>
<div class="math notranslate nohighlight">
\[\vdots\]</div>
<div class="math notranslate nohighlight">
\[ a_{m1}x_1 + a_{m2}x_2 + \cdots +a_{mn}x_n = b_n \]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is, again, the number of variables, and <span class="math notranslate nohighlight">\(m\)</span> the number of equations.</p>
<p>A linear system has solution if and only if <span class="math notranslate nohighlight">\(m\geq n\)</span>. This leads us to the main objetive of a linear system, find the set <span class="math notranslate nohighlight">\(\{x_i\}_{i=0}^n\)</span> that fulfills all the equations.</p>
<p>Although there is an intuitive way to solve this type of systems, by just adding and subtracting equations until reaching the desire result, the large number of variables of some systems found in physics and astronomy makes necessary to develop iterative and general approaches. Next, we shall introduce matrix and vector notation and some basic operations that will be the basis of the methods to be developed in this section.</p>
<p>Quadratic eqution…</p>
<section id="matrices-and-vectors">
<h3><span class="section-number">6.3.1. </span>Matrices and vectors<a class="headerlink" href="#matrices-and-vectors" title="Permalink to this headline">#</a></h3>
<p>A <span class="math notranslate nohighlight">\(m\times n\)</span> matrix can be defined as a set of numbers arranged in columns and rows such as:</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = [a_{ij}] = \left[ \matrix{
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\
\vdots &amp; \vdots &amp; &amp; \vdots\\
a_{m1} &amp; a_{m2} &amp; \cdots &amp; a_{mn} 
}\right] \end{split}\]</div>
<p>In the same way, it is possible to define a <span class="math notranslate nohighlight">\(n\)</span>-dimensional column vector as</p>
<div class="math notranslate nohighlight">
\[\begin{split} \boldsymbol{x} =  \left[ \matrix{
x_{1} \\
x_{2} \\
\vdots\\
x_{n} 
}\right] \end{split}\]</div>
<p>and a column vector of constant coefficients</p>
<div class="math notranslate nohighlight">
\[\begin{split} \boldsymbol{b} = \left[ \matrix{
b_{1} \\
b_{2} \\
\vdots \\
b_{n} 
}\right] \end{split}\]</div>
<p>The system of equations</p>
<div class="math notranslate nohighlight">
\[ a_{11}x_1 + a_{12}x_2 + \cdots a_{1n}x_n = b_1 \]</div>
<div class="math notranslate nohighlight">
\[\vdots\]</div>
<div class="math notranslate nohighlight">
\[ a_{m1}x_1 + a_{m2}x_2 + \cdots a_{mn}x_n = b_n \]</div>
<p>can be then written in a more convenient way as</p>
<div class="math notranslate nohighlight">
\[\begin{split} A \textbf{x} =  \left[ \matrix{
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\
\vdots &amp; \vdots &amp; &amp; \vdots\\
a_{m1} &amp; a_{m2} &amp; \cdots &amp; a_{mn} 
}\right] 
\left[ \matrix{
x_{1} \\
x_{2} \\
\vdots\\
x_{n} 
}\right]  = \boldsymbol{b} = 
\left[ \matrix{
b_{1} \\
b_{2} \\
\vdots\\
b_{n} 
}\right]\end{split}\]</div>
<p>We can also introducing the <span class="math notranslate nohighlight">\(n\times (n+1)\)</span> <strong>augmented matrix</strong> as</p>
<div class="math notranslate nohighlight">
\[\begin{split}[A:\textbf{b}] =  \left[ \matrix{
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} &amp; \vdots &amp; b_1 \\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} &amp; \vdots &amp; b_2 \\
\vdots &amp; \vdots &amp; &amp; \vdots &amp; \vdots &amp; \vdots \\
a_{m1} &amp; a_{n2} &amp; \cdots &amp; a_{nn} &amp; \vdots &amp; b_n
}\right]\end{split}\]</div>
<section id="implementation-in-scipy">
<h4><span class="section-number">6.3.1.1. </span>Implementation in Scipy<a class="headerlink" href="#implementation-in-scipy" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy.linalg</span> <span class="k">as</span> <span class="nn">linalg</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>linalg.lu<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1_aug</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5, -4,  0,  1],
       [-4,  7, -3,  0],
       [ 0, -3,  5, -2]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">U</span><span class="o">=</span><span class="n">linalg</span><span class="o">.</span><span class="n">lu</span><span class="p">(</span><span class="n">M1_aug</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5.        , -4.        ,  0.        ,  1.        ],
       [ 0.        ,  3.8       , -3.        ,  0.8       ],
       [ 0.        ,  0.        ,  2.63157895, -1.36842105]])
</pre></div>
</div>
</div>
</div>
<p><span class="math notranslate nohighlight">\(x_3\)</span> is now</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x3</span><span class="o">=</span><span class="n">U</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">U</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>
<span class="s1">&#39;x3=-26/50=</span><span class="si">{:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">x3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;x3=-26/50=-0.52&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x2</span><span class="o">=</span><span class="p">(</span><span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x3</span><span class="p">)</span><span class="o">/</span><span class="n">U</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="nb">round</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linear-algebra_180_0.png" src="../_images/linear-algebra_180_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x1</span><span class="o">=</span><span class="p">(</span> <span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">x2</span><span class="o">-</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x3</span> <span class="p">)</span><span class="o">/</span><span class="n">U</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="nb">round</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linear-algebra_181_0.png" src="../_images/linear-algebra_181_0.png" />
</div>
</div>
</section>
</section>
<section id="general-gaussian-elimination">
<h3><span class="section-number">6.3.2. </span>General Gaussian elimination<a class="headerlink" href="#general-gaussian-elimination" title="Permalink to this headline">#</a></h3>
<p>Now, we shall describe the general procedure for Gaussian elimination:</p>
<ol class="simple">
<li><p>Give an augmented matrix <span class="math notranslate nohighlight">\(\hat{A}=[A:\textbf{b}]\)</span>.</p></li>
<li><p>Find the first non-zero coefficient <span class="math notranslate nohighlight">\(a_{i1}\)</span> associated to <span class="math notranslate nohighlight">\(x_1\)</span>. This element is called <em>pivot</em>.</p></li>
<li><p>Apply the operation <span class="math notranslate nohighlight">\(\operatorname{Swap}(E_1,E_i)\)</span>. This guarantee the first row has a non-zero coefficient <span class="math notranslate nohighlight">\(a_{11}\)</span>.</p></li>
<li><p>Apply the operation <span class="math notranslate nohighlight">\(\operatorname{Comb}(E_j,E_1,-a_{j1}/a_{11})\)</span>. This eliminates the coefficients associated to <span class="math notranslate nohighlight">\(x_1\)</span> in all the rows but in the first one.</p></li>
<li><p>Repeat steps 2. to 4. but for the coefficients of <span class="math notranslate nohighlight">\(x_2\)</span> and then <span class="math notranslate nohighlight">\(x_3\)</span> and so up to <span class="math notranslate nohighlight">\(x_n\)</span>. When iterating the coefficients of <span class="math notranslate nohighlight">\(x_{k}\)</span>, do not take into account the first <span class="math notranslate nohighlight">\(k\)</span>-th rows as they are already sorted.</p></li>
<li><p>Once you obtain a diagonal form of the matrix, apply the operation <span class="math notranslate nohighlight">\(\operatorname{Lamb}(E_n,1/a_{nn})\)</span>. This will make the coefficient of <span class="math notranslate nohighlight">\(x_n\)</span> in the last equation equal to 1.</p></li>
<li><p>The final result should be an augmented matrix of the form:
$<span class="math notranslate nohighlight">\(\left[ \matrix{
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1(n-1)} &amp; a_{1n} &amp; \vdots &amp; \hat b_1 \\
0 &amp; a_{22} &amp; \cdots &amp; a_{2(n-1)} &amp; a_{2n} &amp; \vdots &amp; \hat b_2 \\
\vdots &amp; \vdots &amp;  &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; a_{(n-1)(n-1)} &amp; a_{(n-1)n} &amp; \vdots &amp; \hat b_{n-1} \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1 &amp; \vdots &amp; \hat b_n
}\right]\)</span>$</p></li>
<li><p>The solution to the problem is then obtained through backward substitutions, i.e.
$<span class="math notranslate nohighlight">\(x_n = \hat b_n\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\( x_{n-1} =  \frac{\hat b_{n-1} - a_{(n-1)n}x_n}{a_{(n-1)(n-1)}}\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(\vdots\)</span><span class="math notranslate nohighlight">\(
\)</span><span class="math notranslate nohighlight">\(x_i = \frac{\hat b_i - \sum_{j=i+1}^n a_{ij}x_j}{a_{ii}}\ \ \ \ \mbox{for}\ \ \ i=n-1, n-2, \cdots, 1\)</span>$</p></li>
</ol>
<p>See custom implementation of <span class="xref myst">general Gaussian elimination</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Gaussian Elimination</span>
<span class="kn">import</span> <span class="nn">scipy</span>
<span class="k">def</span> <span class="nf">Gaussian_Elimination</span><span class="p">(</span> <span class="n">A0</span> <span class="p">):</span>
    <span class="c1">#Making local copy of matrix</span>
    <span class="n">P</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">A</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lu</span><span class="p">(</span><span class="n">A0</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>    
    <span class="c1">#Finding solution</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="n">n</span> <span class="p">)</span>
    <span class="n">x</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">A</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">):</span>
        <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span> <span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">n</span><span class="p">])</span> <span class="p">)</span><span class="o">/</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
    
    <span class="c1">#Upper diagonal matrix and solutions x</span>
    <span class="k">return</span> <span class="n">A</span><span class="p">,</span> <span class="n">x</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="p">)</span>
<span class="n">M</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.5507979 , 0.70814782, 0.29090474, 0.51082761, 0.89294695],
       [0.89629309, 0.12558531, 0.20724288, 0.0514672 , 0.44080984],
       [0.02987621, 0.45683322, 0.64914405, 0.27848728, 0.6762549 ],
       [0.59086282, 0.02398188, 0.55885409, 0.25925245, 0.4151012 ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span><span class="p">,</span><span class="n">x</span><span class="o">=</span><span class="n">Gaussian_Elimination</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Upper triangular</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 0.89629309,  0.12558531,  0.20724288,  0.0514672 ,  0.44080984],
       [ 0.        ,  0.63097203,  0.16354802,  0.47919953,  0.62205662],
       [ 0.        ,  0.        ,  0.52490983, -0.06699671,  0.21531002],
       [ 0.        ,  0.        ,  0.        ,  0.32582312,  0.00303691]])
</pre></div>
</div>
</div>
</div>
<p>solutions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.27395594, 0.8721633 , 0.41137442, 0.00932074])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1_aug</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5, -4,  0,  1],
       [-4,  7, -3,  0],
       [ 0, -3,  5, -2]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Gaussian_Elimination</span><span class="p">(</span><span class="n">M1_aug</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([[ 5.        , -4.        ,  0.        ,  1.        ],
        [ 0.        ,  3.8       , -3.        ,  0.8       ],
        [ 0.        ,  0.        ,  2.63157895, -1.36842105]]),
 array([ 0.04, -0.2 , -0.52]))
</pre></div>
</div>
</div>
</div>
</section>
<section id="pivoting-strategies">
<h3><span class="section-number">6.3.3. </span>Pivoting Strategies<a class="headerlink" href="#pivoting-strategies" title="Permalink to this headline">#</a></h3>
<p>The previous method of Gaussian Elimination for finding solutions of linear systems is mathematically exact, however round-off errors that appear in computational arithmetics can represent a real problem when high accuracy is required.</p>
<p>In order to illustrate this, consider the next situation:</p>
<div class="math notranslate nohighlight">
\[ E_1: 0.00300x_1 + 59.14x_2 = 59.17 \]</div>
<div class="math notranslate nohighlight">
\[ E_2: 5.291x_1 - 6.130x_2 = 46.78 \]</div>
<p>Using four-digit arithmetic we obtain:</p>
<p><strong>1.</strong> Constructing the augmented matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \matrix{
0.003 &amp; 59.14 &amp; \vdots &amp; 59.17 \\
5.291 &amp; -6.130 &amp; \vdots &amp; 46.78
}\right] \end{split}\]</div>
<p><strong>2.</strong> Applying the reduction with the first pivot, we obtain:</p>
<div class="math notranslate nohighlight">
\[(E_1 + m E_2)\rightarrow (E_1)\]</div>
<p>where:</p>
<div class="math notranslate nohighlight">
\[m = -\frac{a_{21}}{a_{11}} = -\frac{5.291}{0.003} = 1763.666\cdots \approx 1764\]</div>
<p>In this step, we have taken the first four digits. This leads us to:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \matrix{
0.003 &amp; 59.14 &amp; \vdots &amp; 59.17 \\
0 &amp; -104300 &amp; \vdots &amp; -104400
}\right] \end{split}\]</div>
<p>The exact system is instead</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \matrix{
0.003 &amp; 59.14 &amp; \vdots &amp; 59.17 \\
0 &amp; -104309.37\bar{6} &amp; \vdots &amp; -104309.37\bar{6}
}\right] \end{split}\]</div>
<p>Using the solution <span class="math notranslate nohighlight">\(x_2 \approx 1.001\)</span>, we obtain</p>
<div class="math notranslate nohighlight">
\[ x_1 \approx \frac{59.17 - (59.14)(1.001)}{0.00300} = -10 \]</div>
<p>The exact solution is however:</p>
<div class="math notranslate nohighlight">
\[ x_1 = 10.00 \]</div>
<p>The source of such a large error is that the factor <span class="math notranslate nohighlight">\(59.14/0.00300 \approx 20000\)</span>. This quantity is propagated through the combination steps of the Gaussian Elimination, yielding a complete wrong result.</p>
</section>
<section id="computing-time">
<h3><span class="section-number">6.3.4. </span>Computing time<a class="headerlink" href="#computing-time" title="Permalink to this headline">#</a></h3>
<p>As mentioned before, Algebra Linear methods do not invole numerical approximations excepting round-off errors. This implies the computing time depends on the number of involved operations (multiplications, divisions, additions and subtractions). It is possible to demonstrate that the numbers of required divisions/multiplications is given by:</p>
<div class="math notranslate nohighlight">
\[\frac{n^3}{3}+n^2-\frac{n}{3}\]</div>
<p>and the required additions/subtractions:</p>
<div class="math notranslate nohighlight">
\[\frac{n^3}{3}+\frac{n^2}{2}-\frac{5n}{6}\]</div>
<p>These numbers are calculated separately as the computing time per operation for divisions and multiplications are similar and much larger than computing times for additions and subtractions. According to this, the overall computing time, for large <span class="math notranslate nohighlight">\(n\)</span>, scales as <span class="math notranslate nohighlight">\(n^3\)</span>/3.</p>
</section>
<section id="example-2">
<h3><span class="section-number">6.3.5. </span>Example 2<a class="headerlink" href="#example-2" title="Permalink to this headline">#</a></h3>
<p>Using the library <code class="docutils literal notranslate"><span class="pre">datetime</span></code> of python, evaluate the computing time required for <code class="docutils literal notranslate"><span class="pre">Gaussian_Elimination</span></code> to find the solution of a system of <span class="math notranslate nohighlight">\(n=20\)</span> equations and <span class="math notranslate nohighlight">\(20\)</span> unknowns. For this purpose you can generate random systems. For a more robust result, repeat <span class="math notranslate nohighlight">\(500\)</span> times, give a mean value and plot an histrogram of the computing times.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Importing datatime</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>

<span class="c1">#Number of repeats</span>
<span class="n">Nrep</span> <span class="o">=</span> <span class="mi">500</span>
<span class="c1">#Size of matrix</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">20</span>

<span class="k">def</span> <span class="nf">Gaussian_Time</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">Nrep</span> <span class="p">):</span>
    <span class="c1">#Arrays of times</span>
    <span class="n">Times</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="c1">#Cicle for number of repeats</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">Nrep</span><span class="p">):</span>
        <span class="c1">#Generating random matrix</span>
        <span class="n">M</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span> <span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
        
        <span class="c1">#Starting time counter</span>
        <span class="n">tstart</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="c1">#Invoking Gaussian Elimination routine</span>
        <span class="n">Gaussian_Elimination</span><span class="p">(</span><span class="n">M</span><span class="p">)</span>
        <span class="c1">#Killing time counter</span>
        <span class="n">tend</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        
        <span class="c1">#Saving computing time</span>
        <span class="n">Times</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="n">tend</span><span class="o">-</span><span class="n">tstart</span><span class="p">)</span><span class="o">.</span><span class="n">microseconds</span> <span class="p">)</span>
        
    <span class="c1">#Numpy Array</span>
    <span class="n">Times</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">Times</span><span class="p">)</span>
    
    <span class="nb">print</span> <span class="s2">&quot;The mean computing time for a </span><span class="si">%d</span><span class="s2">x</span><span class="si">%d</span><span class="s2"> matrix is: </span><span class="si">%lf</span><span class="s2"> microseconds&quot;</span><span class="o">%</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">Times</span><span class="o">.</span><span class="n">mean</span><span class="p">())</span>
    
    <span class="c1">#Histrogram</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">histo</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span> <span class="n">Times</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">30</span> <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span> <span class="s2">&quot;Computing Time [microseconds]&quot;</span> <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span> <span class="s2">&quot;Ocurrences&quot;</span> <span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
    
    <span class="k">return</span> <span class="n">Times</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    
    
<span class="n">Gaussian_Time</span><span class="p">(</span> <span class="n">n</span><span class="p">,</span> <span class="n">Nrep</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The mean computing time for a 20x20 matrix is: 2762.628000 microseconds
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2762.6280000000002
</pre></div>
</div>
<img alt="../_images/linear-algebra_200_2.png" src="../_images/linear-algebra_200_2.png" />
</div>
</div>
</section>
<section id="id2">
<h3><span class="section-number">6.3.6. </span><span style='color:red'> Activity </span><a class="headerlink" href="#id2" title="Permalink to this headline">#</a></h3>
<p>Using the previous code, estimate the computing time for random matrices of size <span class="math notranslate nohighlight">\(n=5,10,50,100,500,1000\)</span>. For each size, compute <span class="math notranslate nohighlight">\(500\)</span> times in order to reduce spurious errors. Plot the results in a figure of <span class="math notranslate nohighlight">\(n\)</span> vs computing time. Is it verified the some of scaling laws (Multiplication/Division or Addition/Sustraction). Note that for large values of <span class="math notranslate nohighlight">\(n\)</span>, both scaling laws converge to the same.</p>
</section>
<hr class="docutils" />
<section id="partial-pivoting">
<h3><span class="section-number">6.3.7. </span>Partial pivoting<a class="headerlink" href="#partial-pivoting" title="Permalink to this headline">#</a></h3>
<p>A suitable method to reduce round-off errors is to choose a pivot more conveniently. As we saw before, a small pivot generally implies larger propagated errors as they appear usually as dividends. The partial pivoting method consists then of a choosing of the largest absolute coefficient associated to <span class="math notranslate nohighlight">\(x_i\)</span> instead of the first non-null one, i.e.</p>
<div class="math notranslate nohighlight">
\[ |a_{ii}| = \max_{i\leq j\leq n}|a_{ji}| \]</div>
<p>This way, propagated multiplication errors would be minimized.</p>
</section>
<section id="id3">
<h3><span class="section-number">6.3.8. </span><span style='color:red'> Activity </span><a class="headerlink" href="#id3" title="Permalink to this headline">#</a></h3>
<p>Create a new routine <code class="docutils literal notranslate"><span class="pre">Gaussian_Elimination_Pivoting</span></code> from <code class="docutils literal notranslate"><span class="pre">Gaussian_Elimination</span></code> in order to include the partial pivoting method. Compare both routines with some random matrix and with the exact solution.</p>
</section>
</section>
<hr class="docutils" />
<section id="matrix-inversion">
<h2><a class="toc-backref" href="#id13"><span class="section-number">6.4. </span>Matrix Inversion</a><a class="headerlink" href="#matrix-inversion" title="Permalink to this headline">#</a></h2>
<p>Asumming a nonsingular matrix <span class="math notranslate nohighlight">\(A\)</span>, if a matrix <span class="math notranslate nohighlight">\(A^{-1}\)</span> exists, with <span class="math notranslate nohighlight">\(AA^{-1} = I\)</span> and <span class="math notranslate nohighlight">\(A^{-1}A = I\)</span>, where <span class="math notranslate nohighlight">\(I\)</span> is the identity matrix, then <span class="math notranslate nohighlight">\(A^{-1}\)</span> is called the inverse matrix of <span class="math notranslate nohighlight">\(A\)</span>. If such a matrix does not exist, <span class="math notranslate nohighlight">\(A\)</span> is said to be a singular matrix.</p>
<p>A corollary of this definition is that <span class="math notranslate nohighlight">\(A\)</span> is also the inverse matrix of <span class="math notranslate nohighlight">\(A^{-1}\)</span>.</p>
<p>Once defined the Gaussian Elimination method, it is possible to extend it in order to find the inverse of any nonsingular matrix.
Let’s consider the next equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split} AA^{-1} = AB= \left[ \matrix{
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\
\vdots &amp; \vdots &amp; &amp; \vdots\\
a_{m1} &amp; a_{n2} &amp; \cdots &amp; a_{nn} 
}\right]\left[ \matrix{
b_{11} &amp; b_{12} &amp; \cdots &amp; b_{1n} \\
b_{21} &amp; b_{22} &amp; \cdots &amp; b_{2n} \\
\vdots &amp; \vdots &amp; &amp; \vdots\\
b_{n1} &amp; b_{n2} &amp; \cdots &amp; b_{nn} 
}\right] = 
\left[ \matrix{
1 &amp; 0 &amp; \cdots &amp; 0 \\
0 &amp; 1 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
0 &amp; 0 &amp; \cdots &amp; 1
}\right]\end{split}\]</div>
<p>This can be rewritten as a set of <span class="math notranslate nohighlight">\(n\)</span> systems of equations, i.e.</p>
<div class="math notranslate nohighlight">
\[\begin{split} \left[ \matrix{
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\
\vdots &amp; \vdots &amp; &amp; \vdots\\
a_{n1} &amp; a_{n2} &amp; \cdots &amp; a_{nn} 
}\right]\left[ \matrix{
b_{11} \\
b_{21} \\
\vdots \\
b_{n1}
}\right] = 
\left[ \matrix{
1 \\
0 \\
\vdots \\
0
}\right],\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left[ \matrix{
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\
\vdots &amp; \vdots &amp; &amp; \vdots\\
a_{n1} &amp; a_{n2} &amp; \cdots &amp; a_{nn} 
}\right]\left[ \matrix{
b_{12} \\
b_{22} \\
\vdots \\
b_{n2}
}\right] = 
\left[ \matrix{
0 \\
1 \\
\vdots \\
0
}\right]\end{split}\]</div>
<div class="math notranslate nohighlight">
\[\vdots\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}\left[ \matrix{
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} \\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} \\
\vdots &amp; \vdots &amp; &amp; \vdots\\
a_{n1} &amp; a_{n2} &amp; \cdots &amp; a_{nn} 
}\right]\left[ \matrix{
b_{1n} \\
b_{2n} \\
\vdots \\
b_{nn}
}\right] = 
\left[ \matrix{
0 \\
0 \\
\vdots \\
1
}\right]\end{split}\]</div>
<p>These systems can be solved individually by using Gaussian Elimination, however we can mix all the problems, obtaining the augmented matrix:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[ \matrix{
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1n} &amp; \vdots &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\
a_{21} &amp; a_{22} &amp; \cdots &amp; a_{2n} &amp; \vdots &amp; 0 &amp; 1 &amp; \cdots &amp; 0 \\
\vdots &amp; \vdots &amp; &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
a_{n1} &amp; a_{n2} &amp; \cdots &amp; a_{nn} &amp; \vdots &amp; 0 &amp; 0 &amp; \cdots &amp; 1
}\right]\end{split}\]</div>
<p>Now, applying Gaussian Elimination we can obtain a upper diagonal form for the first matrix. Completing the steps using forwards elimination we can convert the first matrix into the identity matrix, obtaining</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[ \matrix{
1 &amp; 0 &amp; \cdots &amp; 0 &amp; \vdots &amp; b_{11} &amp; b_{12} &amp; \cdots &amp; b_{1n} \\
0 &amp; 1 &amp; \cdots &amp; 0 &amp; \vdots &amp; b_{21} &amp; b_{22} &amp; \cdots &amp; b_{2n} \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots &amp; &amp; \vdots\\
0 &amp; 0 &amp; \cdots &amp; 1 &amp; \vdots &amp; b_{n1} &amp; b_{n2} &amp; \cdots &amp; b_{nn}
}\right]\end{split}\]</div>
<p>Where the second matrix is then the inverse <span class="math notranslate nohighlight">\(B=A^{-1}\)</span>.</p>
<section id="id4">
<h3><span class="section-number">6.4.1. </span><span style='color:red'> Activity </span><a class="headerlink" href="#id4" title="Permalink to this headline">#</a></h3>
<p>Using the previous routine <code class="docutils literal notranslate"><span class="pre">Gaussian_Elimination_Pivoting</span></code>, create a new routine <code class="docutils literal notranslate"><span class="pre">Inverse</span></code> that calculates the inverse of any given squared matrix.</p>
</section>
</section>
<hr class="docutils" />
<section id="determinant-of-a-matrix">
<h2><a class="toc-backref" href="#id14"><span class="section-number">6.5. </span>Determinant of a Matrix</a><a class="headerlink" href="#determinant-of-a-matrix" title="Permalink to this headline">#</a></h2>
<p>The determinant of a matrix is a scalar quantity calculated for square matrix. This provides important information about the matrix of coefficients of a system of linear of equations. For example, any system of <span class="math notranslate nohighlight">\(n\)</span> equations and <span class="math notranslate nohighlight">\(n\)</span> unknowns has an unique solution if the associated determinant is nonzero. This also implies the determinant allows to evaluate whether a matrix is singular or nonsingular.</p>
<section id="calculating-determinants">
<h3><span class="section-number">6.5.1. </span>Calculating determinants<a class="headerlink" href="#calculating-determinants" title="Permalink to this headline">#</a></h3>
<p>Next, we shall define some properties of determinants that will allow us to calculate determinants by using a recursive code:</p>
<p><strong>1.</strong> If <span class="math notranslate nohighlight">\(A = [a]\)</span> is a <span class="math notranslate nohighlight">\(1\times 1\)</span> matrix, its determinant is then <span class="math notranslate nohighlight">\(\det A = a\)</span>.</p>
<p><strong>2.</strong> If <span class="math notranslate nohighlight">\(A\)</span> is a <span class="math notranslate nohighlight">\(n\times n\)</span> matrix, the minor matrix <span class="math notranslate nohighlight">\(M_{ij}\)</span> is the determinant of the <span class="math notranslate nohighlight">\((n-1)\times(n-1)\)</span> matrix obtained by deleting the <span class="math notranslate nohighlight">\(i\)</span>th row and the <span class="math notranslate nohighlight">\(j\)</span>th column.</p>
<p><strong>3.</strong> The cofactor <span class="math notranslate nohighlight">\(A_{ij}\)</span> associated with <span class="math notranslate nohighlight">\(M_{ij}\)</span> is defined by <span class="math notranslate nohighlight">\(A_{ij} = (-1)^{i+j}M_{ij}\)</span>.</p>
<p><strong>4.</strong> The determinant of a <span class="math notranslate nohighlight">\(n\times n\)</span> matrix <span class="math notranslate nohighlight">\(A\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[ \det A = \sum_{j=1}^n a_{ij}A_{ij} \]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[ \det A = \sum_{i=1}^n a_{ij}A_{ij} \]</div>
<p>This is, it is possible to use both, a row or a column for calculating the determinant.</p>
</section>
<section id="computing-time-of-determinants">
<h3><span class="section-number">6.5.2. </span>Computing time of determinants<a class="headerlink" href="#computing-time-of-determinants" title="Permalink to this headline">#</a></h3>
<p>Using the previous recurrence, we can calculate the computing time of the previous algorithm. First, let’s consider the number of required operations for a <span class="math notranslate nohighlight">\(2\times 2\)</span> matrix: let <span class="math notranslate nohighlight">\(A\)</span> be a <span class="math notranslate nohighlight">\(2\times 2\)</span> matrix given by:</p>
<div class="math notranslate nohighlight">
\[\begin{split} A = \left[ \matrix{
a_{11} &amp; a_{12} \\
a_{21} &amp; a_{22}}\right]\end{split}\]</div>
<p>The determinant is then given by:</p>
<div class="math notranslate nohighlight">
\[\det(A) = a_{11}a_{22} - a_{12}a_{21}\]</div>
<p>the number of required multiplications was <span class="math notranslate nohighlight">\(2\)</span> and subtractions is <span class="math notranslate nohighlight">\(1\)</span>.</p>
<p>Now, using the previous formula for the determinant</p>
<div class="math notranslate nohighlight">
\[ \det A = \sum_{j=1}^n a_{ij}A_{ij} \]</div>
<p>For a <span class="math notranslate nohighlight">\(3\times 3\)</span> matrix, it is necessary to calculate <span class="math notranslate nohighlight">\(3\)</span> times <span class="math notranslate nohighlight">\(2\times 2\)</span> determinants. Besides, it is necessary to multiply the cofactor <span class="math notranslate nohighlight">\(A_{ij}\)</span> with the coefficient <span class="math notranslate nohighlight">\(a_{ij}\)</span>, that leads us with <span class="math notranslate nohighlight">\(t_{n=3}=3\times 2 + 3\)</span> multiplications. Additions are not important as their computing time is far less than multiplications.</p>
<p>For a <span class="math notranslate nohighlight">\(4\times 4\)</span> matrix, we need four deteminants of <span class="math notranslate nohighlight">\(3\times 3\)</span> submatrices, leading <span class="math notranslate nohighlight">\(t_{n=4} = 4\times( 3\times 2 + 3 ) + 4 = 4! + \frac{4!}{2!} + \frac{4!}{3!}\)</span>. In general, for a <span class="math notranslate nohighlight">\(n\times n\)</span> matrix, we have then:</p>
<div class="math notranslate nohighlight">
\[ t_{n} = \frac{n!}{(n-1)!} + \frac{n!}{(n-2)!} + \cdots + \frac{n!}{1!} = n!\left( \sum_{i=1}^{n-1}\frac{1}{i!} \right)\]</div>
<p>If <span class="math notranslate nohighlight">\(n\)</span> is large enough, we can approximate <span class="math notranslate nohighlight">\(t_{n}\approx n!\)</span>.</p>
<p>In computers, this is a prohibitive computing time so other schemes have to be proposed.</p>
</section>
<section id="id5">
<h3><span class="section-number">6.5.3. </span><span style='color:red'> Activity </span><a class="headerlink" href="#id5" title="Permalink to this headline">#</a></h3>
<p>Evaluate the computing time of the <code class="docutils literal notranslate"><span class="pre">Determinant</span></code> routine for matrix sizes of <span class="math notranslate nohighlight">\(n=1,2,3,\cdots,10\)</span> and doing several repeats. Plot your result (<span class="math notranslate nohighlight">\(n\)</span> vs <span class="math notranslate nohighlight">\(t_n\)</span>). What can you conclude about the behaviour of the computing time?</p>
</section>
<section id="properties-of-determinants">
<h3><span class="section-number">6.5.4. </span>Properties of determinants<a class="headerlink" href="#properties-of-determinants" title="Permalink to this headline">#</a></h3>
<p>Determinants have a set of properties that can reduce considerably computing times. Suppose <span class="math notranslate nohighlight">\(A\)</span> is a <span class="math notranslate nohighlight">\(n\times n\)</span> matrix:</p>
<p><strong>1.</strong> If any row or column of <span class="math notranslate nohighlight">\(A\)</span> has only zero entries, then <span class="math notranslate nohighlight">\(\det A = 0\)</span>.</p>
<p><strong>2.</strong> If two rows or columns of <span class="math notranslate nohighlight">\(A\)</span> are the same, then <span class="math notranslate nohighlight">\(\det A = 0\)</span>.</p>
<p><strong>3.</strong> If <span class="math notranslate nohighlight">\(\hat A\)</span> is obtained from <span class="math notranslate nohighlight">\(A\)</span> by using a swap operation <span class="math notranslate nohighlight">\((E_i)\leftrightarrow (E_j)\)</span>, then <span class="math notranslate nohighlight">\(\det \hat A=-\det A\)</span>.</p>
<p><strong>4.</strong> If <span class="math notranslate nohighlight">\(\hat A\)</span> is obtained from <span class="math notranslate nohighlight">\(A\)</span> by using a escalation operation <span class="math notranslate nohighlight">\((\lambda E_i)\leftrightarrow (E_i)\)</span>, then <span class="math notranslate nohighlight">\(\det \hat A=\lambda \det A\)</span>.</p>
<p><strong>5.</strong> If <span class="math notranslate nohighlight">\(\hat A\)</span> is obtained from <span class="math notranslate nohighlight">\(A\)</span> by using a combination operation <span class="math notranslate nohighlight">\((E_i+\lambda E_j) \leftrightarrow (E_i)\)</span>, then <span class="math notranslate nohighlight">\(\det \hat A=\det A\)</span>.</p>
<p><strong>6.</strong> If <span class="math notranslate nohighlight">\(B\)</span> is also a <span class="math notranslate nohighlight">\(n\times n\)</span> matrix, then <span class="math notranslate nohighlight">\(\det(AB)=(\det A)(\det B).\)</span></p>
<p><strong>7.</strong> <span class="math notranslate nohighlight">\(\det A^t=\det A.\)</span></p>
<p><strong>8.</strong> <span class="math notranslate nohighlight">\(\det A^{-1}=(\det A)^{-1}\)</span></p>
<p><strong>9.</strong> Finally and most importantly: if <span class="math notranslate nohighlight">\(A\)</span> is an upper, lower or diagonal matrix, then:</p>
<div class="math notranslate nohighlight">
\[ \det A = \prod_{i=1}^n a_{ii} \]</div>
<p>As we analysed before, Gaussian Elimination takes a computing time scaling like <span class="math notranslate nohighlight">\(n^3\)</span> for large matrix sizes. According to the previous properties, the determinant of a upper diagonal matrix just takes <span class="math notranslate nohighlight">\(n-1\)</span> multiplications, far less than a nondiagonal matrix. Combining these properties, we can track back and relate the determinant of the resulting upper diagonal matrix and the original one. Leading us to a computing time scaling like <span class="math notranslate nohighlight">\(n^3\)</span>, much better than the original <span class="math notranslate nohighlight">\(n!\)</span>.</p>
</section>
<section id="id6">
<h3><span class="section-number">6.5.5. </span><span style='color:red'> Activity </span><a class="headerlink" href="#id6" title="Permalink to this headline">#</a></h3>
<p>Using the <code class="docutils literal notranslate"><span class="pre">Gaussian_Elimination</span></code> routine and tracking back the performed operations, construct a new routine called <code class="docutils literal notranslate"><span class="pre">Gaussian_Determinant</span></code>. Make the same analysis of the computing time as the previous activity. Compare both results.</p>
</section>
<section id="existence-of-inverse">
<h3><span class="section-number">6.5.6. </span>Existence of inverse<a class="headerlink" href="#existence-of-inverse" title="Permalink to this headline">#</a></h3>
<p>A matrix <span class="math notranslate nohighlight">\(A\)</span> has an inverse if <span class="math notranslate nohighlight">\(\det{A}\ne 0\)</span>. See for example <a class="reference external" href="http://www.sosmath.com/matrix/inverse/inverse.html">here</a></p>
<p>If the matrix <span class="math notranslate nohighlight">\(A\)</span> has an inverse, then</p>
<div class="amsmath math notranslate nohighlight" id="equation-a53988c9-dc14-41b3-bcff-34cda9a1c962">
<span class="eqno">(6.4)<a class="headerlink" href="#equation-a53988c9-dc14-41b3-bcff-34cda9a1c962" title="Permalink to this equation">#</a></span>\[\begin{align}
A \boldsymbol{x}=&amp;\boldsymbol{b}\\
A^{-1}A\boldsymbol{x}=&amp;A^{-1}\boldsymbol{b}\\
\boldsymbol{x}=&amp;A^{-1}\boldsymbol{b}\,,
\end{align}\]</div>
<p><strong>Example</strong>
From the previous example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">M</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span> <span class="p">)</span>
<span class="n">M</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.5507979 , 0.70814782, 0.29090474, 0.51082761, 0.89294695],
       [0.89629309, 0.12558531, 0.20724288, 0.0514672 , 0.44080984],
       [0.02987621, 0.45683322, 0.64914405, 0.27848728, 0.6762549 ],
       [0.59086282, 0.02398188, 0.55885409, 0.25925245, 0.4151012 ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.5507979 , 0.89629309, 0.02987621, 0.59086282])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">M</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.5507979 ],
       [0.89629309],
       [0.02987621],
       [0.59086282]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="nb">tuple</span><span class="p">(</span> <span class="p">[</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span><span class="n">M</span><span class="p">[:,</span><span class="n">i</span><span class="p">]]</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">]</span> <span class="p">)</span> <span class="p">]</span>
<span class="n">A</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.5507979 , 0.70814782, 0.29090474, 0.51082761],
       [0.89629309, 0.12558531, 0.20724288, 0.0514672 ],
       [0.02987621, 0.45683322, 0.64914405, 0.27848728],
       [0.59086282, 0.02398188, 0.55885409, 0.25925245]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">b</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span> <span class="n">M</span><span class="p">[:,</span><span class="mi">4</span><span class="p">]</span> <span class="p">]</span>
<span class="n">b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.89294695],
       [0.44080984],
       [0.6762549 ],
       [0.4151012 ]])
</pre></div>
</div>
</div>
</div>
<p>such that</p>
<div class="amsmath math notranslate nohighlight" id="equation-b394fa55-66bd-42dc-ae3f-601a149a3417">
<span class="eqno">(6.5)<a class="headerlink" href="#equation-b394fa55-66bd-42dc-ae3f-601a149a3417" title="Permalink to this equation">#</a></span>\[\begin{align}
A \boldsymbol{x}=&amp;\boldsymbol{b}\,,
\end{align}\]</div>
<p>Check that <span class="math notranslate nohighlight">\(A\)</span> has an inverse and calculate <span class="math notranslate nohighlight">\(\boldsymbol{x}\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">det</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/linear-algebra_234_0.png" src="../_images/linear-algebra_234_0.png" />
</div>
</div>
<p><span class="math notranslate nohighlight">\(\boldsymbol{x}=\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sympy</span><span class="o">.</span><span class="n">Matrix</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">A</span><span class="p">)</span> <span class="p">,</span> <span class="n">b</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span> <span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_latex math notranslate nohighlight">
\[\begin{split}\displaystyle \left[\begin{matrix}0.274\\0.8722\\0.4114\\0.0093\end{matrix}\right]\end{split}\]</div>
</div>
</div>
<section id="numpy-implementation">
<h4><span class="section-number">6.5.6.1. </span>Numpy implementation<a class="headerlink" href="#numpy-implementation" title="Permalink to this headline">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[0.27395594],
       [0.8721633 ],
       [0.41137442],
       [0.00932074]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">M</span><span class="p">[:,</span><span class="mi">4</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([0.27395594, 0.8721633 , 0.41137442, 0.00932074])
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="matrix-diagonalization">
<h2><a class="toc-backref" href="#id15"><span class="section-number">6.6. </span>Matrix diagonalization</a><a class="headerlink" href="#matrix-diagonalization" title="Permalink to this headline">#</a></h2>
<p>See <a class="reference internal" href="linear-algebra-diagonalization.html"><span class="doc std std-doc">linear-algebra-diagonalization</span></a></p>
</section>
<hr class="docutils" />
<section id="lu-factorization">
<h2><a class="toc-backref" href="#id16"><span class="section-number">6.7. </span>LU Factorization</a><a class="headerlink" href="#lu-factorization" title="Permalink to this headline">#</a></h2>
<p>As we saw before, the Gaussian Elimination algorithm takes a computing time scaling as <span class="math notranslate nohighlight">\(\mathcal{O}(n^3/3)\)</span> in order to solve a system of <span class="math notranslate nohighlight">\(n\)</span> equations and <span class="math notranslate nohighlight">\(n\)</span> unknowns. Let’s assume a system of equations <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{x} = \mathbf{b}\)</span> where <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> is already in upper diagonal form.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[ \matrix{
a_{11} &amp; a_{12} &amp; \cdots &amp; a_{1(n-1)} &amp; a_{1n} &amp; \vdots &amp; \hat b_1 \\
0 &amp; a_{22} &amp; \cdots &amp; a_{2(n-1)} &amp; a_{2n} &amp; \vdots &amp; \hat b_2 \\
\vdots &amp; \vdots &amp;  &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; a_{(n-1)(n-1)} &amp; a_{(n-1)n} &amp; \vdots &amp; \hat b_{n-1} \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; a_{nn} &amp; \vdots &amp; \hat b_n
}\right]\end{split}\]</div>
<p>The Gauss-Jordan algorithm can reduce even more this problem in order to solve it directly, yielding:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\left[ \matrix{
1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 &amp; \vdots &amp; x_1 \\
0 &amp; 1 &amp; \cdots &amp; 0 &amp; 0 &amp; \vdots &amp; x_2 \\
\vdots &amp; \vdots &amp;  &amp; \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\
0 &amp; 0 &amp; \cdots &amp; 1 &amp; 0 &amp; \vdots &amp; x_{n-1} \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; 1 &amp; \vdots &amp; x_n
}\right]\end{split}\]</div>
<p>From the upper diagonal form to the completely reduced one, it is necessary to perform <span class="math notranslate nohighlight">\(n+(n-1)+(n-2)+\cdots\propto n(n-1)\)</span> backwards substitutions. The computing time for solving a upper diagonal system is then <span class="math notranslate nohighlight">\(\mathcal{O}(n^2)\)</span>.</p>
<p>Now, let <span class="math notranslate nohighlight">\(\mathbf{A}\mathbf{x} = \mathbf{b}\)</span> be a general system of equations of <span class="math notranslate nohighlight">\(n\)</span> dimensions. Let’s assume <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> can be written as a multiplication of two matrices, one lower diagonal <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> and other upper diagonal <span class="math notranslate nohighlight">\(\mathbf{U}\)</span>, such that <span class="math notranslate nohighlight">\(\mathbf{A}=\mathbf{L}\mathbf{U}\)</span>. Defining a vector <span class="math notranslate nohighlight">\(\mathbf{y} = \mathbf{U}\mathbf{x}\)</span>, it is obtained for the original system</p>
<div class="math notranslate nohighlight">
\[ \mathbf{A} \mathbf{x}=\mathbf{L}(\mathbf{U}\mathbf{x}) = \mathbf{L}\mathbf{y} = \mathbf{b}\]</div>
<p>For solving this system we can then:</p>
<p><strong>1.</strong> Solve the equivalent system <span class="math notranslate nohighlight">\(\mathbf{L}\mathbf{y} = \mathbf{b}\)</span>, what takes a computing time of <span class="math notranslate nohighlight">\(\mathcal{O}(n^2)\)</span>.</p>
<p><strong>2.</strong> Once we know <span class="math notranslate nohighlight">\(\mathbf{y}\)</span>, we can solve the system <span class="math notranslate nohighlight">\(\mathbf{U}\mathbf{x} = \mathbf{y}\)</span>, with a computing time of <span class="math notranslate nohighlight">\(\mathcal{O}(n^2)\)</span>.</p>
<p>The global computing time is then <span class="math notranslate nohighlight">\(\mathcal{O}(2n^2)\)</span></p>
<section id="id7">
<h3><span class="section-number">6.7.1. </span><span style='color:red'> Activity </span><a class="headerlink" href="#id7" title="Permalink to this headline">#</a></h3>
<p>In order to compare the computing time that Gaussian Elimination takes and the previous time for the LU factorization, make a plot of both computing times. What can you conclude when <span class="math notranslate nohighlight">\(n\)</span> becomes large enough?</p>
</section>
<section id="derivation-of-lu-factorization">
<h3><span class="section-number">6.7.2. </span>Derivation of LU factorization<a class="headerlink" href="#derivation-of-lu-factorization" title="Permalink to this headline">#</a></h3>
<p>Although the LU factorization seems to be a far better method for solving linear systems as compared with say Gaussian Elimination, we was assuming we already knew the matrices <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}\)</span>. Now we are going to see the algorithm for perfoming this reduction takes a computing time of <span class="math notranslate nohighlight">\(\mathcal{O}(n^3/3)\)</span>.</p>
<p>You may wonder then, what advantage implies the use of this factorization? Well, matrices <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{U}\)</span> do not depend on the specific system to be solved, i.e. there is not dependence on the <span class="math notranslate nohighlight">\(\mathbf{b}\)</span> vector, so once we have both matrices, we can use them to solve any system we want, just taking a <span class="math notranslate nohighlight">\(\mathcal{O}(2n^2)\)</span> computing time.</p>
<p>First, let’s assume a matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> with all its pivots are nonzero, so there is not need to swap rows. Now, when we want to eliminate all the coefficients associated to <span class="math notranslate nohighlight">\(x_1\)</span>, we perform the next operations:</p>
<div class="math notranslate nohighlight">
\[ (E_j-m_{j1}E_1)\rightarrow (E_j), \ \ \ \ \mbox{where}\ \ \ \ m_{j1} = \frac{a^{(1)}_{j1}}{a^{(1)}_{11}} \]</div>
<p>henceforth, <span class="math notranslate nohighlight">\(a^{(1)}_{ij}\)</span> denotes the components of the original matrix <span class="math notranslate nohighlight">\(\mathbf{A}=\mathbf{A}^{(1)}\)</span>, <span class="math notranslate nohighlight">\(a^{(2)}_{ij}\)</span> the components of the matrix after eliminating the coefficients of <span class="math notranslate nohighlight">\(x_1\)</span>, and generally, <span class="math notranslate nohighlight">\(a^{(k)}_{ij}\)</span> the components of the matrix after eliminating the coefficients of <span class="math notranslate nohighlight">\(x_{k-1}\)</span>.</p>
<p>The previous operation over the matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> can be also reproduced defining the matrix <span class="math notranslate nohighlight">\(\mathbf{M}^{(1)}\)</span></p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{M}^{(1)} = \left[ \matrix{
1 &amp; 0 &amp; \cdots &amp; 0 &amp; 0 \\
-m_{21} &amp; 1 &amp; \cdots &amp; 0 &amp; 0 \\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots &amp; \vdots \\
-m_{(n-1)1} &amp; 0 &amp; \cdots &amp; 1 &amp; 0 \\
-m_{n1} &amp; 0 &amp; \cdots &amp; 0 &amp; 1
}\right]\end{split}\]</div>
<p>This is called the <strong>first Gaussian transformation matrix</strong>. From this, we have</p>
<div class="math notranslate nohighlight">
\[ \mathbf{A}^{(2)}\mathbf{x} = \mathbf{M}^{(1)}\mathbf{A}^{(1)}\mathbf{x} = \mathbf{M}^{(1)}\mathbf{b}^{(1)} = \mathbf{b}^{(2)} \]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{A}^{(2)}\)</span> is matrix with null coefficients associated to <span class="math notranslate nohighlight">\(x_1\)</span> but the first one.</p>
<p>Repeating the same procedure for the next pivots, we obtain then</p>
<div class="math notranslate nohighlight">
\[ \mathbf{A}^{(n)} = \mathbf{M}^{(n-1)}\mathbf{M}^{(n-2)}\cdots \mathbf{M}^{(1)}\mathbf{A}^{(1)} \]</div>
<p>where the <strong><span class="math notranslate nohighlight">\(k\)</span>th Gaussian transformation matrix</strong> is defined as</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{M}^{(k)}_{ij} = \left\{ \matrix{
1 &amp; \mbox{if}\ \ i=j \\
-m_{ij} &amp; \mbox{if}\ \ j=k\ \ \mbox{and}\ \ k+1\leq i \leq n \\
0 &amp; \mbox{otherwise}
}  \right.\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight">
\[m_{ij} = \frac{a^{(j)}_{ij}}{a^{(j)}_{jj}} \]</div>
<p>Note <span class="math notranslate nohighlight">\(\mathbf{A}^{(n)}\)</span> is a upper diagonal matrix given by</p>
<div class="math notranslate nohighlight">
\[\begin{split}\mathbf{A}^{(n)} = \left[ \matrix{
a_{11}^{(n)} &amp; a_{12}^{(n)} &amp; \cdots &amp; a_{1(n-1)}^{(n)} &amp; a_{1n}^{(n)}\\
0 &amp; a_{22}^{(n)} &amp; \cdots &amp; a_{2(n-1)}^{(n)} &amp; a_{2n}^{(n)} \\
\vdots &amp; \vdots &amp;  &amp; \vdots &amp; \vdots &amp;\\
0 &amp; 0 &amp; \cdots &amp; a_{(n-1)(n-1)}^{(n)} &amp; a_{(n-1)n}^{(n)} \\
0 &amp; 0 &amp; \cdots &amp; 0 &amp; a_{nn}^{(n)}
}\right]\end{split}\]</div>
<p>so we can define <span class="math notranslate nohighlight">\(\mathbf{U}\equiv \mathbf{A}^{(n)}\)</span>.</p>
<p>Now, taking the equation</p>
<div class="math notranslate nohighlight">
\[ \mathbf{A}^{(n)} = \mathbf{M}^{(n-1)}\mathbf{M}^{(n-2)}\cdots \mathbf{M}^{(1)}\mathbf{A}^{(1)} \]</div>
<p>and defining the inverse of <span class="math notranslate nohighlight">\(\mathbf{M}^{(k)}\)</span> as</p>
<div class="math notranslate nohighlight">
\[\begin{split} \mathbf{L}^{(k)}_{ij} = \left(\mathbf{M}^{(k)}\right)^{-1}_{ij} =  \left\{ \matrix{
1 &amp; \mbox{if}\ \ i=j \\
m_{ij} &amp; \mbox{if}\ \ j=k\ \ \mbox{and}\ \ k+1\leq i \leq n \\
0 &amp; \mbox{otherwise}
}  \right.\end{split}\]</div>
<p>we obtain</p>
<div class="math notranslate nohighlight">
\[ \mathbf{L}^{(1)} \cdots \mathbf{L}^{(n-2)}\mathbf{L}^{(n-1)}\mathbf{A}^{(n)} = \mathbf{L}^{(1)} \cdots \mathbf{L}^{(n-2)}\mathbf{L}^{(n-1)}\mathbf{M}^{(n-1)}\mathbf{M}^{(n-2)}\cdots \mathbf{M}^{(1)}\mathbf{A}^{(1)} = \mathbf{L}\mathbf{U} \]</div>
<p>where the lower diagonal matrix <span class="math notranslate nohighlight">\(\mathbf{L}\)</span> is given by:</p>
<p>$<span class="math notranslate nohighlight">\( \mathbf{L} = \mathbf{L}^{(1)} \cdots \mathbf{L}^{(n-2)}\mathbf{L}^{(n-1)} \)</span>$.</p>
</section>
<section id="algorithm-for-lu-factorization">
<h3><span class="section-number">6.7.3. </span>Algorithm for LU factorization<a class="headerlink" href="#algorithm-for-lu-factorization" title="Permalink to this headline">#</a></h3>
<p>The algorithm is then given by:</p>
<p><strong>1.</strong> Give a square matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> where the pivots are nonzero.</p>
<p><strong>2.</strong> Apply the operation <span class="math notranslate nohighlight">\(Comb(E_j,E_1,-a^{(1)}_{j1}/aa^{(1)}_{11})\)</span>. This eliminates the coefficients associated to <span class="math notranslate nohighlight">\(x_1\)</span> in all the rows but in the first one.</p>
<p><strong>3.</strong> Construct the matrix <span class="math notranslate nohighlight">\(\mathbf{L}^{(1)}\)</span> given by</p>
<div class="math notranslate nohighlight">
\[\begin{split} \mathbf{L}^{(k)}_{ij} =  \left\{ \matrix{
1 &amp; \mbox{if}\ \ i=j \\
m_{ij} = \frac{a^{(j)}_{ij}}{a^{(j)}_{jj}} &amp; \mbox{if}\ \ j=k\ \ \mbox{and}\ \ k+1\leq i \leq n \\
0 &amp; \mbox{otherwise}
}  \right.\end{split}\]</div>
<p>with <span class="math notranslate nohighlight">\(k=1\)</span>.</p>
<p><strong>4.</strong> Repeat the steps <strong>2</strong> and <strong>3</strong> for the next column until reaching the last one.</p>
<p><strong>5.</strong> Return the matrices <span class="math notranslate nohighlight">\(\mathbf{U} = \mathbf{A}^{(n)}\)</span> and <span class="math notranslate nohighlight">\( \mathbf{L} = \mathbf{L}^{(1)} \cdots \mathbf{L}^{(n-2)}\mathbf{L}^{(n-1)} \)</span>.</p>
</section>
<section id="id8">
<h3><span class="section-number">6.7.4. </span><span style='color:red'> Activity </span><a class="headerlink" href="#id8" title="Permalink to this headline">#</a></h3>
<p>Create a routine called <code class="docutils literal notranslate"><span class="pre">LU_Factorization</span></code> that, given a matrix <span class="math notranslate nohighlight">\(\mathbf{A}\)</span> and the previous algorithm, calculate the LU factorization of the matrix. Test your routine with a random square matrix, verify that <span class="math notranslate nohighlight">\(\mathbf{A} = \mathbf{L}\mathbf{U}\)</span>.</p>
<hr class="docutils" />
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">M1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5, -4,  0],
       [-4,  7, -3],
       [ 0, -3,  5]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scipy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">P</span><span class="p">,</span><span class="n">L</span><span class="p">,</span><span class="n">U</span><span class="o">=</span><span class="n">scipy</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">lu</span><span class="p">(</span><span class="n">M1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">U</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[ 5.        , -4.        ,  0.        ],
       [ 0.        ,  3.8       , -3.        ],
       [ 0.        ,  0.        ,  2.63157895]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">The</span> <span class="n">same</span> <span class="n">obtained</span> <span class="n">before</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span>scipy.linalg.lu<span class="o">?</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="span-style-color-red-eigenvalues-and-eigenvectors-activity-span">
<h3><span class="section-number">6.7.5. </span><span style='color:red'> Eigenvalues and Eigenvectors activity  </span><a class="headerlink" href="#span-style-color-red-eigenvalues-and-eigenvectors-activity-span" title="Permalink to this headline">#</a></h3>
<section id="electron-interacting-with-a-magnetic-field">
<h4><span class="section-number">6.7.5.1. </span>Electron interacting with a magnetic field<a class="headerlink" href="#electron-interacting-with-a-magnetic-field" title="Permalink to this headline">#</a></h4>
<p>An electron is placed to interact with an uniform magnetic field. To give account of the possible allowed levels of the electron in the presence of the magnetic field it is necessary to solve the next equation</p>
<div class="amsmath math notranslate nohighlight" id="equation-370d3fcc-0a14-4aca-9adf-a05c907ccf67">
<span class="eqno">(6.6)<a class="headerlink" href="#equation-370d3fcc-0a14-4aca-9adf-a05c907ccf67" title="Permalink to this equation">#</a></span>\[\begin{equation}
\hat{H}|\Psi\rangle = E|\Psi\rangle
\end{equation}\]</div>
<p>where the hamiltonian is equal to <span class="math notranslate nohighlight">\(H = -\mu \cdot B = -\gamma B \cdot S\)</span>, with the gyromagnetic ratio <span class="math notranslate nohighlight">\(\gamma\)</span>, <span class="math notranslate nohighlight">\(\textbf{B}\)</span> the magnetic field and <span class="math notranslate nohighlight">\(\textbf{S}\)</span> the spin. It can be shown that the hamiltonian expression is transformed in</p>
<div class="amsmath math notranslate nohighlight" id="equation-d23f12c1-5445-468d-aff1-9206e23c5bc2">
<span class="eqno">(6.7)<a class="headerlink" href="#equation-d23f12c1-5445-468d-aff1-9206e23c5bc2" title="Permalink to this equation">#</a></span>\[\begin{equation}
\hat{\textbf{H}} = - \frac{\gamma \hbar}{2} \left( \begin{array}{cc}
B_z  &amp; B_x -i B_y \\
B_x + i B_y  &amp; -B_z  \end{array} \right) 
\end{equation}\]</div>
<p>Then, by solving the problem <span class="math notranslate nohighlight">\(|H - EI|=0\)</span> is found the allowed energy levels, i.e., finding the determinant of the
matrix <span class="math notranslate nohighlight">\(H - EI\)</span> allows to get the values <span class="math notranslate nohighlight">\(E_1\)</span> and <span class="math notranslate nohighlight">\(E_2\)</span>.</p>
<p>And solving the problem <span class="math notranslate nohighlight">\(\hat{H}\Psi\)</span> - E<span class="math notranslate nohighlight">\(\Psi = 0\)</span> gives the autofunctions <span class="math notranslate nohighlight">\(\Psi\)</span>, i.e., the column vector <span class="math notranslate nohighlight">\(\Psi= \{\Psi_1, \Psi_2\}\)</span>.</p>
<p>The function scipy.optimize.root can be used to get roots of a given equation. The experimental value of <span class="math notranslate nohighlight">\(\gamma\)</span> for the electron is 2. The order of magnitude of the magnetic field is <span class="math notranslate nohighlight">\(1g\)</span>.</p>
<ol class="simple">
<li><p>Find the allowed energy levels.</p></li>
<li><p>Find the autofunctions and normalize them.</p></li>
</ol>
<p><strong>Hint:</strong> An imaginary number in python can be written as 1j.</p>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./material"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="numerical-calculus.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">5. </span>Numerical Calculus</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="differential-equations.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">7. </span>Differential Equations</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Diego Restrepo (UdeA)<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>