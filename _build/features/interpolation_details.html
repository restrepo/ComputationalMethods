---
redirect_from:
  - "/features/interpolation-details"
interact_link: content/features/interpolation_details.ipynb
kernel_name: python3
kernel_path: content/features
has_widgets: false
title: |-
  Hemite interpolation
pagenum: 13
prev_page:
  url: /features/LagrangePoly.html
next_page:
  url: /features/Minimization.html
suffix: .ipynb
search: x y xi f frac z n d left right divided polynomials hermite cdots order differences equiv k polynomial lagrange function points ik font interpolation expression p dk any using color derivative colab ipynb pn set data obtain zeroth difference example coefficients span taylor however dataset com computationalmethods master interpolationdetails interpolating next given note previous through sum red both calculate point equal real research google github blob material functions such expressions different notation suppose where determined yi interpolant cdotsa align also style defined show specific those only derivatives approximated assume respective finally h sbustamante routine href restrepo target parentimg src

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Hemite interpolation</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://colab.research.google.com/github/restrepo/ComputationalMethods/blob/master/material/interpolation_details.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Appendix">Appendix<a class="anchor-link" href="#Appendix"> </a></h1><p>Thecnical details of interpolation functions: <a href="./interpolation_details.ipynb">interpolation_details.ipynb</a></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Divided-Differences">Divided Differences<a class="anchor-link" href="#Divided-Differences"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In spite of the good precision achieved by the Lagrange interpolating polynomials, analytical manipulation of such an expressions is rather complicated. Furthermore, when applying other polynomials-based techniques like Hermite polynomials, the algorithms present very different ways to achieve the final interpolation, making a comparison unclear.</p>
<p>Divided differences is a way to standardize the notation for interpolating polynomials. Suppose a polynomial $P_n(x)$ and write it in the next form:</p>
$$P_n(x) = a_0 + a_1(x-x_0)+ a_2 (x-x_0)(x-x_1)+\cdots + a_n(x-x_0)\cdots (x-x_{n-1})$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>where $a_i$ are a set of constants to be determined from the given data $(x_i, y_i)$.</p>
<ul>
<li>Obtain $a_0$ <br/>Note that due to the definition of an interpolant function, previous expression should satisfy:</li>
</ul>
$$P_{n}\left(x_{0}\right)=a_{0}=f\left(x_{0}\right)=y_{0}$$<ul>
<li>Obtain $a_1$
$$\frac{P_{n}(x)-a_{0}}{x-x_{0}}=\frac{P_{n}(x)-y_{0}}{x-x_{0}}=a_{1}+a_{2}\left(x-x_{1}\right)+\cdots+a_{n}\left(x-x_{2}\right) \cdots\left(x-x_{n}\right)$$</li>
</ul>
$$\frac{P_{n}\left(x_{1}\right)-y_{0}}{x-x_{0}}=a_{1}=\frac{y_{1}-y_{0}}{x-x_{0}}$$<ul>
<li>Obtain $a_1$ $$
\frac{1}{x-x_{1}}\left(\frac{P_{n}(x)-y_{0}}{x-x_{0}}-\frac{y_{1}-y_{0}}{x_{1}-x_{0}}\right)=a_{2}+a_{3}\left(x-x_{2}\right)+\cdots+a_{n}\left(x-x_{2}\right) \cdots\left(x-x_{n}\right)$$ evaluando en $x=x_2$ $$
a_{2}=\frac{1}{x_{2}-x_{1}}\left(\frac{y_{2}-y_{0}}{x_{2}-x_{0}}-\frac{y_{1}-y_{0}}{x_{1}-x_{0}}\right),$$ que <a href="https://bit.ly/3j018kH">podemos reescribir como</a>
$$a_{2}=\frac{\frac{y_{2}-y_{1}}{x_{2}-x_{1}}-\frac{y_{1}-y_{0}}{x_{1}-x_{0}}}{x_{2}-x_{0}}.$$</li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>In summary
\begin{align}
a_{0}=&amp; f\left[y_{0}\right] \equiv y_{0} \\
a_{1}=&amp; f\left[y_{0}, y_{1}\right] \equiv \frac{y_{1}-y_{0}}{x_{1}-x_{0}}\\
a_{2}=&amp;f\left[y_{0}, y_{1}, y_{2}\right] \equiv \frac{\frac{y_{2}-y_{1}}{x_{2}-x_{1}}-\frac{y_{1}-y_{0}}{x_{1}-x_{0}}}{x_{2}-x_{0}}
\end{align}</p>
<p>The key observation
$$f\left[y_{0}, y_{1}, y_{2}\right]=\frac{f\left[y_{1}, y_{2}\right]-f\left[y_{0}, y_{1}\right]}{x_{2}-x_{0}}$$</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Allow us to definine the <strong>zeroth divided difference</strong>, $k=0$, of $x_i$ like</p>
$$D_0[x_i] \equiv f[x_i] \equiv f(x_i) = y_i$$<p>the <strong>first divided difference</strong>, $k=1$ of $x_i$ like</p>
$$D_1[x_i] \equiv f[x_i, x_{i+1}] \equiv \frac{f[x_{i+1}]-f[x_i]}{x_{i+1}-x_i}$$$$D_1[x_i] = \frac{D_{0}[x_{i+1}]-D_{0}[x_{i}]}{x_{i+1}-x_i} $$<p>the <strong>second divided difference</strong>, $k=2$ of $x_i$ like</p>
$$D_2[x_i]\equiv f[x_i,x_{i+1},x_{i+2}] \equiv \frac{f[x_{i+1},x_{i+2}]-f[x_i,x_{i+1}]}{x_{i+2}-x_{i}}$$$$D_2[x_i]=\frac{D_1[x_{i+1}]-D_1[x_i]}{x_{i+2}-x_{i}}$$<p>successively until the <strong>kth divided difference</strong></p>
$$D_k[x_i] \equiv f[x_i, x_{i+1},\cdots, x_{i+k-1},x_{i+k}] \equiv \frac{f[x_{i+1},x_{i+2}\cdots, x_{i+k}]-f[x_i, x_{i+1},\cdots, x_{i+k-1}]}{x_{i+k}-x_i}$$$$D_k[x_i] = \frac{D_{k-1}[x_{i+1}]-D_{k-1}[x_{i}]}{x_{i+k}-x_i}$$<p>These expressions are the fundamental bricks for any interpolating method.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Construction of a kth divided difference (recursive code)</span>
<span class="k">def</span> <span class="nf">D</span><span class="p">(</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">Xn</span><span class="p">,</span> <span class="n">Yn</span> <span class="p">):</span>
    <span class="c1">#If k+i&gt;N</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="o">&gt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">Xn</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="c1">#Zeroth divided difference</span>
    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Yn</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="c1">#If higher divided difference</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">D</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Xn</span><span class="p">,</span> <span class="n">Yn</span><span class="p">)</span><span class="o">-</span><span class="n">D</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Xn</span><span class="p">,</span> <span class="n">Yn</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">Xn</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">Xn</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-2">Example 2<a class="anchor-link" href="#Example-2"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As an example, Lagrange interpolation can be also derived by using divided differences, which is reached through the next equation:</p>
$$P_n(x) = D_0[x_0] + \sum_{k=1}^n D_k[x_0] (x-x_0) \cdots (x-x_{k-1})$$<p>Note this expression is by far easier to be manipulated analytically as we can know the coefficients of each order.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Activity"><span style="color:red">Activity</span><a class="anchor-link" href="#Activity"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><span style="color:red">    
Using the previous expression and the defined function for divided differences, show both methods to calculate Lagrange interpolators are equivalents.
</span></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Hermite-Interpolation">Hermite Interpolation<a class="anchor-link" href="#Hermite-Interpolation"> </a></h1>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From calculus we know that Taylor polynomials expand a function at a specific point $x_i$, being both functions (the original one and the Taylor function) exactly equal at any derivative-order at that point. Also, as mentioned before, a Lagrange polynomial, given a set of data points, passes through all those points at the same time. However if those points come from an unknown underlying function $f(x)$, the interpolant polynomial might (surely) differ from the real function at any superior derivative-order. So we have:</p>
<ul>
<li><p><strong>Taylor polynomials</strong> are exact at any order, but that only remains true at a specific point.</p>
</li>
<li><p><strong>Lagrange polynomials</strong> pass through all points of a give dataset, but only at zeroth-order. Derivatives are not longer equal.</p>
</li>
</ul>
<p>Once established these differences, we can introduce Hermite polynomials just as a generalization of both, Taylor and Lagrange polynomials.</p>
<p>At first, Hermite polynomials can be approximated at any desired order at all the points, as long as one has all these information. However, for the sake of simplicity and without loss of generality, we shall assume Hermite polynomials equal to the real function at zeroth and first-derivative order.</p>
<p>Let's suppose a dataset $\{x_i\}_i$ for $i = 0,1,\cdots,n$ with the respective values $\{f(x_i)\}_i$ and $\{f'(x_i)\}_i$. If we assume two different polynomials to fit each set of data, i.e. a polynomial for $\{f(x_i)\}_i$ and another for $\{f'(x_i)\}_i$, we obtain $2n+2$ coefficients, however zeroth-order coefficients can be put together so finally there are $2n+1$ independet coefficients to be determined. In this case, we assign the respective Hermite polynimial as $H_{2n+1}(x)$.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Derivation-in-terms-of-divided-differences">Derivation in terms of divided differences<a class="anchor-link" href="#Derivation-in-terms-of-divided-differences"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Remembering the divided differences expression for a Lagrange polynomial</p>
$$P_n(x) = D_0[x_0] + \sum_{k=1}^n D_k[x_0] (x-x_0) \cdots (x-x_{k-1})$$<p>and by defining a new sequence $\{z_0, z_1, \cdots, z_{2n+1}\}$ such that</p>
$$z_{2i} = z_{2i+1} = x_i \mbox{ for } i = 0,1,\cdots, n$$<p>However, divided differences has to be modified in order to include first-order derivatives:</p>
<p><img src="https://raw.githubusercontent.com/sbustamante/ComputationalMethods/master/material/figures/table_coefficients.png" alt=""></p>
<p>Note that $f[z_0,z_1]$ sould be originally</p>
$$f[z_0,z_1] = \frac{f[z_1]-f[z_0]}{z_1-z_0}$$<p>but replacing $z_0 = z_1 = x_0$ this would lead an indetermination. In order to solve this issue, this indertemination can be readily approximated to the derivative at $z_0$, so</p>
$$f[z_0,z_1] = f'(x_0)$$<p>or using the previously defined notation</p>
$$D_1[z_0] = f'(x_0)$$<p>Generally, for first-order divided differences we will have</p>
$$D_1[z_{2i}] = f'(x_i)$$$$D_1[z_{2i+1}] = D_1[x_i]$$<p>Higher order divided differences are calculated as usual.</p>
<p>Finally, the Hermite polynomial is built using the next expression</p>
$$H_{2n+1}(x) = D_0[z_0] + \sum_{k=1}^{2n+1} D_k[z_0] (x-z_0) \cdots (x-z_{k-1})$$
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example">Example<a class="anchor-link" href="#Example"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">pylab</span> inline
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Populating the interactive namespace from numpy and matplotlib
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span><span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;https://raw.githubusercontent.com/restrepo/ComputationalMethods/master/data/interpolation.csv&#39;</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X</th>
      <th>Y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.0</td>
      <td>8.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10.0</td>
      <td>6.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>21.3</td>
      <td>3.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Hermite-interpolation">Hermite interpolation<a class="anchor-link" href="#Hermite-interpolation"> </a></h3><p>The recommend degree for the Hermite polynomial is $n-1$ where $n$ is the number of data points of the dataset</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">H</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">polynomial</span><span class="o">.</span><span class="n">hermite</span><span class="o">.</span><span class="n">Hermite</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">min</span><span class="p">(),</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">H</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">X</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">Y</span><span class="p">,</span><span class="s1">&#39;ro&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;$x$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;$H(x)$&#39;</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>Text(0,0.5,&#39;$H(x)$&#39;)</pre>
</div>

</div>
</div>
<div class="jb_output_wrapper }}">
<div class="output_area">



<div class="output_png output_subarea ">
<img src="../images/features/interpolation_details_23_1.png"
>
</div>

</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-3">Example 3<a class="anchor-link" href="#Example-3"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Define a routine to calculate divided differences for Hermite polynomials.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1">#Construction of a kth divided difference for Hermite polynomials (recursive code)</span>
<span class="k">def</span> <span class="nf">Dh</span><span class="p">(</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">Zn</span><span class="p">,</span> <span class="n">Yn</span><span class="p">,</span> <span class="n">Ypn</span> <span class="p">):</span>
    <span class="c1">#If k+j&gt;N</span>
    <span class="k">if</span> <span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="o">&gt;=</span><span class="nb">len</span><span class="p">(</span><span class="n">Zn</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">0</span>
    <span class="c1">#Zeroth divided difference</span>
    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">Yn</span><span class="p">[</span><span class="n">j</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1">#First order divided difference (even indexes)</span>
    <span class="k">elif</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">j</span><span class="o">%</span><span class="k">2</span> == 0:
        <span class="k">return</span> <span class="n">Ypn</span><span class="p">[</span><span class="n">j</span><span class="o">/</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1">#If higher divided difference</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">Dh</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zn</span><span class="p">,</span> <span class="n">Yn</span><span class="p">,</span> <span class="n">Ypn</span><span class="p">)</span><span class="o">-</span><span class="n">Dh</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">Zn</span><span class="p">,</span> <span class="n">Yn</span><span class="p">,</span> <span class="n">Ypn</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">Zn</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="n">k</span><span class="p">]</span><span class="o">-</span><span class="n">Zn</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="-**Activity**-"><font color="red"> **Activity** </font><a class="anchor-link" href="#-**Activity**-"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><font color='red'></p>
<p>Calculate a routine, using the previous program for divided differences, that computes the Hermite polynomial given a dataset.</p>
<p>Generate a set of $N$ points of the function $\sin^2(x)$ between $0$ and $2\pi$, including an array of $x$ positions, $y = f(x)$ and first derivative $y' = f'(x)$.</p>
<p>Show which polynomial gives the best approximation to the real function, Hermite or Lagrange polynomial.</p>
<p>&lt;/font&gt;</p>
<p><font color='white'>
Solution:</p>
<p>nbviewer.ipython.org/github/sbustamante/ComputationalMethods/blob/master/activities/hermite-and-lagrange.ipynb
&lt;/font&gt;</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>

</div>
</div>
</div>
</div>

 


    </main>
    